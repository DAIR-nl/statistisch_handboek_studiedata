---
title: "One sample t-toets"
author: "Irene van der Staaij & Megiel Kerkhoven"
date: "Oktober 2019"
output:
  html_document:
    theme: united
    toc: yes
    toc_float: yes
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
#opties voor themes: spacelab, readable, united, yeti
```

```{r aanmaken data, include=FALSE, echo=TRUE}
## inladen packages

## aanmaken dummydata
set.seed(1)

decimalen_wiskunde <- rnorm(160, 7.0, 2.6)
Wiskunde_eindcijfer <- round(decimalen_wiskunde, 1)[decimalen_wiskunde <= 10 & decimalen_wiskunde >= 4.5]

decimalen_scheikunde <- rnorm(160, 6.7, 2.2)
scheikunde_eindcijfer <- round(decimalen_scheikunde, 1)[decimalen_scheikunde <= 10 & decimalen_scheikunde >= 4.5]

decimalen_natuurkunde <- rnorm(160, 6.9, 2.4)
natuurkunde_eindcijfer <- round(decimalen_natuurkunde, 1)[decimalen_natuurkunde <= 10 & decimalen_natuurkunde >= 4.5]

wns_eindcijfers <- cbind(Wiskunde_eindcijfer, scheikunde_eindcijfer, natuurkunde_eindcijfer)

gemiddeld_cijfer_wns <- apply(wns_eindcijfers, 1, mean)

gemiddeld_cijfer_wns_n30 <- sample(gemiddeld_cijfer_wns, 30)
```

## Gebruik

De *One sample t-toets* kan gebruikt worden om aan de hand van één steekproef het gemiddelde van de totale populatie te vergelijken met een vooraf opgestelde hypothese [^1]. 

## Voorbeeld uit het onderwijs
De opleidingsdirecteur van de opleiding Werktuigbouwkunde wil weten of het gemiddelde eindexamencijfer voor de exacte vakken, wiskunde, scheikunde en natuurkunde, van haar VWO studenten hoger is dan het landelijke gemiddelde, zodat zij kan bepalen of het curriculum van de inleidende vakken genoeg aansluiten bij de eerstejaars studenten. 

H~0~: Het gemiddelde eindexamencijfer voor de exacte vakken van de VWO studenten die beginnen aan de Bachelor Werktuigbouwkunde is lager dan of gelijk aan het landelijk gemiddelde, µ >= 6,8. 

H~A~: Het gemiddelde eindexamencijfer voor de exacte vakken van de VWO studenten die beginnen aan de Bachelor Werktuigbouwkunde is hoger dan het landelijk gemiddelde, µ < 6,8. 



## Normaliteit 
De t-toets gaat er vanuit dat de data normaal verdeeld is, bij kleine steekproeven is dit vaker niet het geval. 

Controleer de data met deze stappen:  
1. Controleer visueel door het maken van een dataplot: een histogram of een boxplot.  
2. Toets daarna of de data normaal verdeeld is met de Kolmogorov-Smirnov Test of bij een kleinere steekproef met de Shapiro-Wilk Test [^2]. 

Wanneer uit bovenstaande tests blijkt dat de data niet normaal verdeeld is, dus aan de assumptie niet wordt voldaan, dan kan de t-toets niet gebruikt worden. Gebruik in dat geval de Wilcoxon Signed Rank Test. [^3]

## Uitvoering in R
Voor de uitvoering in R is er een dummydataset genaamd gemiddeld_cijfer_wns ingeladen met de gemiddelde cijfers van Wiskunde, Natuurkunde en Scheikunde van 122 middelbare scholieren.

### Test assumpties: normaliteit
Visualiseren van de data met behulp van een histogram
```{r histogram voor normaliteit}
hist(gemiddeld_cijfer_wns)
```

De histogram laat een belvorm zien vergelijkbaar aan een normaalverdeling, veel waardes liggen rondom het gemiddelde en weinig bij de staarten van de verdeling. Daarnaast ziet de verdeling er in grote mate symmetrisch uit.

***

Toets normaliteit met de Kolmogorov-Smirnov Test of met de Shapiro-Wilk Test (*n* < 50[^4] ). 

### {.tabset .tabset-fade .tabset.pills}
#### Kolmogorov-Smirnov

```{r Kolmogorov-Smirnov Test, warning=FALSE}
library(nortest)
lillie.test (gemiddeld_cijfer_wns)
```
De Kolmogorov-Smirnov test is een non-parametrische toets, die het verschil in vorm tussen twee verdelingen toetst. In dit geval toetst deze test het verschil tussen de normaalverdeling en de verdeling van de steekproef. Wanneer de p-waarde kleiner is dan 0,05 is er een verschil tussen beide verdelingen. 

In dit geval is *p* > 0,05, dus is de verdeling van de data niet significant verschillend van de normaalverdeling. Er wordt aan de assumptie van normaliteit voldaan, dus de One sample-t-toets kan uitvoert worden.  

***

#### Shapiro-Wilk Test
``` {r Shapiro-Wilk Test, warning=FALSE}
shapiro.test(gemiddeld_cijfer_wns_n30)
```

De Shapiro-Wilk Test is een soort gelijke test als de Kolmogorov-Smirnov test en wordt vooral gebruikt bij kleine steekproeven. Wanneer de p-waarde groter is dan 0,05 is de verdeling van de data niet significant verschillend van de normaalverdeling.

Ook bij deze test is *p* > 0,05, dus is er geen significant verschil tussen de verdeling van de steekproef en de normaal verdeling. Er wordt aan de assumptie van normaliteit voldaan, dus de One sample-t-toets kan uitvoerd worden. 

***

### One sample t-toets
```{r ttest}
t.test(gemiddeld_cijfer_wns, mu = 6.8) 
```

Het gemiddelde van de steekproef is 7.08  
Degrees of freedom, *df* = *n* -1 = 122-1 = 121  
p-waarde < 0.05, dus de H~0~ wordt verworpen en de H~A~ wordt aangenomen
95-betrouwbaarheidsinterval: Bij herhaling van het onderzoek zal in 95% van de gevallen een interval uitkomen waarbij µ in valt. In dit geval loopt het interval tussen 6.93 en de 7.23. 


## Rapportage
Een One sample t-toets is uitgevoerd om te toetsen of het gemiddelde eindexamencijfer voor de exacte vakken van de VWO studenten die later Werktuigbouwkunde zijn gaan studeren, hoger is dan het landelijke gemiddelde. Het gemiddelde van de steekproef van 7,08 (*sd* = ) was significant anders dan het landelijk gemiddelde van een 6,8, *t*(121) = 3,76, *p* < 0,01. Het 95% betrouwbaarheidsinterval voor het gemiddelde van de steekproef heeft een reikwijdte van 6,93 tot 7,23. De resultaten ondersteunen de conclusie dat het gemiddelde eindexamencijfer hoger ligt voor de VWO studenten die later Werktuigbouwkunde zijn gaan studeren, dan het landelijk gemiddelde. 


## Referenties

[^1]: [Wiki Statistiek Academisch Medisch Centrum](https://wikistatistiek.amc.nl/index.php/T-toets#one_sample_t-toets)
[^2]: [UvA Wiki Methodologiewinkel](https://wiki.uva.nl/methodologiewinkel/index.php/Normaliteit)
[^3]: http://r-statistics.co/Statistical-Tests-in-R.html
[^4]: https://statistics.laerd.com/spss-tutorials/testing-for-normality-using-spss-statistics.php  
---
title: "`r lTitels[1]`"
author: "`r sCopyright`"
date: "versie `r sVersie`, `r format(Sys.time(), '%d-%m-%Y')`"
output:
  html_document:
    theme: united
    toc: yes
    toc_float: yes
---
``` {r versiegeschiedenis, include = FALSE, eval = FALSE}
## `r lTitels[1]`
## versie 0.4     3-9-19
```

```{r opmerking, include=FALSE, eval=FALSE}
# TODO: een link maken naar Wilcoxon Signed Rank Test
# TODO: Uitleg transformeren data 
```

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
# Opties voor themes: spacelab, readable, united, yeti
```

```{r aanmaken data, include=FALSE, echo=TRUE}
## Laad packages in

## Maak dummydata aan
RNGkind(sample.kind = "Rounding")
set.seed(1)

Decimalen_wiskunde <- rnorm(160, 7.0, 2.6)
Wiskunde_eindcijfer <- round(Decimalen_wiskunde, 1)[Decimalen_wiskunde <= 10 & Decimalen_wiskunde >= 4.5]

Decimalen_scheikunde <- rnorm(160, 6.7, 2.2)
Scheikunde_eindcijfer <- round(Decimalen_scheikunde, 1)[Decimalen_scheikunde <= 10 & Decimalen_scheikunde >= 4.5]

Decimalen_natuurkunde <- rnorm(160, 6.9, 2.4)
Natuurkunde_eindcijfer <- round(Decimalen_natuurkunde, 1)[Decimalen_natuurkunde <= 10 & Decimalen_natuurkunde >= 4.5]

WNS_eindcijfers <- cbind(Wiskunde_eindcijfer, Scheikunde_eindcijfer, Natuurkunde_eindcijfer)

Gemiddeld_cijfer_WNS <- apply(WNS_eindcijfers, 1, mean)

Gemiddeld_cijfer_WNS_n30 <- sample(Gemiddeld_cijfer_WNS, 30)
```
[//]: # 1. Toepassing
`r lKoppen[1]`
`r lText.1.Toepassing`

[//]: # 2. Onderwijscasus
`r lKoppen[2]`
`r lText.2.Onderwijscasus`

[//]: # 3. Assumpties
`r lKoppen[3]`
`r lText.3.Assumpties`

[//]: # 4. Uitvoering in R
`r lKoppen[4]`
`r lText.4.Uitvoering`

`r lText.4.1.1.Uitvoering`  {.tabset .tabset-fade .tabset.pills}
`r lText.4.1.2.Uitvoering`
```{r de data bekijken, collapse=TRUE}
mean(Gemiddeld_cijfer_WNS)
sd(Gemiddeld_cijfer_WNS)
```
`r lText.4.1.3.Uitvoering`

#### Histogram met GGplot
```{r barchart, warning=FALSE, message=FALSE}
library(ggplot2)
library(plotly)
h <- ggplot(data.frame(Gemiddeld_cijfer_WNS), aes(x = Gemiddeld_cijfer_WNS)) +
  geom_histogram(aes(y = ..density..),
                 binwidth = 0.5, color = "grey30", fill = "#0089CF") + 
  geom_density(alpha = .2, adjust = 1) +
  ylab("Frequentiedichtheid") +
  xlab("Gemiddeld_cijfer_WNS") +
  scale_x_continuous(labels = as.character(seq(5.5, 9, 0.5)), breaks = seq(5.5, 9, 0.5)) +
  labs(title = "Eindcijfers Wiskunde, Natuurkunde en Scheikunde", subtitle = "Eerstejaarsstudenten Werktuigbouwkunde")
ggplotly(h)
```
Het histogram laat een belcurve zien vergelijkbaar met een normale verdeling: veel waardes liggen rondom het gemiddelde en weinig bij de staarten van de verdeling. Daarnaast ziet de verdeling er in grote mate symmetrisch uit.

#### Q-Q plot
Gebruik `qqnorm()` en `qqline()`. Gebruik `pch = 20` om gevulde datapunten te creÃ«ren.
```{r qqplot}
qqnorm(Gemiddeld_cijfer_WNS, pch = 20)
qqline(Gemiddeld_cijfer_WNS)
```

Als over het algemeen de meeste datapunten op de lijn liggen, kan aangenomen worden dat de data normaal verdeeld is. In deze casus liggen de meeste punten op de lijn behalve bij de uiteinden. 

#### Boxplot
``` {r Boxplot}
boxplot(Gemiddeld_cijfer_WNS, xlab = "Werktuigbouwkunde", ylab = "Gemiddeld_cijfer_WNS")

```

De boxplot geeft de spreiding van het gemiddelde eindexamencijfer voor de exacte vakken voor de opleiding Werktuigbouwkunde weer. 

### {.toc-ignore}
***
Om te controleren of de data, ondanks eventuele afwijkende punten of een scheef lijkende verdeling, normaal verdeel is, kan de normaliteit getoets worden. Hierbij een toelichting bij twee veel gebruikte toetsen: de *Kolmogorov-Smirnov test* en de *Shapiro-Wilk test*.  

### {.toc-ignore .tabset .tabset-fade .tabset.pills}
#### Kolmogorov-Smirnov (met Lilliefors correctie) 

```{r Kolmogorov-Smirnov Test, warning=FALSE}
library(nortest)
lillie.test(Gemiddeld_cijfer_WNS)
```
De *Kolmogorov-Smirnov test* toetst het verschil in vorm tussen twee verdelingen. In deze casus toetst deze test het verschil tussen een normale verdeling en de verdeling van de steekproef. De Lilliefors correctie is een correctie die wordt gebruikt als het gemiddelde niet 0 is en de standaardafwijking niet 1 is. Als de p-waarde groter is dan 0,05 is de verdeling van de data niet significant verschillend van de normale verdeling.

De p-waarde is *p* > 0,05, dus er is geen significant verschil gevonden tussen de verdeling van de steekproef en de normale verdeling. Er wordt aan de assumptie van normaliteit voldaan, dus de *one sample-t-toets* kan uitgevoerd worden.  

#### Shapiro-Wilk test
``` {r Shapiro-Wilk Test, warning=FALSE}
shapiro.test(Gemiddeld_cijfer_WNS_n30)
```

De *Shapiro-Wilk test* is een soort gelijke test als de *Kolmogorov-Smirnov test* en wordt vooral gebruikt bij kleine steekproeven. Als de p-waarde groter is dan 0,05 is de verdeling van de data niet significant verschillend van de normale verdeling.

De p-waarde is *p* > 0,05, dus er is geen significant verschil gevonden tussen de verdeling van de steekproef en de normale verdeling. Er wordt aan de assumptie van normaliteit voldaan, dus de *one sample-t-toets* kan uitgevoerd worden.

### {.toc-ignore}
***
[//]: # 4.2 Toets
[//]: # 4.2.1 Inleiding
`r lText.4.2.1.Toets`

```{r ttest}
t.test(Gemiddeld_cijfer_WNS, mu = 6.8, alternative = "two.sided")
```
[//]: # 4.2.2 Duiding output
`r lText.4.2.2.Toets`

[//]: # 5. Rapportage
`r lKoppen[5]`
`r lText.5.Rapportage`

[//]: # Noten
`r lText.6.Noten`


---
title: "Ongepaarde t-toets"
author: "Irene van der Staaij & Megiel Kerkhoven"
date: "`r format(Sys.time(), '%d %B, %Y')`"
output: 
  html_document:
    toc: TRUE
    toc_float: TRUE
    theme: united
---
<style>
  .col2 {
    columns: 2 200px;
    -webkit-columns: 2 200px;
    -moz-columns: 2 200px;
  }
</style>

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r aanmaken data, include=FALSE, echo=TRUE}
RNGkind(sample.kind = "Rounding")
RNGkind(sample.kind = "Rounding")
set.seed(1)

mu <- 6.3
sigma <- 1.2
Cijfers_2010 <- rnorm(180, mu, sigma)
Cijfers_2010 <- Cijfers_2010 [Cijfers_2010 <= 10 & Cijfers_2010 >= 1]
Cijfers_2010 <- sapply (Cijfers_2010, round, 3)

mu <- 6.3
sigma <- 1.2
Cijfers_2010_n30 <- rnorm(30, mu, sigma)
Cijfers_2010_n30 <- Cijfers_2010_n30 [Cijfers_2010_n30 <= 10 & Cijfers_2010_n30 >= 1]
Cijfers_2010_n30 <- sapply (Cijfers_2010_n30, round, 3)

mu <- 6.6
sigma <- 1.2
Cijfers_2011 <- rnorm(160, mu, sigma)
Cijfers_2011 <- Cijfers_2011 [Cijfers_2011 <= 10 & Cijfers_2011 >= 1]
Cijfers_2011 <- sapply (Cijfers_2011, round, 3)

mu <- 6.6
sigma <- 1.2
Cijfers_2011_n30 <- rnorm(30, mu, sigma)
Cijfers_2011_n30 <- Cijfers_2011_n30 [Cijfers_2011_n30 <= 10 & Cijfers_2011_n30 >= 1]
Cijfers_2011_n30 <- sapply (Cijfers_2011, round, 3)

Cijfers <- c(Cijfers_2010, Cijfers_2011)
Cohort <- c(replicate(180, 2010), replicate(160, 2011))
Cijfers_gem <- data.frame(Cijfers, Cohort)


```

```{r opmerking, include=FALSE, eval=FALSE}
# doorlinken naar de Mann-Whitney U toets, ook bekend als de Wilcoxon rank-sum toets  
```

## 1 Toepassing
Bij het toetsen of het gemiddelde van twee variabelen aan elkaar gelijk zijn kan de *t-toets* gebruikt worden. Wanneer het gaat om de gemiddelden van twee onafhankelijke groepen, kan de *ongepaarde t-toets* toegepast worden [^1].

## 2 Onderwijscasus
Is het gemiddelde cijfer van de opleiding Taalwetenschap op 1 februari gestegen na invoering van het BSA? De data is beschikbaar voor het cohort gestart in 2010 en voor het cohort gestart in 2011. Vanaf 2011 heeft de opleiding een Bindend Studieadvies (BSA) die de selectiviteit van het eerste jaar moet vergroten.

## 3 Assumpties
### Normaliteit  
Controleer of de groepen normaal zijn verdeeld:  
1. Controleer de data visueel met een histogram, een boxplot of een Q-Q plot.  
2. Toets of de data normaal verdeeld is met de *Kolmogorov-Smirnov test* of bij een kleinere steekproef (n < 50[^2]) met de *Shapiro-Wilk test* [^3].   

Wanneer uit bovenstaande tests blijkt dat de steekproef niet normaal verdeeld is, kan de t-toets niet gebruikt worden, maar wel de *Mann-Whitney U toets*, ook bekend als de *Wilcoxon rank-sum toets* [^4].  

### Homogeniteit van varianties 
De *ongepaarde t-toets* gaat er ook van uit dat beide groepen dezelfde spreiding heeft, dit kan getoetst worden met de *Levene's Test (for equality of variance)*. Bij een *p* > 0,05 is de spreiding van de groepen verschillend en wordt de assumptie geschonden. Let op, de interpretatie van de *p* is bij de *Levene's Test* tegengesteld aan de interpretatie van *p* bij een *t-toets*.

## Effectmaat
Om te bepalen of de gevonden p-waarde betekenisvol is kan een effectmaat berekend worden. Cohen's d berekent de sterkte van het effect van een onafhankelijke variabele op een afhankelijke variabele. Een indicatie om *d* te interpreteren is: d ≤ 0,3 is een klein effect, rond 0,5 is een gemiddeld effect en rond 0,8 is een groot effect. 

## 4 Uitvoering in R
Voor de uitvoering in R is er data (`Cijfers_gem`) ingeladen met gemiddelde cijfers van tweedejaarsstudenten bij de opleiding Statistiek. De data bevat zowel cijfers van 180 studenten begonnen in 2010 als cijfers van 160 studenten begonnen in 2011.

### De data bekijken
```{r data bekijken}
Cijfers_gem[sample(1:340, 10),]
```
De data is verdeeld in 2 kolommen, het cijfer en het Cohort.


### Test assumpties: normaliteit
Selecteer beide groepen om het gemiddelde, de standaarddeviatie en het histogram uit te draaien. Sla de selectie op in een vector.
```{r data selecteren}
Cijfers_2010 <- Cijfers_gem[Cijfers_gem$Cohort==2010,1]
Cijfers_2011 <- Cijfers_gem[Cijfers_gem$Cohort==2011,1]
```

<div class="col2">
```{r Data beschrijven 1, collapse=TRUE}
mean(Cijfers_2010)
sd(Cijfers_2010)
```
gemiddelde 2010 (standaarddeviatie): 6,37 (1,12)
```{r Data beschrijven 2, collapse=TRUE}
mean(Cijfers_2011)
sd(Cijfers_2011)
```
gemiddelde 2011 (standaarddeviatie): 6,61(1,2) </div>

<div class="col2">
```{r histogram, collapse=TRUE}
hist(Cijfers_2010)
hist(Cijfers_2011)
```
</div>
Beide histogrammen laten een belvorm zien vergelijkbaar aan een normale verdeling, veel waardes liggen rondom het gemiddelde.  

### {.tabset .tabset-fade .tabset.pills}
#### Kolmogorov-Smirnov (met Lilliefors correctie)

```{r library nortest, warning=FALSE}
library(nortest)
```
<div class="col2">
``` {r Lilliefors Test, warning=FALSE}
lillie.test(Cijfers_2010)
lillie.test(Cijfers_2011)
```
</div>

De *Kolmogorov-Smirnov test* toetst het verschil in vorm tussen de twee verdelingen. Wanneer *p* < 0,05 is er een verschil tussen beide verdelingen.

In dit geval zijn van beide groepen de p-waarde > 0,05, dus is de verdeling van de data niet significant verschillend van de normaalverdeling en de *ongepaarde t-toets* kan uitgevoerd worden.

#### Shapiro-Wilk Test
<div class="col2">
``` {r Shapiro-Wilk Test, warning=FALSE}
shapiro.test(Cijfers_2011_n30)
shapiro.test(Cijfers_2010_n30)
```
</div>
In dit voorbeeld, met een kleine *n*, hebben beide groepen een p-waarde > 0,05, dus is de verdeling van beide groepen niet significant verschillend van de normale verdeling. Er wordt aan de assumptie van normaliteit voldaan, dus de *ongepaarde t-toets* kan uitgevoerd worden.

### Levene's test
De `leveneTest()` heeft in R twee argumenten. Het eerste argument is een vector met de data van beide groepen. Het tweede argument is een factor waarin de groepen worden gedefinieerd of een vector die logisch om te zetten is naar een factor.
```{r Levenes test, message=FALSE, warning=FALSE, collapse=TRUE}
library(car)
leveneTest(Cijfers_gem$Cijfers, Cijfers_gem$Cohort)
```
*F(1,338)* = 0,92(1), p-waarde ≈ 0,034, de groepen zijn niet verschillend in spreiding.  
Vrijheidsgraden: het eerste cijfer zijn het #groepen - 1 en de tweede: *n~1~* + *n~2~* -2

### Ongepaarde t-toets
```{r statistische toets}
t.test(Cijfers_2010, Cijfers_2011)
```


### Cohen's d 


## 5 Rapportage


[^1]: van Geloven, N. (2016, 25 maart). T-toets [Wiki Statistiek Academisch Medisch Centrum]. Verkregen van: https://wikistatistiek.amc.nl/index.php/T-toets#ongepaarde_t-toets
[^2]: Normaliteit. (14 jul 2014). [UvA Wiki Methodologiewinkel]. Verkregen van: https://wiki.uva.nl/methodologiewinkel/index.php/Normaliteit  
[^3]: https://wikistatistiek.amc.nl/index.php/One-way_ANOVA
[^4]: van Geloven, N. (2018, 13 maart). Mann-Whitney U toets [Wiki Statistiek Academisch Medisch Centrum]. Verkregen van: https://wikistatistiek.amc.nl/index.php/Mann-Whitney_U_toets


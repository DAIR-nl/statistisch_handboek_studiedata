---
title: "Chi-kwadraat toets"
author: "Irene van der Staaij & Megiel Kerkhoven"
date: "1 Oktober 2019"
output: 
  html_document:
    toc: TRUE
    toc_float: TRUE
    theme: united
---
```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```


```{r aanmaken data, include=FALSE, echo=TRUE}
Geen_ls_uitval <- c(375, 496)
Wel_ls_uitval <- c(369, 394)
Uitval_functiebeperking <- t(data.frame(Geen_ls_uitval, Wel_ls_uitval))
colnames(Uitval_functiebeperking) <- c("Wel uitval", "Geen uitval")

Geen_ls_uitval_n10 <- c(8, 14)
Wel_ls_uitval_n10 <- c(5, 16)
Uitval_functiebeperking_n10 <- t(data.frame(Geen_ls_uitval_n10, Wel_ls_uitval_n10))
colnames(Uitval_functiebeperking_n10) <- c("Wel uitval", "Geen uitval")
```

## Gebruik
De *Chi-kwadraat toets* wordt gebruikt om te toetsen of er een afhankelijkheid is tussen twee ongepaarde categorische variabelen, door middel van een kruistabel [^1].

## Voorbeeld uit het onderwijs
De studieadviseur van de opleiding filosofie vraagt zich af of de studenten met een functiebeperking vaker uitvallen dan de studenten zonder functiebeperking sinds de invoering van het leenstelsel?

H~0~: De verhouding uitval van het aantal studenten met een functiebeperking voor of na de invoering van het leenstelsel is gelijk gebleven.

H~A~: De verhouding uitval van het aantal studenten met een functiebeperking voor of na de invoering van het leenstelsel is anders.

## Assumpties
1. De variabelen zijn op nominaal niveau gemeten, dit betekent automatisch dat er geen ordening tussen de groepen gemaakt kan worden en dat de groepen onafhankelijk van elkaar zijn.  
2. De groepsgrootte van de verwachtte waarde is per cel niet kleiner dan 5, bij de geobserveerde waarde is de groepsgrootte niet minder dan 10. Gebruik de Fisher’s exact toets wanneer de groepen kleiner zijn [^2].  
3. Elke cel van de verwachte waarde is groter dan 0 [^3]. 


## Uitvoering in R
Voor de uitvoering in R is er data ingeladen over de uitval van studenten met een functiebeperking voor en na de invoering van het leenstelsel. De data `Uitval_functiebeperking` is binair (wel of geen uitval). 

### De data bekijken
```{r dataview}
Uitval_functiebeperking
```

### Chi-kwadraat toets
### {.tabset .tabset-fade}
#### Chi-kwadraat toets
Om `chisq.test()` in R te gebruiken moet de data in een kruistabel staan.  

```{r chi2}
chisq.test(Uitval_functiebeperking)
```

Vrijheidsgraden: *df* = (*k*-1)(*r*-1), waar k staat voor kolom en r voor rij. In dit geval is *df* = 1. Wanneer het aantal vrijheidsgraden 1 is, wordt de continuïteitscorrectie van Yates toegepast.  
p-waarde < 0,05 , dus de H~0~ wordt verworpen en de H~A~ wordt aangenomen 

#### Fisher's exact toets
De *Fisher's exact toets* wordt ook gebruikt om te toetsen of er een afhankelijkheid is tussen twee ongepaarde nominale variabelen, door middel van een kruistabel. In tegenstelling tot de *chi-kwadraat toets* kan de *Fisher's exact toets* ook bij lage frequenties ingezet worden. De *Fisher's exact toets* is conservatiever dan de *chi-kwadraat toets*[^2].

```{r fishers exact}

fisher.test(Uitval_functiebeperking_n10)
```

output output output


## Rapportage
Om te toetsen of studenten met een functiebeperking vaker uitvallen dan de student zonder functiebeperking sinds de invoering van het leenstelsel, is de *Chi-kwadraat toets* uitgevoerd. De resultaten ondersteunen de conclusie dat de verhouding uitval van het aantal studenten met een functiebeperking voor of na de invoering van het leenstelsel niet gelijk is gebleven, \( \chi \)^2^ (1) \(\approx\) 4,41, *p* < 0,01.
 
## Referenties
[^1]: [r-statistics.co](http://r-statistics.co/Statistical-Tests-in-R.html)
[^2]: [Wiki Statistiek Academisch Medisch Centrum](https://wikistatistiek.amc.nl/index.php/Chi-kwadraat_toets)
[^3]: [UvA Wiki Methodologiewinkel](https://wiki.uva.nl/methodologiewinkel/index.php/Chi-square_test#Assumpties )
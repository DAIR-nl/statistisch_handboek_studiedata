---
title: "Chi-kwadraat toets"
author: "Irene van der Staaij & Megiel Kerkhoven"
date: "1 Oktober 2019"
output: 
  html_document:
    toc: TRUE
    toc_float: TRUE
    theme: united
---
```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```


```{r aanmaken data, include=FALSE, echo=TRUE}
set.seed(0)

decimalen_geen_ls <- rnorm (853, 0.491, 0.1)
waardes <- sapply(decimalen_geen_ls, round)
geen_ls_matrix <- matrix(c(sample(3000000:3400000, 853), waardes), byrow = FALSE, nrow = 953)
uitval_fb_geen_ls <- data.frame(geen_ls_matrix)
names (uitval_fb_geen_ls) [1] <- "Studentnummer"
names (uitval_fb_geen_ls) [2] <- "Uitval"

decimalen_wel_ls <- rnorm (740, 0.491, 0.14)
waardes <- sapply(decimalen_wel_ls, round)
wel_ls_matrix <- matrix(c(sample(3500000:4000000, 740), sapply(decimalen_wel_ls, round)), byrow = FALSE, nrow = 840)
uitval_fb_wel_ls <- data.frame(wel_ls_matrix)
names (uitval_fb_wel_ls) [1] <- "Studentnummer"
names (uitval_fb_wel_ls) [2] <- "Uitval"
```

## Gebruik
De Chi-kwadraat toets wordt gebruikt om te toetsen of er een afhankelijkheid is tussen twee ongepaarde categorische variabelen, door middel van een kruistabel [^1]

## Voorbeeld uit het onderwijs
De studieadviseur van de opleiding filosofie vraagt zich af of de studenten met een functiebeperking vaker uitvallen dan de student zonder functiebeperking sinds de invoering van het leenstelsel?

H~0~: De verhouding uitval van het aantal studenten met een functiebeperking voor of na de invoering van het leenstelsel is gelijk gebleven.

H~A~: De verhouding uitval van het aantal studenten met een functiebeperking voor of na de invoering van het leenstelsel is anders.

## Assumpties
1. De variabelen zijn op nominaal niveau gemeten, dit betekent automatisch dat er geen ordening tussen de groepen gemaakt kan worden en dat de groepen onafhankelijk van elkaar zijn.  
2. De groepsgrootte van de verwachtte waarde is per cel niet kleiner dan 5, bij de geobserveerde waarde is de groepsgrootte niet minder dan 10. Gebruik de Fisher’s exact toets wanneer de groepen kleiner zijn.[^2]  
3. Elke cel van de verwachte waarde is groter dan 0. [^3] 


## Uitvoering in R
Voor de uitvoering in R is er data ingeladen over de uitval van studenten met een functiebeperking voor en na de invoering van het leenstelsel. De data is binair (wel of geen uitval) en op basis van het studentnummer.

### Tabel
Fequentie van de geoberveerde data, uitval van studenten met en zonder een functiebeperking voor en na de invoering van het leenstelsel

### Is de data categorisch?

```{r}
print(uitval_fb_geen_ls[1:30, ], row.names = FALSE)
print(uitval_fb_wel_ls[1:30, ], row.names = FALSE)
```

### statistische toets in R

```{r}
chisq.test(uitval_fb_wel_ls, uitval_fb_geen_ls)
```

## Toelichting op de output

Continuïteitscorrectie bij df=1

## Rapportage

## Verder lezen
[^1]: http://r-statistics.co/Statistical-Tests-in-R.html
[^2]: https://wikistatistiek.amc.nl/index.php/Chi-kwadraat_toets
[^3]: https://wiki.uva.nl/methodologiewinkel/index.php/Chi-square_test#Assumpties 
## Achtergrond info



---
title: "Chi-kwadraat toets en Fisher's exact toets"
author: "© 2019, SURF Versnellingsagenda Statistisch Handboek Hoger Onderwijs"
date: "`r format(Sys.time(), '%d-%m-%y')`"
output: 
  html_document:
    toc: TRUE
    toc_float:
      collapsed: FALSE
    number_sections: TRUE
    theme: united
---

``` {r versiegeschiedenis, include = FALSE, eval = FALSE}
## versie 0.1     3-9-19
```

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r opmerking TODO, include=FALSE, eval=FALSE}
# TODO: Uitleg extra pagina: nominaal, ordinaal etc., afhanjeklijk en onafhankelijk  
# TODO: Uitleg transformeren data 

```{r aanmaken data, include=FALSE, echo=TRUE}
Geen_leenstelsel <- c(375, 496)
Wel_leenstelsel <- c(369, 394)
Uitval_functiebeperking <- t(data.frame(Geen_leenstelsel, Wel_leenstelsel))
colnames(Uitval_functiebeperking) <- c("Wel uitval", "Geen uitval")

Geen_leenstelsel_n43 <- c(8, 14)
Wel_leenstelsel_n43 <- c(5, 16)
Uitval_functiebeperking_n43 <- t(data.frame(Geen_leenstelsel_n43, Wel_leenstelsel_n43))
colnames(Uitval_functiebeperking_n43) <- c("Wel uitval", "Geen uitval")
```

# Toepassing
Gebruik de *Chi-kwadraat toets* of de *Fisher's exact toets* om te toetsen of er een afhankelijkheid is tussen twee ongepaarde categorische variabelen, door middel van een kruistabel.[^1] In tegenstelling tot de *Chi-kwadraat toets* kan de *Fisher's exact toets* ook bij lage frequenties ingezet worden.[^2] De *Fisher's exact toets* is conservatiever dan de *Chi-kwadraat toets*.[^3]

# Onderwijscasus
De studentendecaan vraagt zich af of de studenten met een functiebeperking vaker uitvallen sinds de invoering van het leenstelsel.

H~0~: De verhouding uitval van het aantal studenten met een functiebeperking na de invoering van het leenstelsel is gelijk gebleven.

H~A~: De verhouding uitval van het aantal studenten met een functiebeperking na de invoering van het leenstelsel is veranderd.

# Assumpties
Voor een valide resultaat moeten de data aan een aantal voorwaarden voldoen voordat de toets uitgevoerd kan worden. Groepen zijn onafhankelijk van elkaar en de variabelen zijn op nominaal niveau gemeten. De *Chi-kwadraat toets* heeft specifieke regels wat betreft de groepsgrootte per cel. 

## Groeps- en celgrootte
Elke cel van de verwachte waarde > 0. De verwachte waarde is de voorspelde waarde gebaseerd op de nulhypothese. Als in 20% van de cellen een verwachte waarde van 5 of lager staat, wordt de toets onbetrouwbaar en wordt er geadviseerd om de *Chi-kwadraat toets* niet uit te voeren. In de cellen met de geobserveerde waarde is dat 10 of lager.[^4] Gebruik de *Fisher’s exact toets* wanneer de groepen kleiner zijn.[^5] 

# Uitvoering in R
Er is een dataset ingeladen over de uitval van studenten met een functiebeperking voor en na de invoering van het leenstelsel. De data `Uitval_functiebeperking` zijn binair: wel of geen uitval. 

## De data bekijken
```{r dataview}
Uitval_functiebeperking
```

## Chi-kwadraat toets 
Zet de data in een kruistabel, voordat `chisq.test()` gebruikt wordt. 

```{r chi2}
chisq.test(Uitval_functiebeperking)
```

* *χ^2^* (1) ≈ 4,41, *p* < 0,05  
* Vrijheidsgraden: *df* = (*k*-1)(*r*-1), waar k staat voor kolom en r voor rij. In dit geval is *df* = 1. Wanneer het aantal vrijheidsgraden 1 is, wordt de continuïteitscorrectie van Yates toegepast.  
* p-waarde < 0,05, dus de H~0~ wordt verworpen en de H~A~ wordt aangenomen.  

## Fisher's exact toets
Er zijn data ingeladen over de uitval van studenten met een functiebeperking voor en na de invoering van het leenstelsel, alle groepen hebben een laag aantal per cel, variërend van 5 tot 16. Ook hier zijn de data `Uitval_functiebeperking_n43` binair. 

```{r fishers exact}
fisher.test(Uitval_functiebeperking_n43)
```

* p-waarde > 0,05 , dus de H~0~ wordt niet verworpen  
* De kans op het uitvallen van studenten met een functiebeperking onder het leenstelsel is 1,8 keer zo groot, als de kans op het uitvallen van studenten met een functiebeperking voor het leenstelsel. Deze associatie blijkt niet significant te zijn: *p* = 0,51  
* 95%-betrouwbaarheidsinterval: het interval is van 0,41 en de 8,78.   

# Rapportage
Om te toetsen of studenten met een functiebeperking vaker uitvallen sinds de invoering van het leenstelsel, is de *Chi-kwadraat toets* uitgevoerd. De resultaten ondersteunen de nulhypothese dat de verhouding uitval van het aantal studenten met een functiebeperking na de invoering van het leenstelsel gelijk is gebleven, *χ^2^* (1) ≈ 4,41, *p* < 0,05.
 
[^1]: Prabhakaran, S. (2016-2017). *Statistical Tests* http://r-statistics.co/Statistical-Tests-in-R.html
[^2]: Van Geloven, N., & Holman, R., (6 mei 2016). *Fisher's exact toets* [Wiki Statistiek Academisch Medisch Centrum](https://wikistatistiek.amc.nl/index.php/Fisher's_exact_toets).
[^3]: Universiteit van Amsterdam (13 november 2017). *Chi-square test* https://wiki.uva.nl/methodologiewinkel/index.php/Chi-square_test#Assumpties 
[^4]: Field, A., Miles, J., & Field, Z. (2012). Discovering statistics using R. *Sage publications*.
[^5]: van Geloven, N. (20 augustus 2015). *Chi-kwadraat toets* [Wiki Statistiek Academisch Medisch Centrum](https://wikistatistiek.amc.nl/index.php/Chi-kwadraat_toets).

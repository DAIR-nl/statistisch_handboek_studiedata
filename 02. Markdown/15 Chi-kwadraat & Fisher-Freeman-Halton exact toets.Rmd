---
title: "15 Chi-kwadraat & Fisher-Freeman-Halton exact toets"
author: "SURF versnellingsagenda Statistisch Handboek Hoger Onderwijs, Â© 2019"
date: "`r format(Sys.time(), '%d %B, %Y')`"
output: 
  html_document:
    toc: TRUE
    toc_float: TRUE
    theme: united
---

``` {r versiegeschiedenis, include = FALSE, eval = FALSE}
## versie 0.1     3-9-19
```

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```


```{r aanmaken data, include=FALSE, echo=TRUE}
## Case: Een opleiding heeft een internationale instroom uit diverse landen. Krijgen studenten uit bepaalde landen vaker een positief BSA dan studenten uit andere landen?

RNGkind(sample.kind = "Rounding")
set.seed(1) #noodzakelijk omdat we simulate.p.values gebruiken bij de fisher.test
Landen_instroom <- c("NL", "GE", "IT", "UK", "BE", "ES", "US")  ##ISO-codes
Pos_bsa <- c(1171, 213,  60, 119,  45,  81, 270)
Verhouding <- c(0.1, 0.14, 0.36, 0.04, 0.12, 0.22, 0.19)
Neg_bsa <- round(Pos_bsa * Verhouding)
Bsa_kt <- data.frame(Pos_bsa, Neg_bsa)
Bsa_kt <- t(Bsa_kt)
colnames(Bsa_kt) <- Landen_instroom

Pos_bsa_n10 <- c(49, 37, 62, 67, 73, 70, 69)
Neg_bsa_n10 <- c(10, 7, 13, 14, 15, 19, 18)
Bsa_kt_n10 <- data.frame(Pos_bsa_n10, Neg_bsa_n10)
Bsa_kt_n10 <- t(Bsa_kt_n10)
colnames (Bsa_kt_n10) <- Landen_instroom
```

## 1 Toepassing

## 2 Onderwijscasus

## 3 Assumpties

## 4 Uitvoering in R
Voor de uitvoering in R is er een dataset (`Bsa_kt`) ingeladen over het BSA per instroomland van de faculteit Sociale Wetenschappen.

### De data bekijken
```{r, collapse=TRUE}
Bsa_kt
barplot(Bsa_kt, beside = TRUE, legend.text = TRUE)
```

### {.tabset .tabset-fade}
#### Chi-kwadraat toets
Om `chisq.test()` in R te gebruiken moet de data in een kruistabel staan.
```{r collapse=TRUE}
chisq.test(Bsa_kt)
```

#### Fisher-Freeman-Halton exact toets
Gebruik `simulate.p.value = TRUE` bij `fisher.test()` om de p-waardes via een Monte Carlo simulatie te laten uitrekenen. Dit is nodig voor tabellen die groter zijn dan 2 bij 2.
``` {r fisher toets}
fisher.test(Bsa_kt_n10, simulate.p.value = TRUE)
fisher.test(Bsa_kt, simulate.p.value = TRUE)
```

## Toelichting op de output

## 5 Rapportage

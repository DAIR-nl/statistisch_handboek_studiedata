---
title: "One sample T-toets"
author: "Irene van der Staaij & Megiel Kerkhoven"
date: "1 Oktober 2019"
output: 
  html_document:
    toc: TRUE
    toc_float: TRUE
    theme: united
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
#opties voor themes: spacelab, readable, united, yeti
```

```{r aanmaken data, include=FALSE, echo=TRUE}
## inladen packages

## aanmaken dummydata
set.seed(95)

level1_cijfers <- c(4, 4.5, 5.0, 5.5, 6.0, 6.5, 7.0, 7.5, 8.0, 8.5, 9.0, 9.5, 10)
level2_cijfers <- c(5.0, 5.5, 6.0, 6.5, 7.0, 7.5, 8.0, 8.5, 9.0)
level3_cijfers <- c(6.0, 6.5, 7.0, 7.5, 8.0, 8.5)
level4_cijfers <- c(6.5, 7.0, 7.5)

Wiskundecijfers_level1 <- sample(level1_cijfers, 15, replace = TRUE)
Wiskunde_cijfers_level2 <- sample(level2_cijfers, 40, replace=TRUE)
Wiskunde_cijfers_level3 <- sample(level3_cijfers, 60, replace=TRUE)
Wiskunde_cijfers_level4 <- sample(level4_cijfers, 50, replace=TRUE)
Wiskunde_cijfers_level2_tot_level4 = c(Wiskunde_cijfers_level2,
                                      Wiskunde_cijfers_level3,
                                      Wiskunde_cijfers_level4)

Wiskunde_cijfers <- append(Wiskundecijfers_level1, Wiskunde_cijfers_level2_tot_level4)
```

## Gebruik

De *One sample t-toets* kan gebruikt worden om aan de hand van één steekproef het gemiddelde van de totale populatie te vergelijken met een vooraf opgestelde hypothese [^1]. 

## Voorbeeld uit het onderwijs

De bachelorcoördinator van de opleiding Wiskunde vraagt zich af of het wiskundeprogramma te zwaar is, daarom vraagt zij aan de studenten een schatting te maken hoeveel tijd ze per week aan de studie kwijt zijn. De coördinator wilt de schatting vergelijken met de 40 uur per week, die er staan voor het besteden aan de studie.

H~0~: Het gemiddeld aantal uur studeren van wiskunde studenten bij de opleiding Wiskunde is 40, µ <= 40. (minder on gelijk aan 40 uur is niet te zwaar)

H~A~: Het gemiddeld aantal uur studeren van wiskunde studenten bij de opleiding Wiskunde is anders dan 40,  µ > 40. (meer dan 40 uur is te zwaar)


## Assumpties

### Normaliteit 
De t-toets gaat er vanuit dat de data normaal verdeeld is, bij kleine steekproeven is dit vaker niet het geval. 

Controleer de data met deze stappen:
1. Controleer visueel door het maken van een dataplot: een histogram of een boxplot. 
2. Toets daarna of de data normaal verdeeld is met de The Kolmogorov-Smirnov Test of bij een kleinere steekproef, n < 30, met de The Shapiro-Wilk Test [^2]. 

Wanneer uit bovenstaande tests blijkt dat de data niet normaal verdeeld is, dus aan de assumptie niet wordt voldaan, dan mag de t-toets niet gebruikt worden. Gebruik in dat geval de Wilcoxon Signed Rank Test uit. [^3]

## Uitvoering in R
Voor de uitvoering in R is er een dummydataset genaamd Wiskunde_cijfers ingeladen met gemiddelde cijfers in Wiskunde A van 165 middelbare scholieren.

### Test assumpties: normaliteit
1. visualiseren van de data met behulp van een histogram
```{r histogram voor normaliteit}
hist(Wiskunde_cijfers)
```

De histogram laat een belvorm zien vergelijkbaar aan een normaalverdeling, veel waardes liggen rondom het gemiddelde en weinig bij de staarten van de verdeling. Daarnaast ziet de verdeling er in grote mate symmetrisch uit.  



### {.tabset .tabset-fade .tabset.pills}
#### Kolmogorov-Smirnov


```` {r Kolmogorov-Smirnov Test, warning=FALSE}
x <-rnorm(230)
#ks.test(Wiskunde_cijfers, x)
````
De kolmogorov-smirnov test is een non-parametrische toets, die het verschil in vorm tussen twee verdelingen toetst. In dit geval toetst deze test het verschil tussen de normaal verdeling en de verdeling van de steekproef.Wanneer de p-waarde kleiner is dan 0.05 is er een verschil tussen beide verdelingen. 

In dit geval is p > 0.05, dus is de verdeling van de data niet significant verschillend van de normaal verdeling. 

#### Shapiro-Wilk Test
``` {r Shapiro-Wilk Test, warning=FALSE}
shapiro.test(Wiskunde_cijfers)
```

De Shapiro-Wilk Test is een soort gelijke test als de Kolmogorov-smirnov test en wordt vooral gebruikt bij kleine steekproeven. Wanneer de p-waarde groter is dan 0.05 is de verdeling van de data niet significant verschillend van de normaal verdeling.
Huidige p-waarde is 000, dus niet significant verschillend. 


### One sample T-toets
```{r ttest}
t.test(Wiskunde_cijfers, mu = 6.9) # testen of het gemiddelde van onze studenten afwijkt van het landelijk gemiddelde (6.9)
```

## Toelichting op de output
Het gemiddelde van de steekproef is **
Degrees of freedom (df) = n -1 = 50 -1 = 49
p-waarde: boven de 0.05, dus de H~0~ wordt niet verworpen. 
95-betrouwbaarheidsinterval: Bij herhaling van het onderzoek zal in 95% van de gevallen een interval uitkomen waarbij mu er in valt. 


## Rapportage

## Verder lezen

[^1]: [Wiki Statistiek Academisch Medisch Centrum](https://wikistatistiek.amc.nl/index.php/T-toets#one_sample_t-toets)
[^2]: [UvA Wiki Methodologiewinkel](https://wiki.uva.nl/methodologiewinkel/index.php/Normaliteit)
[^3]: http://r-statistics.co/Statistical-Tests-in-R.html

Open Intro Statistics Third Edition 


## Achtergrond info

De t-toets wordt ingezet wanneer de data numeriek en (gedeeltelijk) normaal verdeeld is, maar de keuze welke t-toets men kiest is afhankelijk van het aantal groepen wat je bekijkt en de relatie tussen de twee groepen. 



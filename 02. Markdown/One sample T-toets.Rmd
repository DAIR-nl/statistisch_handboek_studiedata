---
title: "One sample T-toets"
author: "Irene van der Staaij & Megiel Kerkhoven"
date: "7/26/2019"
output:
  html_document: default
  pdf_document: default
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r aanmaken data, include=FALSE, echo=TRUE}
## inladen packages

## aanmaken dummydata
set.seed(95)

level1_cijfers <- c(4, 4.5, 5.0, 5.5, 6.0, 6.5, 7.0, 7.5, 8.0, 8.5, 9.0, 9.5, 10)
level2_cijfers <- c(5.0, 5.5, 6.0, 6.5, 7.0, 7.5, 8.0, 8.5, 9.0)
level3_cijfers <- c(6.0, 6.5, 7.0, 7.5, 8.0, 8.5)
level4_cijfers <- c(6.5, 7.0, 7.5)

Wiskundecijfers_level1 <- sample(level1_cijfers, 15, replace = TRUE)
Wiskunde_cijfers_level2 <- sample(level2_cijfers, 40, replace=TRUE)
Wiskunde_cijfers_level3 <- sample(level3_cijfers, 60, replace=TRUE)
Wiskunde_cijfers_level4 <- sample(level4_cijfers, 50, replace=TRUE)
Wiskunde_cijfers_level2_tot_level4 = c(Wiskunde_cijfers_level2,
                                      Wiskunde_cijfers_level3,
                                      Wiskunde_cijfers_level4)

Wiskunde_cijfers <- append(Wiskundecijfers_level1, Wiskunde_cijfers_level2_tot_level4)
```

## Gebruik

Gebruik de *One sample t-toets* bij een hypothese over het gemiddelde in één groep, bijvoorbeeld gemiddeld tentamencijfer.[^1].

## Voorbeeld uit het onderwijs

De opleidingsdirecteur van de opleiding Economie wil weten of het gemiddelde eindexamencijfer voor Wiskunde A van haar VWO studenten lager is dan het landelijke gemiddelde, zodat zij kan bepalen of het zinnig is om een zomercursus statistiek te starten.

H~0~: Het gemiddelde cijfer voor wiskunde A van VWO studenten bij de opleiding Economie is een 6,9, µ = 6,9. 

H~A~: Het gemiddelde cijfer voor wiskunde A van VWO studenten bij de opleiding Economie is anders dan een 6,9,  µ ≠ 6,9.


## Assumpties

### Normaliteit 
De t-toets gaat er vanuit dat de data normaal verdeeld is, dit hoeft vooral bij kleine steekproeven niet het geval te zijn. Checkt de data visueel op normaliteit door het maken van een dataplot: een histogram of een boxplot. Of een toets normaal verdeeld is wordt getoetst  door de The Kolmogorov-Smirnov Test en voor een kleinere steekproef de The Shapiro-Wilk Test [^2]. Wanneer aan de assumptie niet wordt voldaan, voer de non-parametrische toets de Wilcoxon Signed Rank Test uit. [^3]

## Uitvoering in R
Voor de uitvoering in R is er een dummydataset genaamd Wiskunde_cijfers ingeladen met gemiddelde cijfers in Wiskunde A van 165 middelbare scholieren.

### Normaliteit
```{r histogram voor normaliteit}
hist(Wiskunde_cijfers)
```

De histogram laat een belvorm zien vergelijkbaar aan een normaalverdeling, veel waardes liggen rondom het gemiddelde en weinig bij de staarten van de verdeling.



### {.tabset .tabset-fade .tabset.pills}
#### Kolmogorov-Smirnov


```` {r Kolmogorov-Smirnov Test, warning=FALSE}
x <-rnorm(230)
ks.test(Wiskunde_cijfers, x)
````
De kolmogorov-smirnov test is een non-parametrische toets, die het verschil in vorm tussen twee verdelingen toetst. In dit geval toetst deze test het verschil tussen de normaal verdeling en de verdeling van de steekproef.Wanneer de p-waarde kleiner is dan 0.05 is er een verschil tussen beide verdelingen. 

In dit geval is p > 0.05, dus is de verdeling van de data niet significant verschillend van de normaal verdeling. 

#### Shapiro-Wilk Test
``` {r Shapiro-Wilk Test, warning=FALSE}
shapiro.test(Wiskunde_cijfers)
```

De Shapiro-Wilk Test is een soort gelijke test als de Kolmogorov-smirnov test en wordt vooral gebruikt bij kleine steekproeven. Wanneer de p-waarde groter is dan 0.05 is de verdeling van de data niet significant verschillend van de normaal verdeling.
Huidige p-waarde is 000, dus niet significant verschillend. 


### One sample T-toets
```{r ttest}
t.test(Wiskunde_cijfers, mu = 6.9) # testen of het gemiddelde van onze studenten afwijkt van het landelijk gemiddelde (6.9)
```

## Toelichting op de output
Het gemiddelde van de steekproef is **
Degrees of freedom (df) = n -1 = 50 -1 = 49
p-waarde: boven de 0.05, dus de H~0~ wordt niet verworpen. 
95-betrouwbaarheidsinterval: Bij herhaling van het onderzoek zal in 95% van de gevallen een interval uitkomen waarbij mu er in valt. 


## Rapportage

## Verder lezen

[^1]: [Wiki Statistiek Academisch Medisch Centrum](https://wikistatistiek.amc.nl/index.php/T-toets#one_sample_t-toets)
[^2]: [UvA Wiki Methodologiewinkel](https://wiki.uva.nl/methodologiewinkel/index.php/Normaliteit)
[^3]: http://r-statistics.co/Statistical-Tests-in-R.html

Open Intro Statistics Third Edition 


## Achtergrond info

De t-toets wordt ingezet wanneer de data numeriek en (gedeeltelijk) normaal verdeeld is, maar de keuze welke t-toets men kiest is afhankelijk van het aantal groepen wat je bekijkt en de relatie tussen de twee groepen. 



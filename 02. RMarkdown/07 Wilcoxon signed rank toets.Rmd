---
title: "07 Wilcoxon signed rank toets"
author: "Â© 2019, SURF Versnellingsagenda - Statistisch Handboek Hoger Onderwijs"
date: "`r format(Sys.time(), '%d-%m-%Y')`"
output:
  html_document:
    theme: lumen
    toc: yes
    toc_float: 
      collapsed: FALSE 
    number_sections: true
  keywords: [statistisch handboek, studiedata]
---

<style>
`r htmltools::includeHTML(paste0(here::here(),"/03. Includes/css/Stylesheet SHHO.css"))`
</style>

```{r header, include = FALSE, echo = TRUE, results='asis'} 
paste0(here::here(),"/03. Includes/code/Header.R")
```

<!-- ## BLOK: Functiedefinities.R -->
```{r functiedefinities,include=FALSE, echo=TRUE}
library(stringr)
Round_and_format <- function(x, digits = 2) {
  x <- as.character(round(x, digits))
  x <- str_replace(x, "[.]", ",")
  return(x)
}
```
<!-- ## /BLOK: Functiedefinities.R -->

<!-- ## BLOK: Data-aanmaken.R -->
```{r aanmaken data, include=FALSE, echo=TRUE}
RNGkind(sample.kind = "Rounding")
set.seed(1)
Mogelijkheden <- c(1616:7000)

p_t1 <- c(
  rep(0.4,  385),     #1616-2000
  rep(0.55, 400),     #2000-2400
  rep(0.7,  400),     #2401-2800
  rep(0.8,  400),     #2801-3200
  rep(0.65, 400),     #3201-3600
  rep(0.45, 400),     #3601-4000
  rep(0.2,  1000),    #4001-5000
  rep(0.1,  1000),    #5001-6000
  rep(0.01, 1000)     #6001-7000
)
Jaarlijks_inkomen_t1 <- replicate(307, 13*(sample(Mogelijkheden, 1, replace=TRUE, p_t1)))


Promotie_mogelijkheden <- c(0, 650, 1300, 2600, 6500, -650, -1300, -2600)
Weging               <- c(800, 400,  200,   100,  10,  200,   100,    50)
Opslag <- sample(Promotie_mogelijkheden, 307, replace=TRUE, Weging)
Jaarlijks_inkomen_t5 <- Jaarlijks_inkomen_t1 + Opslag
Studentnr <- 2*sample(3000000:4000000, length(Jaarlijks_inkomen_t1))
Inkomen<- c(Jaarlijks_inkomen_t1, Jaarlijks_inkomen_t5)
Datum <- c(replicate(length(Jaarlijks_inkomen_t1), "t1"), (replicate(length(Jaarlijks_inkomen_t5), "t5")))

Alumni_inkomens <- data.frame(Studentnr, Datum, Inkomen)

```
<!-- ## /BLOK: Data-aanmaken.R -->

## Toepassing

Gebruik de *Wilcoxon signed rank toets* om te toetsen of bij een herhaalde meting de waardes van een groep aan elkaar gelijk zijn. Een voordeel van deze test is dat het voor alle type data gebruikt kan worden.[^1]   
De *Wilcoxon Signed Rank Test* wordt vaak als alternatief gezien voor de *gepaarde t-toets*. De *Wilcoxon Signed Rank Test* maakt een rangschikking van de data. Hierdoor is de test verdelingsvrij en is normaliteit geen assumptie. Ook zijn uitbijters minder van invloed op het eindresultaat. Toch wordt er voor deze test minder vaak gekozen, dit komt doordat bij het maken van een rankschikking de data informatie verliest. Als de data wel normaal verdeeld is heeft de *Wilcoxon signed rank toets* minder onderscheidend vermogen, dan wanneer de *one sample t-toets* uitgevoerd zou worden.
 
## Onderwijscasus
<div id ="casus">
De directeur wil kijken hoe het inkomen van zijn alumni zich ontwikkeld 4 jaar nadat zij afgestudeerd zijn.

</div>

## Assumpties

## Uitvoering in R
Er is data ingeladen met jaarlijkse bruto inkomens van alumni van de Academie Mens & Maatschappij genaamd `Jaarlijks_inkomen`. De directeur wil kijken hoe het inkomen van zijn alumni zich ontwikkeld 4 jaar nadat zij afgestudeerd zijn.

### De data bekijken
Bekijk de data door het gemiddelde, de standaardafwijking, de mediaan en een histogram op te vragen.

<!-- ## BLOK: Data-bekijken.R -->
```{r data bekijken, collapse = TRUE}
## Eerste 6 observaties
head(Alumni_inkomens)

## Laatste 6 observaties
tail(Alumni_inkomens)
```
<!-- ## /BLOK: Data-bekijken.R -->

<!-- ## BLOK: Data-selecteren.R -->
```{r data selecteren}
Jaarlijks_inkomen_t1 <- Alumni_inkomens$Inkomen[Alumni_inkomens$Datum == "t1"]
Jaarlijks_inkomen_t5 <- Alumni_inkomens$Inkomen[Alumni_inkomens$Datum == "t5"]
```

<div class="col2">
<!-- ## BLOK: Data-beschrijven-1.R -->
```{r, data beschrijven 1, collapse=TRUE}
mean(Jaarlijks_inkomen_t1)
sd(Jaarlijks_inkomen_t1)
median(Jaarlijks_inkomen_t1)
```
<!-- ## /BLOK: Data-beschrijven-1.R -->
<!-- ## BLOK: Data-beschrijven-2.R -->
``````{r Data beschrijven 2, collapse=TRUE}
mean(Jaarlijks_inkomen_t5)
sd(Jaarlijks_inkomen_t5)
median(Jaarlijks_inkomen_t5)
```
<!-- ## /BLOK: Data-beschrijven-2.R -->
</div>

### Normaliteit testen
Test of de data normaal verdeeld is met een lilliefors-test
<!-- BLOK: Library-nortest.R -->
```{r library nortest, warning=FALSE}
library(nortest)
```
<!-- /BLOK: Library-nortest.R -->
<div class="col2">
<!-- BLOK: Lilliefors-test.R -->
```{r normaliteitstest, warning=FALSE}
lillie.test(Jaarlijks_inkomen_t1)
lillie.test(Jaarlijks_inkomen_t5)
```
<!-- BLOK: Lilliefors-test.R -->

</div>

### Wilcoxon signed rank toets
Voer een Wilcoxon signed rank toets uit met `paired=TRUE`.
<!-- ## BLOK: Wilcoxon-signed-rank-toets.R -->
```{r wilcox test}
wilcox.test(Jaarlijks_inkomen_t5, Jaarlijks_inkomen_t1, paired=TRUE, alternative = "greater")
```
<!-- ## /BLOK: Wilcoxon-signed-rank-toets.R -->

### Toelichting op de output

## Rapportage

[^1]: van Geloven, N. (25 september2013). *Wilcoxon signed rank toets* [Wiki Statistiek Academisch Medisch Centrum](https://wikistatistiek.amc.nl/index.php/Wilcoxon_signed_rank_toets).



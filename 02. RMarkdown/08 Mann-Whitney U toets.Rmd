---
title: "Mann-Whitney U toets"
author: "Â© 2019, SURF Versnellingsagenda - Statistisch Handboek Hoger Onderwijs"
date: "`r format(Sys.time(), '%d-%m-%Y')`"
output:
  html_document:
    theme: lumen
    toc: yes
    toc_float: 
      collapsed: FALSE 
    number_sections: true
  keywords: [statistisch handboek, studiedata]
---

<style>
`r htmltools::includeHTML(paste0(here::here(),"/03. Includes/css/Stylesheet SHHO.css"))`
</style>

```{r header, include = FALSE, echo = TRUE, results='asis'} 
paste0(here::here(),"/03. Includes/code/Header.R")
```

<!-- ## BLOK: Functiedefinities.R -->
```{r functiedefinities,include=FALSE, echo=TRUE}
library(stringr)
Round_and_format <- function(x, digits = 2) {
  x <- as.character(round(x, digits))
  x <- str_replace(x, "[.]", ",")
  return(x)
}
```
<!-- ## /BLOK: Functiedefinities.R -->
<!-- ## BLOK: Data-aanmaken.R -->
```{r aanmaken data, include=FALSE, echo=TRUE}
## De directeur van een hogeschool vraagt zich af of wat de invloed is van internationalisering op zijn instelling. Hij gebruikt hiervoor het totaal aantal punten behaald in het tweedejaar zodat uitval een minder grote rol speelt. Hij vraagt zich daarom af: is het behaald aantal EC in het tweede jaar van internationale studenten hoger dan van de Nederlandse studenten?

RNGkind(sample.kind = "Rounding")
set.seed(0)

Goede_student_ec <- c(0, 3, 6, 6, 6, 6, 6, 6, 6)
Matige_student_ec <- c(0, 0, 0, 3, 6, 6, 6, 6, 6)
Slechte_student_ec <- c(0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 6)

Resultaten_nl_studenten <- rbind (
                                  t(replicate(401, sample(Goede_student_ec, 11, replace = TRUE))), 
                                  t(replicate(203, sample(Matige_student_ec, 11, replace = TRUE))),
                                  t(replicate(309, sample(Slechte_student_ec, 11, replace = TRUE))))
Punten_jaar2_NL <- margin.table(Resultaten_nl_studenten, 1)

Resultaten_internationale_studenten <- rbind (
                                  t(replicate(250, sample(Goede_student_ec, 11, replace = TRUE))), 
                                  t(replicate(100, sample(Matige_student_ec, 11, replace = TRUE))),
                                  t(replicate(200, sample(Slechte_student_ec, 11, replace = TRUE))))
Punten_jaar2_inter <- margin.table(Resultaten_internationale_studenten, 1)
Studentnr <- sample(3000000:4000000, length(c(Punten_jaar2_NL, Punten_jaar2_inter)))

Punten_jaar2 <- data.frame(Studentnr, c(Punten_jaar2_NL, Punten_jaar2_inter), 
                           c(rep("ja", length(Punten_jaar2_NL)), rep("nee", length(Punten_jaar2_inter))))
colnames(Punten_jaar2)<-c("Studentnr", "EC_jaar2", "Nederlands")
Punten_jaar2 <- Punten_jaar2[order(Studentnr),]
```
<!-- ## /BLOK: Data-aanmaken.R -->
# Toepassing

# Onderwijscasus

# Assumpties

# Uitvoering in R
Er is data ingeladen met het aantal punten studenten in hun tweede jaar halen. `Punten_jaar2_NL` bevat Nederlandse studenten, `Punten_jaar2_inter` bevat internationale studenten. 

## De data bekijken
Gebruik `head()` in R om de eerste vijf regels te bekijken

<!-- ## BLOK: Data-bekijken.R -->
```{r data bekijken, collapse = TRUE}
## Eerste 6 observaties
head(Punten_jaar2)
## Eerste 6 observaties
tail(Punten_jaar2)
```
<!-- ## /BLOK: Data-bekijken.R -->

## De Mann-Whitney U toets in R
Gebruik `wilcox.test()` met twee argumenten om een Mann-Whitney U toets te doen in R
<!-- ## BLOK: Mann-Whitney-U-toets.R -->
```{r Mann Whitney U toets}
Nederlands <- Punten_jaar2$Nederlands == "ja"
wilcox.test(Punten_jaar2$EC_jaar2[Nederlands], 
            Punten_jaar2$EC_jaar2[!Nederlands])
```
<!-- ## /BLOK: Mann-Whitney-U-toets.R -->
# Toelichting op de output

# Rapportage


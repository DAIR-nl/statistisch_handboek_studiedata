---
title: "Gepaarde t-toets"
output:
  html_document:
    theme: lumen
    toc: yes
    toc_float: 
      collapsed: FALSE 
    number_sections: true
  keywords: [statistisch handboek, studiedata]
---

<!-- ## CLOSEDBLOK: Functies.R -->
```{r functies, include = TRUE, echo = FALSE, results='asis', warning=FALSE, message=FALSE}
library(here)
if (!exists("Substitute_var")) {
  ## Installeer packages en functies
  source(paste0(here::here(), "/99. Functies en Libraries/00. Voorbereidingen.R"), echo = FALSE)
}
```
<!-- ## /CLOSEDBLOK: Functies.R -->

<style>
`r htmltools::includeHTML(paste0(here::here(),"/01. Includes/css/Stylesheet_SHHO.css"))`
</style>

<!-- ## CLOSEDBLOK: Header.R -->
```{r header, include = TRUE, echo = FALSE, results='asis', code =  readLines(paste0(here::here(),"/01. Includes/code/Header.R"))} 
```
<!-- ## /CLOSEDBLOK: Header.R -->

<!-- ## CLOSEDBLOK: Reticulate.R -->
```{r reticulate, include = TRUE, echo = FALSE, warning=FALSE, message=FALSE}
library(reticulate)
knitr::knit_engines$set(python = reticulate::eng_python)
```
<!-- ## /CLOSEDBLOK: Reticulate.R -->

```{r opmerking, include=FALSE, eval=FALSE}
# doorlinken naar de Wilcoxon Signed Rank Test
# linken naar blz transformeren data 
```

<!-- ## OPENBLOK: Data-aanmaken.py -->
```{r aanmaken data, include=FALSE, echo=TRUE}
source(paste0(here::here(),"/01. Includes/data/02.R"))
```
<!-- ## /OPENBLOK: Data-aanmaken.py -->

<!-- ## TEKSTBLOK: Dataset-inladen.R-->
Er is een dataset ingeladen met het gemiddeld aantal uren studeren voor (T~0~) en na (T~1~) de cursus. De gemiddeldes per onderwijsperiode zijn afgerond op 1 decimaal in de dataset `Studielogboek`. 
<!-- ## /TEKSTBLOK: Dataset-inladen.R-->

## De data bekijken
Gebruik `<dataframe>.head()` en `<dataframe>.tail()` om de structuur van de data te bekijken.
<!-- ## OPENBLOK: Data-bekijken.py -->
```{python, include=FALSE}
import pandas as pd
dfStudielogboek = pd.DataFrame(r.Studielogboek)
```

```{python data bekijken-1, collapse = TRUE}
## Eerste 6 observaties
print(dfStudielogboek.head(6))
```

```{python data bekijken-2, collapse = TRUE}
## Laatste 6 observaties
print(dfStudielogboek.tail(6))
```
<!-- ## /OPENBLOK: Data-bekijken.py -->

<!-- ## OPENBLOK: Data-selecteren.py -->
```{python data selecteren}
Uren_studeren_T0 = dfStudielogboek[dfStudielogboek['Meetmoment'] == "T0"]['Uren_studeren']
Uren_studeren_T1 = dfStudielogboek[dfStudielogboek['Meetmoment'] == "T1"]['Uren_studeren']
```
<!-- ## /OPENBLOK: Data-selecteren.py -->

<!-- ## OPENBLOK: Data-beschrijven-1.py -->
```{python}
# Om het gemiddelde en de standaard deviatie te berekenen, hebben we de library 'numpy' nodig
import numpy as np
```

<div class = "col-container">
  <div class = "col">
```{python data beschrijven t1, collapse = TRUE}
## aantallen, gemiddelde en standaarddeviatie voor tutorgesprek
print(len(Uren_studeren_T0))
print(np.mean(Uren_studeren_T0))
print(np.sqrt(np.var(Uren_studeren_T0)))
```
<!-- ## /OPENBLOK: Data-beschrijven-1.py -->
```{r Var beschrijven t0, include=FALSE, echo=TRUE}
vMean_t0 <- Round_and_format(mean(Uren_studeren_T0))
vSD_t0 <- Round_and_format(sd(Uren_studeren_T0))
vN_t0 <- Round_and_format(length(Uren_studeren_T0))
```
  </div>
<!-- ## OPENBLOK: Data-beschrijven-2.py -->
 <div class = "col">
```{python data bekijken t2, collapse=TRUE}
## aantallen, gemiddelde en standaarddeviatie na tutorgesprek
print(len(Uren_studeren_T1))
print(np.mean(Uren_studeren_T1))
print(np.sqrt(np.var(Uren_studeren_T1)))
```
<!-- ## /OPENBLOK: Data-beschrijven-2.py -->

<!-- ## OPENBLOK: Histogram.py -->
```{python histogram}
## Histogram met matplotlib
import matplotlib.pyplot as plt
fig = plt.figure()
sub1 = fig.add_subplot(1, 2, 1)
title1 = plt.title("voor")
hist1 = plt.hist(Uren_studeren_T0, density = True, edgecolor = "black", bins = 9)

sub2 = fig.add_subplot(1, 2, 2)
title2 = plt.title("na")
hist2 = plt.hist(Uren_studeren_T1, density = True, edgecolor = "black", bins = 9)

main = fig.suptitle('Gemiddeld uren studeren voor en na cursus')
plt.show()
```
<!-- ## /OPENBLOK: Histogram.py -->

<!-- ## TEKSTBLOK: QQplot.py -->
Importeer `scipy.stats` om een Q-Q plot te maken en statistische testen uit te voeren. Voor een Q-Q plot kan de functie `scipy.stats.probplot()` worden gebruikt.
<!-- ## TEKSTBLOK: QQplot.py -->

<!-- ## OPENBLOK: QQplot-inladen.py -->
```{python}
import scipy.stats as stats
```
<!-- ## /OPENBLOK: QQplot-inladen.py -->

<div class = "col-container">
  <div class="col">
<!-- ## OPENBLOK: QQplot-1.py -->
```{python qqplot}
qq = stats.probplot(Uren_studeren_T0, dist="norm", plot=plt)
title = plt.title("Normaal Q-Q plot studielogboek voor cursus")
xlab = plt.xlabel("Theoretische kwantielen")
ylab = plt.ylabel("Kwantielen in data")
plt.show()
```
<!-- ## /OPENBLOK: QQplot-1.py -->
  </div>
  <div class = "col">
<!-- ## OPENBLOK: QQplot-2.py -->
```{python qqplot-2}
qq = stats.probplot(Uren_studeren_T1, dist="norm", plot=plt)
title = plt.title("Normaal Q-Q plot studielogboek na cursus")
xlab = plt.xlabel("Theoretische kwantielen")
ylab = plt.ylabel("Kwantielen in data")
plt.show()
```
<!-- ## /OPENBLOK: QQplot-2.py -->
  </div>
</div>

<!-- ## OPENBLOK: Boxplot.py -->
``` {python Boxplot}
## Boxplot
fig, ax = plt.subplots()
box = ax.boxplot([Uren_studeren_T0, Uren_studeren_T1], labels = ["Voor", "Na"])
title = plt.title("Boxplot van studielogboek")
plt.show()
```
<!-- ## /OPENBLOK: Boxplot.py -->

<!-- ## TEKSTBLOK: Lilliefors-test1.py -->
De standaard interpretatie van een statitische toets in Python is als volgt: `(<teststatistiek>, <p-waarde>)`.
<!-- ## /TEKSTBLOK: Lilliefors-test1.py -->

<!-- ## OPENBLOK: Library-nortest.py -->
```{python}
import statsmodels.stats.api
```
<!-- ## OPENBLOK: Library-nortest.py -->

<div class="col-container">
  <div class = "col">
<!-- ## OPENBLOK: Lilliefors-test-1.py -->
``` {python Lilliefors Test-1, warning=FALSE}
print(statsmodels.stats.api.lilliefors(Uren_studeren_T0))
```
<!-- ## /OPENBLOK: Lilliefors-test-1.py -->
  </div>
  <div class = "col">
<!-- ## OPENBLOK: Lilliefors-test-2.py -->
``` {python Lilliefors Test-2, warning=FALSE}
print(statsmodels.stats.api.lilliefors(Uren_studeren_T1))
```
<!-- ## /OPENBLOK: Lilliefors-test-2.py -->
  </div>
</div>

<!-- ## TEKSTBLOK: Shapiro-Wilk-test.py -->
```{python}
Uren_studeren_T0_n30 = r.Uren_studeren_T0_n30
Uren_studeren_T1_n30 = r.Uren_studeren_T1_n30
N1 = len(Uren_studeren_T0_n30)
N2 = len(Uren_studeren_T1_n30)
```

Er zijn 2 steekproeven van `Studielogboek` ingeladen: `Uren_studeren_T0_n30` (T~0~) en `Uren_studeren_T1_n30` (T~1~), *n~T0~* = `r py$N1` , *n~T1~* = `r py$N2` 
<!-- ## /TEKSTBLOK: Shapiro-Wilk-test.py -->

<div class ="col-container">
  <div class ="col">
<!-- ## OPENBLOK: Shapiro-Wilk-test-1.py -->
``` {python Shapiro-Wilk Test-1, warning=FALSE}
print(stats.shapiro(r.Uren_studeren_T0_n30))
```
<!-- ## /OPENBLOK: Shapiro-Wilk-test-1.py -->
  </div>
  <div class ="col">
<!-- ## OPENBLOK: Shapiro-Wilk-test-2.py -->
``` {python Shapiro-Wilk Test-2, warning=FALSE}
print(stats.shapiro(r.Uren_studeren_T1_n30))
```
<!-- ## /OPENBLOK: Shapiro-Wilk-test-2.py -->
  </div>
</div>

<!-- ## TEKSTBLOK: T-test.py -->
Gebruik `stats.ttest_rel()` om een *gepaarde t-toets* uit te voeren. Gebruik hier weer de twee variabelen `Uren_studeren_T0` en `Uren_studeren_T1`.
<!-- ## /TEKSTBLOK: T-test.py -->

<!-- ## OPENBLOK: T-toets.py -->
```{python T-test}
print(stats.ttest_rel(Uren_studeren_T0, Uren_studeren_T1))
```
<!-- ## /OPENBLOK: T-toets.py -->

<!-- ## TEKSTBLOK: T-test2.R -->
```{python T-test als object, echo = FALSE}
stat, pval = stats.ttest_rel(Uren_studeren_T0, Uren_studeren_T1)
df = N1 - 1
diffmean = np.mean(np.abs(Uren_studeren_T0 - Uren_studeren_T1))
```
* *t*~`r py$df`~ = `r Round_and_format(py$stat)`, *p* << 0,05
* Vrijheidsgraden, *df* = *n* -1 = `r py$N1`-1 = `r py$df`  
* p-waarde < 0,05, dus de H~0~ wordt verworpen en de H~A~ wordt aangenomen [^10]
* het absolute verschil tussen de twee groepen: `r Round_and_format(py$diffmean)` 
<!-- ## TEKSTBLOK: T-test2.R -->

<!-- ## OPENBLOK: Cohens-d-test.py -->
```{python}
def cohen.d(x, y):
  # import numpy
  import numpy as np
	
	# calculate the size of samples
  n1, n2 = len(x), len(y)
	
	# calculate the variance of the samples
  v1, v2 = np.var(x, ddof=1), np.var(y, ddof=1)
	
	# calculate the pooled standard deviation
  s = np.sqrt(((n1 - 1) * v1 + (n2 - 1) * v2) / (n1 + n2 - 2))
	
	# calculate the means of the samples
  m1, m2 = np.mean(x), np.mean(y)
	
	# calculate the effect size
  return (m1 - m2) / s
```

```{python}
print(cohen.d(Uren_studeren_T0, Uren_studeren_T1))
```
<!-- ## OPENBLOK: Cohens-d-test.py -->

<!-- ## TEKSTBLOK: Cohens-d-test.py -->
```{python}
d = cohen.d(Uren_studeren_T0, Uren_studeren_T1)
```
*d* = `r Round_and_format(py$d)`. De sterkte van het effect van de tutor op het cijfer is minimaal. 
<!-- ## /TEKSTBLOK: Cohens-d-test.py -->
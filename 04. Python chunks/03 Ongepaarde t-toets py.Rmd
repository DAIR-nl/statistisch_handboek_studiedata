
---
title: "Ongepaarde t-toets"
output:
  html_document:
    theme: lumen
    toc: yes
    toc_float: 
      collapsed: FALSE 
    number_sections: true
  keywords: [statistisch handboek, studiedata]
---

<!-- ## CLOSEDBLOK: Functies.R -->
```{r functies, include = TRUE, echo = FALSE, results='asis', warning=FALSE, message=FALSE}
library(here)
if (!exists("Substitute_var")) {
  ## Installeer packages en functies
  source(paste0(here::here(), "/99. Functies en Libraries/00. Voorbereidingen.R"), echo = FALSE)
}
```
<!-- ## /CLOSEDBLOK: Functies.R -->

<style>
`r htmltools::includeHTML(paste0(here::here(),"/01. Includes/css/Stylesheet_SHHO.css"))`
</style>

<!-- ## CLOSEDBLOK: Header.R -->
```{r header, include = TRUE, echo = FALSE, results='asis', code =  readLines(paste0(here::here(),"/01. Includes/code/Header.R"))} 
```
<!-- ## /CLOSEDBLOK: Header.R -->

<!-- ## CLOSEDBLOK: Reticulate.R -->
```{r reticulate, include = TRUE, echo = FALSE, warning=FALSE, message=FALSE}
library(reticulate)
knitr::knit_engines$set(python = reticulate::eng_python)
```
<!-- ## /CLOSEDBLOK: Reticulate.R -->

<!-- ## OPENBLOK: Data-aanmaken.py -->
```{r aanmaken data, include=FALSE, echo=TRUE}
source(paste0(here::here(),"/01. Includes/data/03.R"))
```
<!-- ## /OPENBLOK: Data-aanmaken.py -->

<!-- ## TEKSTBLOK: Dataset-inladen.py -->
Er is een dataset ingeladen met gemiddelde cijfers van tweedejaarsstudenten bij de opleiding Taalwetenschap: `Cijfers_gem`. De data bevatten cijfers van 180 studenten begonnen in 2010 en cijfers van 160 studenten begonnen in 2011.
<!-- ## /TEKSTBLOK: Dataset-inladen.py -->

<!-- ## TEKSTBLOK: Data-bekijken.py -->
Gebruik `<dataframe>.head()` en `<dataframe>.tail()` om de structuur van de data te bekijken.
<!-- ## /TEKSTBLOK: Data-bekijken.py -->

<!-- ## OPENBLOK: Data-bekijken.py -->
```{python, include=FALSE}
import pandas as pd
dfCijfers_gem = pd.DataFrame(r.Cijfers_gem)
```

```{python data bekijken-1, collapse = TRUE}
## Eerste 6 observaties
print(dfCijfers_gem.head(6))
```

```{python data bekijken-2, collapse = TRUE}
## Laatste 6 observaties
print(dfCijfers_gem.tail(6))
```
<!-- ## /OPENBLOK: Data-bekijken.py -->

<!-- ## OPENBLOK: Data-selecteren.py -->
```{python data selecteren}
Cijfers_2010 = dfCijfers_gem[dfCijfers_gem['Cohort'] == 2010]['Cijfers']
Cijfers_2011 = dfCijfers_gem[dfCijfers_gem['Cohort'] == 2011]['Cijfers']
```
<!-- ## /OPENBLOK: Data-selecteren.py -->

<!-- ## TEKSTBLOK: Data-beschrijven.py -->
Inspecteer de data met `len()`, `np.mean()` en `np.sqrt(np.var())`, door deze aan te roepen uit de library `numpy`.
<!-- ## /TEKSTBLOK: Data-beschrijven.py -->

<!-- ## OPENBLOK: Data-beschrijven-inladen.py -->
```{python}
# Om het gemiddelde en de standaard deviatie te berekenen, hebben we de library 'numpy' nodig
import numpy as np
```
<!-- ## OPENBLOK: Data-beschrijven-inladen.py -->

<div class="col2">
<!-- ## OPENBLOK: Data-beschrijven-1.py -->
```{python Data beschrijven 1, collapse=TRUE}
## Aantallen, gemiddelde en standaarddeviatie 2010
print(len(Cijfers_2010))
print(np.mean(Cijfers_2010))
print(np.sqrt(np.var(Cijfers_2010)))
```
<!-- ## /OPENBLOK: Data-beschrijven-1.py -->

<!-- ## OPENBLOK: Data-beschrijven-2.py -->
```{python Data beschrijven 2, collapse=TRUE}
## Aantallen, gemiddelde en standaarddeviatie 2011
print(len(Cijfers_2011))
print(np.mean(Cijfers_2011))
print(np.sqrt(np.var(Cijfers_2011)))
```
<!-- ## /OPENBLOK: Data-beschrijven-2.py -->

<!-- ## CLOSEDBLOK: Data-beschrijven.R -->
```{r Var beschrijven t1, include=FALSE, echo=TRUE}
vN_t0 = len(Cijfers_2010)
vMean_t0 = np.mean(Cijfers_2010)
vSD_t0 = np.sqrt(np.var(Cijfers_2010))
vN_t1 = len(Cijfers_2011)
vMean_t1 = np.mean(Cijfers_2011)
vSD_t1 = np.sqrt(np.var(Cijfers_2011))
```
<!-- ## /CLOSEDBLOK: Data-beschrijven.R -->
</div>

<!-- ## TEKSTBLOK: Data-beschrijven.py -->
* Gemiddeld tentamencijfer 2010 (standaarddeviatie): `r py$vMean_t0` (`r py$vSD_t0`). *n* = `r py$vN_t0`.
* Gemiddeld tentamencijfer 2011 (standaarddeviatie): `r py$vMean_t1` (`r py$vSD_t1`). *n* = `r py$vN_t1`.
<!-- ## TEKSTBLOK: Data-beschrijven.py -->

<!-- ## OPENBLOK: Histogram.py -->
```{python histogram}
## Histogram met matplotlib
import matplotlib.pyplot as plt
fig = plt.figure()
sub1 = fig.add_subplot(1, 2, 1)
title1 = plt.title("2010")
hist1 = plt.hist(Cijfers_2010, density = True, edgecolor = "black", bins = 9)

sub2 = fig.add_subplot(1, 2, 2)
title2 = plt.title("2011")
hist2 = plt.hist(Cijfers_2011, density = True, edgecolor = "black", bins = 9)

main = fig.suptitle('Taalwetenschap gemiddelde cijfers voor en na de BSA')
plt.show()
```
<!-- ## /OPENBLOK: Histogram.py -->

<!-- ## TEKSTBLOK: QQplot.py -->
Importeer `scipy.stats` om een Q-Q plot te maken en statistische testen uit te voeren. Voor een Q-Q plot kan de functie `scipy.stats.probplot()` worden gebruikt.
<!-- ## TEKSTBLOK: QQplot.py -->

<div class ="col-container">
  <div class = "col"> 
<!-- ## OPENBLOK: QQplot-t1.py -->
```{python QQplot-t1}
import scipy.stats as stats
qq = stats.probplot(Cijfers_2010, dist="norm", plot=plt)
title = plt.title("Normaal Q-Q plot van tentamencijfers 2010")
xlab = plt.xlabel("Theoretische kwantielen")
ylab = plt.ylabel("Kwantielen in data")
plt.show()
```
<!-- ## /OPENBLOK: QQplot-t1.py -->
  </div>
  <div class = "col">
<!-- ## OPENBLOK: QQplot-t2.py -->
```{python QQplot-t2}
import scipy.stats as stats
qq = stats.probplot(Cijfers_2011, dist="norm", plot=plt)
title = plt.title("Normaal Q-Q plot van tentamencijfers 2011")
xlab = plt.xlabel("Theoretische kwantielen")
ylab = plt.ylabel("Kwantielen in data")
plt.show()
```
<!-- ## /OPENBLOK: QQplot-t2.py -->
  </div>
</div>

<!-- ## OPENBLOK: Boxplot.py -->
```{python boxplot}
fig, ax = plt.subplots()
box = ax.boxplot([Cijfers_2010, Cijfers_2011], labels = ["2010", "2011"])
title = plt.title("Tentamencijfers Taalwetenschap voor en na de BSA")
plt.show()
```
<!-- ## /OPENBLOK: Boxplot.py -->

<!-- ## TEKSTBLOK: Lilliefors-test1.py -->
De standaard interpretatie van een statitische toets in Python is als volgt: `(<teststatistiek>, <p-waarde>)`.
<!-- ## /TEKSTBLOK: Lilliefors-test1.py -->

<!-- ## /OPENBLOK: Library-nortest inladen.py -->
```{python}
import statsmodels.stats.api
```
<!-- ## /OPENBLOK: Library-nortest inladen.py -->

<div class="col-container">
  <div class = "col">
<!-- ## OPENBLOK: Lilliefors-test-1.py -->
``` {python Lilliefors Test-1, warning=FALSE}
print(statsmodels.stats.api.lilliefors(Cijfers_2010))
```
<!-- ## /OPENBLOK: Lilliefors-test-1.py -->
  </div>
  <div class = "col">
<!-- ## OPENBLOK: Lilliefors-test-2.py -->
``` {python Lilliefors Test-2, warning=FALSE}
print(statsmodels.stats.api.lilliefors(Cijfers_2011))
```
<!-- ## /OPENBLOK: Lilliefors-test-2.py -->
  </div>
</div>

<!-- ## TEKSTBLOK: Shapiro-Wilk-test -->
```{python}
Cijfers_2010_n30 = r.Cijfers_2010_n30
Cijfers_2011_n30 = r.Cijfers_2011_n30
n = len(Cijfers_2010_n30)
```
Er zijn 2 steekproeven van `Cijfers_gem` ingeladen: `Cijfers_2010_n30` en `Cijfers_2011_n30`. Beide steekproeven bevatten `r py$n` studenten
<!-- ## TEKSTBLOK: Shapiro-Wilk-test -->

<div class = "col-container">
  <div class="col">
<!-- ## OPENBLOK: Shapiro-Wilk-test-1.py -->
``` {python Shapiro-Wilk Test-1, warning=FALSE}
print(stats.shapiro(r.Cijfers_2011_n30))
```
<!-- ## /OPENBLOK: Shapiro-Wilk-test-1.py -->
  </div>
  <div class="col">
<!-- ## OPENBLOK: Shapiro-Wilk-test-2.py -->
``` {python Shapiro-Wilk Test-2, warning=FALSE}
print(stats.shapiro(r.Cijfers_2010_n30))
```
<!-- ## /OPENBLOK: Shapiro-Wilk-test-2.py -->
  </div>
</div>

<!-- ## TEKSTBLOK: Levenes-test -->
Test met de Levene's test de homogeniteit van varianties. Gebruik hier de variabelen `Cijfers_2010` en `Cijfers_2011`.
<!-- ## /TEKSTBLOK: Levenes-test -->

<!-- ## OPENBLOK: Levenes-test.py -->
```{python Levenes test}
print(stats.levene(Cijfers_2010, Cijfers_2011))
```
<!-- ## OPENBLOK: Levenes-test.py -->

<!-- ## /OPENBLOK: Levenes-test.py -->
```{python Levenes test als object, echo = FALSE, warning=FALSE}
stat, pval = stats.levene(Cijfers_2010, Cijfers_2011)
DF1 = 1
DF2 = len(Cijfers_2010) + len(Cijfers_2011) - 2
```
<!-- ## /OPENBLOK: Levenes-test.py -->

<!-- ## TEKSTBLOK: Levenes-test2 -->
* *F*~`r py$DF1`~~,~~`r py$DF2`~ = `r py$stat`, p-waarde = `r py$pval` 
* p-waarde > 0,05, dus de groepen zijn niet significant verschillend in spreiding.  
* Vrijheidsgraden bestaan uit twee cijfers, het eerste cijfer (het aantal groepen - 1 = `r py$DF1`) en het tweede cijfer (*n~2010~* + *n~2011~* - 2 = `r py$DF2`)
<!-- ## /TEKSTBLOK: Levenes-test2 -->

<!-- ## TEKSTBLOK: T-test -->
Voer een ongepaarde t-toets uit met de functie `stats.ttest_ind()` .
<!-- ## /TEKSTBLOK: T-test -->

<!-- ## OPENBLOK: T-test.py -->
```{python statistische toets}
print(stats.ttest_ind(Cijfers_2010, Cijfers_2011))
```
<!-- ## /OPENBLOK: T-test.py -->

<!-- ## CLOSEDBLOK: T-test.R -->
```{python T-test als object, echo = FALSE}
stat, pval = stats.ttest_ind(Cijfers_2010, Cijfers_2011)
n = len(Cijfers_2010)
df = len(Cijfers_2010) - 1
mean1 = np.mean(Cijfers_2010)
mean2 = np.mean(Cijfers_2011)
```
<!-- ## /CLOSEDBLOK: T-test.R -->

<!-- ## TEKSTBLOK: T-test2 -->
* *t* ~`r py$df`~ = `r py$stat`, *p* = `r py$pval`
* Vrijheidsgraden, *df* = *n* -1 = `r py$n`-1 = `r py$df`  
* p-waarde > 0,05, dus de H~0~ wordt niet verworpen [^11]
* Het gemiddelde van de steekproef in 2010: `r Round_and_format(py$mean1)`
* Het gemiddelde van de steekproef in 2011: `r Round_and_format(py$mean2)`
<!-- ## /TEKSTBLOK: T-test2 -->

<!-- ## OPENBLOK: Cohens-d-test.py -->
```{python}
def cohen.d(x, y):
  # import numpy
  import numpy as np
	
	# calculate the size of samples
  n1, n2 = len(x), len(y)
	
	# calculate the variance of the samples
  v1, v2 = np.var(x, ddof=1), np.var(y, ddof=1)
	
	# calculate the pooled standard deviation
  s = np.sqrt(((n1 - 1) * v1 + (n2 - 1) * v2) / (n1 + n2 - 2))
	
	# calculate the means of the samples
  m1, m2 = np.mean(x), np.mean(y)
	
	# calculate the effect size
  return (m1 - m2) / s
```

```{python}
print(cohen.d(Cijfers_2010, Cijfers_2011))
```
<!-- ## /OPENBLOK: Cohens-d-test.py -->

<!-- ## CLOSEDBLOK: Cohens-d-test.py -->
```{python var Cohens d, echo = FALSE}
d = cohen.d(Cijfers_2010, Cijfers_2011)
```
<!-- ## /CLOSEDBLOK: Cohens-d-test.py -->

<!-- ## TEKSTBLOK: Cohens-d-test.py -->
*d* = `r Round_and_format(py$d)`. De sterkte van het effect van de tutor op het cijfer is verwaarloosbaar. 
<!-- ## /TEKSTBLOK: Cohens-d-test.py -->

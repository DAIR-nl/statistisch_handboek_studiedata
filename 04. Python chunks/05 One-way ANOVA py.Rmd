---
title: "One-way ANOVA"
output:
  html_document:
    theme: lumen
    toc: yes
    toc_float: 
      collapsed: FALSE 
    number_sections: true
  keywords: [statistisch handboek, studiedata]
---

<!-- ## CLOSEDBLOK: Functies.R -->
```{r functies, include = TRUE, echo = FALSE, results='asis', warning=FALSE, message=FALSE}
library(here)
if (!exists("Substitute_var")) {
  ## Installeer packages en functies
  source(paste0(here::here(), "/99. Functies en Libraries/00. Voorbereidingen.R"), echo = FALSE)
}
```
<!-- ## /CLOSEDBLOK: Functies.R -->

<style>
`r htmltools::includeHTML(paste0(here::here(),"/01. Includes/css/Stylesheet_SHHO.css"))`
</style>

<!-- ## CLOSEDBLOK: Header.R -->
```{r header, include = TRUE, echo = FALSE, results='asis', code =  readLines(paste0(here::here(),"/01. Includes/code/Header.R"))} 
```
<!-- ## /CLOSEDBLOK: Header.R -->

<!-- ## CLOSEDBLOK: Reticulate.R -->
```{r reticulate, include = TRUE, echo = FALSE, warning=FALSE, message=FALSE}
library(reticulate)
knitr::knit_engines$set(python = reticulate::eng_python)
```
<!-- ## /CLOSEDBLOK: Reticulate.R -->

```{r set-options, echo=FALSE, cache=FALSE}
options(width = 80)
## Zodat de TukeyHSD naast elkaar geprint wordt
```

<!-- ## OPENBLOK: Data-aanmaken.py -->
```{r aanmaken data, include=FALSE, echo=TRUE}
source(paste0(here::here(),"/01. Includes/data/05.R"))
```
<!-- ## /OPENBLOK: Data-aanmaken.py -->

<!-- ## TEKSTBLOK: Dataset-inladen.py -->
Er is een dataframe ingeladen met de reistijden van uitwonende studenten per opleiding ingeladen genaamd `dfReistijd_per_opleiding`. 
<!-- ## /TEKSTBLOK: Dataset-inladen.py -->

<!-- ## TEKSTBLOK: Data-bekijken.py -->
Gebruik `<dataframe>.head()` en `<dataframe>.tail()` om de structuur van de data te bekijken.
<!-- ## /TEKSTBLOK: Data-bekijken.py -->

<!-- ## OPENBLOK: Data-bekijken.py -->
```{python, include=FALSE}
import pandas as pd
dfReistijd_per_opleiding = pd.DataFrame(r.Reistijd_per_opleiding)
```

```{python data bekijken-1, collapse = TRUE}
## Eerste 5 observaties
print(dfReistijd_per_opleiding.head(5))
```

```{python data bekijken-2, collapse = TRUE}
## Laatste 5 observaties
print(dfReistijd_per_opleiding.tail(5))
```
<!-- ## /OPENBLOK: Data-bekijken.py -->

<!-- ## TEKSTBLOK: Data-bekijken2.py -->
De dataset bevat gegevens van studenten van verschillende opleidingen. Gebruik `<data.frame>.<kolomnaam>.unique()` om te onderzoeken welke opleidingen er in de data aanwezig zijn. 
<!-- ## /TEKSTBLOK: Data-bekijken2.py -->

<!-- ## OPENBLOK: Data-bekijken2.py -->
```{python data bekijken 2}
## Opleidingen in de data aanwezig
print(dfReistijd_per_opleiding.Opleiding.unique())
```
<!-- ## /OPENBLOK: Data-bekijken2.py -->

<!-- ## OPENBLOK: Data-selecteren.py -->
```{python data selecteren}
Reistijd_ATC = dfReistijd_per_opleiding[dfReistijd_per_opleiding['Opleiding'] == "Arabische Taal en Cultuur"]['Reistijd']
Reistijd_FIL = dfReistijd_per_opleiding[dfReistijd_per_opleiding['Opleiding'] == "Filosofie"]['Reistijd']
Reistijd_GSC = dfReistijd_per_opleiding[dfReistijd_per_opleiding['Opleiding'] == "Geschiedenis"]['Reistijd']
```
<!-- ## /OPENBLOK: Data-selecteren.py -->

<!-- ## TEKSTBLOK: Data-beschrijven.py -->
Om meer inzicht te krijgen in de data, inspecteer de data met `len()`, `np.mean()` en `np.sqrt(np.var())`, door deze aan te roepen uit de library `numpy`.
<!-- ## /TEKSTBLOK: Data-beschrijven.py -->

<!-- ## OPENBLOK: Data-beschrijven-inladen.py -->
```{python}
# Om het gemiddelde en de standaard deviatie te berekenen, hebben we de library 'numpy' nodig
import numpy as np
```
<!-- ## /OPENBLOK: Data-beschrijven-inladen.py -->

<!-- ## OPENBLOK: Data-beschrijven-1.py -->
```{python Data beschrijven 1, collapse=TRUE}
## Aantallen, gemiddelde en standaarddeviatie voor Arabische Taal en Cultuur
print(len(Reistijd_ATC))
print(np.mean(Reistijd_ATC))
print(np.sqrt(np.var(Reistijd_ATC)))
```

```{python Data beschrijven 2, collapse=TRUE}
## Aantallen, gemiddelde en standaarddeviatie voor Filosofie
print(len(Reistijd_FIL))
print(np.mean(Reistijd_FIL))
print(np.sqrt(np.var(Reistijd_FIL)))
```

```{python Data beschrijven 3, collapse=TRUE}
## Aantallen, gemiddelde en standaarddeviatie voor Geschiedenis
print(len(Reistijd_GSC))
print(np.mean(Reistijd_GSC))
print(np.sqrt(np.var(Reistijd_GSC)))
```
<!-- ## /OPENBLOK: Data-beschrijven-1.py -->

<!-- ## CLOSEDBLOK: Data-beschrijven.R -->
```{r data beschrijven als object, include=FALSE, echo=TRUE}
vM_ATC <- Round_and_format(mean(Reistijd_ATC))
vSD_ATC <- Round_and_format(sd(Reistijd_ATC))
vN_ATC <- Round_and_format(length(Reistijd_ATC))

vM_FIL <- Round_and_format(mean(Reistijd_FIL))
vSD_FIL <-Round_and_format(sd(Reistijd_FIL))
vN_FIL <- Round_and_format(length(Reistijd_FIL))

vM_GSC <- Round_and_format(mean(Reistijd_GSC))
vSD_GSC <-Round_and_format(sd(Reistijd_GSC))
vN_GSC <- Round_and_format(length(Reistijd_GSC))
```
<!-- ## /CLOSEDBLOK: Data-beschrijven.R -->

<!-- ## TEKSTBLOK: Data-beschrijven.R-->
* Gemiddelde reistijd Arabische Taal en Cultuur (standaarddeviatie): `r vM_ATC` (`r vSD_ATC`). *n* = `r vN_ATC`  
* Gemiddelde reistijd Filosofie (standaarddeviatie): `r vM_FIL` (`r vSD_FIL`). *n* = `r vN_FIL`.
* Gemiddelde reistijd Geschiedenis (standaarddeviatie): `r vM_GSC` (`r vSD_GSC`). *n* = `r vN_GSC`.
<!-- ## /TEKSTBLOK: Data-beschrijven.R-->

<!-- ## OPENBLOK: Histogram.py -->
```{python histogram}
## Histogram met matplotlib
import matplotlib.pyplot as plt
fig = plt.figure(figsize = (15, 10))
sub1 = fig.add_subplot(1, 3, 1)
title1 = plt.title("Arabische Taal en Cultuur")
hist1 = plt.hist(Reistijd_ATC, density = True, edgecolor = "black", bins = 10)

sub2 = fig.add_subplot(1, 3, 2)
title2 = plt.title("Filosofie")
hist2 = plt.hist(Reistijd_FIL, density = True, edgecolor = "black", bins = 10)

sub3 = fig.add_subplot(1, 3, 3)
title3 = plt.title("Geschiedenis")
hist3 = plt.hist(Reistijd_GSC, density = True, edgecolor = "black", bins = 12)

main = fig.suptitle('Reistijd')
plt.show()
```
<!-- ## /OPENBLOK: Histogram.py -->

<!-- ## TEKSTBLOK: QQplot.py -->
Importeer `scipy.stats` om een Q-Q plot te maken en statistische testen uit te voeren. Voor een Q-Q plot kan de functie `scipy.stats.probplot()` worden gebruikt.
<!-- ## TEKSTBLOK: QQplot.py -->

<!-- ## OPENBLOK: QQplot1.py -->
```{python QQplot-t1}
import scipy.stats as stats
qq = stats.probplot(Reistijd_ATC, dist="norm", plot=plt)
title = plt.title("Arabische Taal en Cultuur")
xlab = plt.xlabel("Theoretische kwantielen")
ylab = plt.ylabel("Kwantielen in data")
plt.show()
```
<!-- ## /OPENBLOK: QQplot1.py -->

<!-- ## OPENBLOK: QQplot2.py -->
```{python QQplot-t1}
import scipy.stats as stats
qq = stats.probplot(Reistijd_FIL, dist="norm", plot=plt)
title = plt.title("Filosofie")
xlab = plt.xlabel("Theoretische kwantielen")
ylab = plt.ylabel("Kwantielen in data")
plt.show()
```
<!-- ## /OPENBLOK: QQplot2.py -->

<!-- ## OPENBLOK: QQplot3.py -->
```{python QQplot-t1}
import scipy.stats as stats
qq = stats.probplot(Reistijd_GSC, dist="norm", plot=plt)
title = plt.title("Geschiedenis")
xlab = plt.xlabel("Theoretische kwantielen")
ylab = plt.ylabel("Kwantielen in data")
plt.show()
```
<!-- ## OPENBLOK: QQplot3.py -->

<!-- ## OPENBLOK: Boxplot.py -->
```{python boxplot}
fig, ax = plt.subplots()
box = ax.boxplot([Reistijd_ATC, Reistijd_FIL, Reistijd_GSC], labels = ["Arabische Taal en Cultuur", "Filosofie", "Geschiedenis"])
title = plt.title("Reistijd")
plt.show()
```
<!-- ## /OPENBLOK: Boxplot.py -->

<!-- ## TEKSTBLOK: Lilliefors-test1.py -->
De standaard interpretatie van een statitische toets in Python is als volgt: `(<teststatistiek>, <p-waarde>)`.
<!-- ## /TEKSTBLOK: Lilliefors-test1.py -->

<!-- ## /OPENBLOK: Library-nortest inladen.py -->
```{python}
import statsmodels.stats.api
```
<!-- ## /OPENBLOK: Library-nortest inladen.py -->

<!-- ## OPENBLOK: Lilliefors-test-1.py -->
``` {python Lilliefors Test-1, warning=FALSE}
print(statsmodels.stats.api.lilliefors(Reistijd_ATC))
```
<!-- ## OPENBLOK: Lilliefors-test-1.py -->

<!-- ## OPENBLOK: Lilliefors-test-2.py -->
``` {python Lilliefors Test-2, warning=FALSE}
print(statsmodels.stats.api.lilliefors(Reistijd_FIL))
```
<!-- ## OPENBLOK: Lilliefors-test-2.py -->

<!-- ## OPENBLOK: Lilliefors-test-3.py -->
``` {python Lilliefors Test-3, warning=FALSE}
print(statsmodels.stats.api.lilliefors(Reistijd_GSC))
```
<!-- ## /OPENBLOK: Lilliefors-test-3.py -->

<!-- ## OPENBLOK: Shapiro-Wilk-test-3.py -->
``` {python Shapiro-Wilk Test-1, warning=FALSE}
import scipy.stats as stats
print(stats.shapiro(Reistijd_GSC))
```
<!-- ## /OPENBLOK: Shapiro-Wilk-test-3.py -->

<!-- ## OPENBLOK: Shapiro-Wilk-test-2.py -->
``` {python Shapiro-Wilk Test-1, warning=FALSE}
import scipy.stats as stats
print(stats.shapiro(Reistijd_FIL))
```
<!-- ## OPENBLOK: Shapiro-Wilk-test-2.py -->

<!-- ## OPENBLOK: Shapiro-Wilk-test-1.py -->
``` {python Shapiro-Wilk Test-1, warning=FALSE}
import scipy.stats as stats
print(stats.shapiro(Reistijd_ATC))
```
<!-- ## OPENBLOK: Shapiro-Wilk-test-1.py -->

<!-- ## OPENBLOK: Levenes-test.py -->
```{python Levenes test}
import scipy.stats as stats
print(stats.levene(Reistijd_ATC, Reistijd_FIL, Reistijd_GSC))
```
<!-- ## /OPENBLOK: Levenes-test.py -->

<!-- ## TEKSTBLOK: ANOVA-toets.R -->
Gebruik `pingouin.anova` om een ANOVA-test uit te voeren.
<!-- ## /TEKSTBLOK: ANOVA-toets.R -->  

<!-- ## OPENBLOK: ANOVA-toets.py -->
```{python}
# We importeren een library om de ANOVA toets te kunnen berekenen
import pingouin as pg
```

```{python ANOVA}
aov = pg.anova(data=dfReistijd_per_opleiding, dv='Reistijd', between='Opleiding', detailed=True)
print(aov)
```
<!-- ## /OPENBLOK: ANOVA-toets.py -->

### Effectmaat: Eta squared
De Eta Squared is al berekend in de ANOVA tabel.
<!-- ## OPENBLOK: Eta-squared.py --> 
```{python}
print("Eta Squared:", aov["np2"])
```
<!-- ## /OPENBLOK: Eta-squared.py -->

<!-- ## TEKSTBLOK: Tukey-HSD.R -->
Gebruik `pingouin.pairwise_tukey` op het ANOVA-object.
<!-- ## /TEKSTBLOK: Tukey-HSD.R -->

<!-- ## OPENBLOK: Tukey-HSD.py -->
```{python}
print(pg.pairwise_tukey(data = dfReistijd_per_opleiding, dv = "Reistijd", between = "Opleiding", effsize = "cohen"))
```
<!-- ## /OPENBLOK: Tukey-HSD.py -->

---
title: "Chi-kwadraat toets en Fisher's exact toets"
output:
  html_document:
    theme: lumen
    toc: yes
    toc_float: 
      collapsed: FALSE 
    number_sections: true
  keywords: [statistisch handboek, studiedata]
---

<!-- ## CLOSEDBLOK: Functies.R -->
```{r functies, include = TRUE, echo = FALSE, results='asis', warning=FALSE, message=FALSE}
library(here)
if (!exists("Substitute_var")) {
  ## Installeer packages en functies
  source(paste0(here::here(), "/99. Functies en Libraries/00. Voorbereidingen.R"), echo = FALSE)
}
```
<!-- ## /CLOSEDBLOK: Functies.R -->

<style>
`r htmltools::includeHTML(paste0(here::here(),"/01. Includes/css/Stylesheet_SHHO.css"))`
</style>

<!-- ## CLOSEDBLOK: Header.R -->
```{r header, include = TRUE, echo = FALSE, results='asis', code =  readLines(paste0(here::here(),"/01. Includes/code/Header.R"))} 
```
<!-- ## /CLOSEDBLOK: Header.R -->

<!-- ## CLOSEDBLOK: Reticulate.py -->
```{r reticulate, include = TRUE, echo = FALSE, warning=FALSE, message=FALSE}
library(reticulate)
knitr::knit_engines$set(python = reticulate::eng_python)
```
<!-- ## /CLOSEDBLOK: Reticulate.py -->

<!-- ## OPENBLOK: Data-aanmaken.py -->
```{r opmerking TODO, include=FALSE, eval=FALSE}
# TODO: Uitleg extra pagina: nominaal, ordinaal etc., afhanjeklijk en onafhankelijk  
# TODO: Uitleg transformeren data 
```
```{r aanmaken data, include=FALSE, echo=TRUE}
source(paste0(here::here(),"/01. Includes/data/13.R"))
```
<!-- ## /OPENBLOK: Data-aanmaken.py -->

<!-- ## TEKSTBLOK: Dataset-inladen.py -->
Er is een kruistabel `dfUitval_functiebeperking` ingeladen over de uitval van studenten met een functiebeperking voor en na de invoering van het leenstelsel. Zowel de variabele voor uitval (wel of geen uitval) als voor functiebeperking (wel of geen functiebeperking) zijn binair. Deze tabel is gebaseerd op een dataset waarin uitval en functiebeperking voor studenten wordt bijgehouden.
<!-- ## /TEKSTBLOK: Dataset-inladen.py -->

<!-- ## OPENBLOK: Data-bekijken.py -->
```{python, include=FALSE}
import pandas as pd
dfUitval_functiebeperking = pd.DataFrame(r.Uitval_functiebeperking)
Uitval_functiebeperking_n43 = r.Uitval_functiebeperking_n43
```

```{python data bekijken-1, collapse = TRUE}
## Eerste 6 observaties
print(dfUitval_functiebeperking.head(6))
```
<!-- ## /BLOK: Data-bekijken.py -->

<!-- ## TEKSTBLOK: Chi2-toets.py -->
De *chi-kwadraat toets* wordt uitgevoerd om de vraag te beantwoorden of het percentage studenten met een functiebeperking dat is uitgevallen voor en na de invoering van het leenstelsel gelijk is gebleven. Gebruik `stats.chi2_contingency()` op een kruistabel. Er wordt vervolgens het volgende weergegeven: `<teststatistiek>, <vrijheidsgraad>, <p-waarde>`.
<!-- ## /TEKSTBLOK: Chi2-toets.py -->

<!-- ## OPENBLOK: Chi2-toets.py -->
```{python}
import scipy.stats as stats
tstat, df, pval, tab = stats.chi2_contingency(dfUitval_functiebeperking, correction=True)
print(tstat, df, pval)
```
<!-- ## /BLOK: Chi2-toets.py -->

<!-- ## CLOSEDBLOK: Chi2-toets.py -->

<!-- ## /CLOSEDBLOK: Chi2-toets.py -->

<!-- ## TEKSTBLOK: Chi2-toets.py -->
* *χ^2^* ~1~ ≈ `r Round_and_format(py$tstat)`, *p* ≈ `r Round_and_format(py$pval)`  
* Vrijheidsgraden: *df* = (*k*-1)(*r*-1), waar k staat voor kolom en r voor rij. In dit geval geldt *df* = `r py$df`. De continuïteitscorrectie van Yates wordt automatisch toegepast wanneer het aantal vrijheidsgraden 1 is.[^6]   
* p-waarde < 0,05, dus de H~0~ wordt verworpen.[^8]  

<!-- ## /TEKSTBLOK: Chi2-toets.py -->

<!-- ## TEKSTBLOK: Rapportage.py -->
De *Chi-kwadraat toets* is uitgevoerd om te toetsen of studenten met een functiebeperking meer of minder uitvallen sinds de invoering van het leenstelsel. De resultaten ondersteunen de alternatieve hypothese: het percentage uitval van het aantal studenten met een functiebeperking is na de invoering van het leenstelsel veranderd, *χ^2^* ~`r py$df`~ ≈ `r py$`, *p* < 0,05.

<!-- ## /TEKSTBLOK: Rapportage.py -->

<!-- ## OPENBLOK: data-bekijken-n43.py -->
```{python data bekijken n43}
print(Uitval_functiebeperking_n43)
```
<!-- ## /BLOK: data-bekijken-n43.py -->

<!-- ## OPENBLOK: Fishers-Exact-toets.py -->
```{python}
print(stats.fisher_exact(Uitval_functiebeperking_n43))
```
<!-- ## /BLOK: Fishers-Exact-toets.py -->

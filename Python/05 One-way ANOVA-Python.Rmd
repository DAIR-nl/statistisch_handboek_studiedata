---
title: "One-way ANOVA"
output:
  html_document:
    theme: lumen
    toc: yes
    toc_float: 
      collapsed: FALSE 
    number_sections: true
    includes:
      in_header: ["../01. Includes/html/nocache.html", "../01. Includes/html/favicon.html", "../01. Includes/html/analytics.html"]
  keywords: [statistisch handboek, studiedata]
---

<!-- ## CLOSEDBLOK: Functies.R -->
```{r functies, include = TRUE, echo = FALSE, results='asis', warning=FALSE, message=FALSE}
library(here)
if (!exists("Substitute_var")) {
  ## Installeer packages en functies
  source(paste0(here::here(), "/99. Functies en Libraries/00. Voorbereidingen.R"), echo = FALSE)
}
```
<!-- ## /CLOSEDBLOK: Functies.R -->

<!-- ## CLOSEDBLOK: CSS -->
<style>
`r htmltools::includeHTML(paste0(here::here(),"/01. Includes/css/Stylesheet_SHHO.css"))`
</style>
<!-- ## /CLOSEDBLOK: CSS -->

<!-- ## CLOSEDBLOK: Header.R -->
```{r header, include = TRUE, echo = FALSE, results='asis', code =  readLines(paste0(here::here(),"/01. Includes/code/Header.R"))} 
```
<!-- ## /CLOSEDBLOK: Header.R -->

<!-- ## CLOSEDBLOK: Reticulate.py -->
```{r reticulate, include = TRUE, echo = FALSE, warning=FALSE, message=FALSE}
library(reticulate)
knitr::knit_engines$set(python = reticulate::eng_python)
```
<!-- ## /CLOSEDBLOK: Reticulate.py -->

<!-- ## CLOSEDBLOK: Status.R -->
```{r status, include = TRUE, echo = FALSE, results='asis', code =  readLines(paste0(here::here(),"/01. Includes/code/Status.R"))} 
```
<!-- ## /CLOSEDBLOK: Status.R -->

```{r set-options, echo=FALSE, cache=FALSE}
options(width = 80)
## Zodat de TukeyHSD naast elkaar geprint wordt
```

<!-- ## OPENBLOK: Data-aanmaken.py -->
```{r aanmaken data, include=FALSE, echo=TRUE}
source(paste0(here::here(),"/01. Includes/data/05.R"))
```
<!-- ## /OPENBLOK: Data-aanmaken.py -->

# Toepassing
Gebruik de *one-way ANOVA* bij het toetsen of de gemiddelden van drie of meer onafhankelijke groepen verschillen.[^1] 

# Onderwijscasus
<div id = "casus">
Om wervingsactiviteiten beter af te stemmen op de aankomende studenten, wil het hoofd van de afdeling Communicatie weten wat de reistijd is van studenten van verschillende opleidingen. Hij heeft daarom data verzameld over de reistijd van uitwonende studenten voor de opleidingen: Arabische Taal en Cultuur, Filosofie en Geschiedenis. 

Dit onderzoek vertaalt zich in de volgende combinatie van hypothesen, waarbij de nulhypothese zo geformuleerd is dat er geen effect is en de alternatieve hypothese zo geformuleerd is dat er een effect is wat overeenkomt met de verwachting van de onderzoeker.

*H~0~*: De gemiddelde reistijd van de studenten is per opleiding gelijk aan elkaar: µ~1~ = µ~2~ = µ~3~   

*H~A~*: Voor tenminste één opleiding is de gemiddelde reistijd niet gelijk aan de gemiddelde reistijd van studenten voor andere opleidingen, bijvoorbeeld: µ~1~ ≠ µ~2~ = µ~3~ 
</div>

# Assumpties
Om een valide toetsresultaat te bereiken moeten de data aan een aantal voorwaarden voldoen. Controleer of de steekproef aan de volgende assumpties voldoet: normaliteit, homogeniteit van varianties en onafhankelijkheid.  
De *one-way ANOVA* is een robuuste toets: als één groep uit de steekproef niet voldoet aan de assumptie van normaliteit of homogeniteit van varianties, dan kan de *one-way ANOVA* nog steeds uitgevoerd en geïnterpreteerd worden.[^2] Hierdoor kan het wel zijn dat de toets minder onderscheidend vermogen heeft, dan wanneer de assumpties niet geschonden worden.[^3]<sup>, </sup>[^4] Als er geen sprake is van normaliteit of homogeniteit van varianties, is de [Kruskal-Wallis toets](10-Kruskal-Wallis-toets-R.html) een alternatief voor de *one-way ANOVA*.[^5]<sup>, </sup>[^6]

## Normaliteit
Controleer de assumptie van normaliteit voor elke groep met de volgende stappen:  
1. Controleer de data visueel met een histogram, een boxplot of een Q-Q plot.   
2. Toets of de data normaal verdeeld zijn met de *Kolmogorov-Smirnov test* of bij een kleinere steekproef (n < 50) met de *Shapiro-Wilk test*.[^7]<sup>, </sup>[^8]  

Als blijkt dat de data niet normaal verdeeld zijn, is het transformeren van de data ook een optie [^9]. Bepaal of de data daarna wel normaal verdeeld zijn.

## Homogeniteit van Varianties
Toets met de *Levene's Test (for equality of variance)* of de variantie van iedere groep ongeveer hetzelfde is. Bij een *p* < 0,05 is de variantie van de groepen significant verschillend.[^10]

# Effectmaat
De p-waarde geeft aan of het verschil tussen groepen statistisch significant is. De grootte van het verschil of effect is echter ook relevant. Een effectmaat is een gestandaardiseerde maat die de grootte van een effect weergeeft, zodat effecten van verschillende onderzoeken met elkaar vergeleken kunnen worden.[^11] Voor de *one-way ANOVA* wordt de effectmaat eta squared vaak gebruikt.

## Eta squared
De effectmaat eta squared (*η^2^*) berekent de proportie van de variantie in de afhankelijke variabele die verklaard wordt door de onafhankelijke variabele. In deze casus berekent het de proportie van de variantie in de lengte van de reistijd die verklaard kan worden door de opleiding. Een indicatie om *η^2^* te interpreteren is: rond 0,01 is een klein effect, rond 0,06 is een gemiddeld effect en rond 0,14 is een groot effect.[^12]<sup>,</sup>[^13]

# Post-hoc toetsen
De *one-way ANOVA* toetst of één of meerdere van de gemiddelden anders is dan de andere gemiddelden. Voer een post-hoc toets uit om te bepalen welke groepen significant verschillen.

Er zijn meerdere post-hoc toetsen. De keuze voor een toets hangt onder andere af van het wel of niet schenden van de assumptie van homogeniteit van varianties:   
* Gebruik Tukey bij gelijke variantie.[^14]  
* Gebruik Games-Howell bij ongelijke variantie.[^15]  

# Uitvoering
<!-- ## TEKSTBLOK: Dataset-inladen.py -->
Er is een dataset ingeladen met de reistijden van uitwonende studenten per opleiding genaamd `dfReistijd_per_opleiding`. 
<!-- ## /TEKSTBLOK: Dataset-inladen.py -->

## De data bekijken
<!-- ## TEKSTBLOK: Data-bekijken.py -->
Gebruik `<dataframe>.head()` en `<dataframe>.tail()` om de structuur van de data te bekijken.
<!-- ## /TEKSTBLOK: Data-bekijken.py -->

<!-- ## OPENBLOK: Data-bekijken.py -->
```{python, include=FALSE}
import pandas as pd
dfReistijd_per_opleiding = pd.DataFrame(r.Reistijd_per_opleiding)
```

```{python data bekijken-1, collapse = TRUE}
## Eerste 5 observaties
print(dfReistijd_per_opleiding.head(5))
```

```{python data bekijken-2, collapse = TRUE}
## Laatste 5 observaties
print(dfReistijd_per_opleiding.tail(5))
```
<!-- ## /OPENBLOK: Data-bekijken.py -->
<!-- ## TEKSTBLOK: Data-bekijken2.py -->
De dataset bevat gegevens van studenten van verschillende opleidingen. Gebruik `.unique()` om te onderzoeken welke opleidingen er in de data aanwezig zijn. 
<!-- ## /TEKSTBLOK: Data-bekijken2.py -->
<!-- ## OPENBLOK: Data-bekijken2.py -->
```{python data bekijken 2}
## Opleidingen in de data aanwezig
print(dfReistijd_per_opleiding['Opleiding'].unique())
```
<!-- ## /OPENBLOK: Data-bekijken2.py -->

Selecteer de drie groepen en sla deze op in een vector om deze makkelijker aan te kunnen roepen. 
<!-- ## OPENBLOK: Data-selecteren.py -->
```{python data selecteren}
Reistijd_ATC = dfReistijd_per_opleiding[dfReistijd_per_opleiding['Opleiding'] == "Arabische Taal en Cultuur"]['Reistijd']
Reistijd_FIL = dfReistijd_per_opleiding[dfReistijd_per_opleiding['Opleiding'] == "Filosofie"]['Reistijd']
Reistijd_GSC = dfReistijd_per_opleiding[dfReistijd_per_opleiding['Opleiding'] == "Geschiedenis"]['Reistijd']
```
<!-- ## /OPENBLOK: Data-selecteren.py -->

<!-- ## TEKSTBLOK: Data-beschrijven.py -->
Om meer inzicht te krijgen in de data, inspecteer de data met `len()`, `np.mean()` en `np.sqrt(np.var())`, door deze aan te roepen uit de library `numpy`.
<!-- ## /TEKSTBLOK: Data-beschrijven.py -->

<!-- ## OPENBLOK: Data-beschrijven-inladen.py -->
```{python}
# Om het gemiddelde en de standaard deviatie te berekenen, hebben we de library 'numpy' nodig
import numpy as np
```
<!-- ## /OPENBLOK: Data-beschrijven-inladen.py -->

<!-- ## OPENBLOK: Data-beschrijven-1.py -->
```{python Data beschrijven 1, collapse=TRUE}
## Aantallen, gemiddelde en standaarddeviatie voor Arabische Taal en Cultuur
print(len(Reistijd_ATC))
print(np.mean(Reistijd_ATC))
print(np.std(Reistijd_ATC))
```

```{python Data beschrijven 2, collapse=TRUE}
## Aantallen, gemiddelde en standaarddeviatie voor Filosofie
print(len(Reistijd_FIL))
print(np.mean(Reistijd_FIL))
print(np.std(Reistijd_FIL))
```

```{python Data beschrijven 3, collapse=TRUE}
## Aantallen, gemiddelde en standaarddeviatie voor Geschiedenis
print(len(Reistijd_GSC))
print(np.mean(Reistijd_GSC))
print(np.std(Reistijd_GSC))
```
<!-- ## /OPENBLOK: Data-beschrijven-1.py -->

<!-- ## CLOSEDBLOK: Data-beschrijven-11.R -->
```{r Data beschrijven 11, echo = FALSE}
## Aantallen, gemiddelde en standaarddeviatie
library(dplyr)
Reistijd_per_opleiding %>% group_by(Opleiding) %>%
  summarise(
    N = length(Reistijd),
    Gemiddelde = mean(Reistijd),
    Standaardafwijking = sd(Reistijd) # Optioneel hieronder
  ) %>% mutate(Gemiddelde = Round_and_format(Gemiddelde),
               Standaardafwijking = Round_and_format(Standaardafwijking))
```
<!-- ## /CLOSEDBLOK: Data-beschrijven-11.R -->

<!-- ## CLOSEDBLOK: Data-beschrijven.py -->
```{python data beschrijven als object, include=FALSE, echo=TRUE}
vM_ATC = np.mean(Reistijd_ATC)
vSD_ATC = np.std(Reistijd_ATC)
vN_ATC = np.size(Reistijd_ATC)

vM_FIL = np.mean(Reistijd_FIL)
vSD_FIL = np.std(Reistijd_FIL)
vN_FIL = np.size(Reistijd_FIL)

vM_GSC = np.mean(Reistijd_GSC)
vSD_GSC = np.std(Reistijd_GSC)
vN_GSC = np.size(Reistijd_GSC)
```
<!-- ## /CLOSEDBLOK: Data-beschrijven.py -->

<!-- ## TEKSTBLOK: Datatekst-beschrijven.py -->
* Gemiddelde reistijd Arabische Taal en Cultuur (standaarddeviatie): `r Round_and_format(py$vM_ATC)` (`r Round_and_format(py$vSD_ATC)`). *n* = `r py$vN_ATC`  
* Gemiddelde reistijd Filosofie (standaarddeviatie): `r Round_and_format(py$vM_FIL)` (`r Round_and_format(py$vSD_FIL)`). *n* = `r py$vN_FIL`.
* Gemiddelde reistijd Geschiedenis (standaarddeviatie): `r Round_and_format(py$vM_GSC)` (`r Round_and_format(py$vSD_GSC)`). *n* = `r py$vN_GSC`.

<!-- ## /TEKSTBLOK: Datatekst-beschrijven.py -->

## Visuele inspectie van normaliteit
Geef de verdeling van de data visueel weer met een histogram, Q-Q plot en boxplot.

### Histogram

Focus bij het analyseren van een histogram op de symmetrie van de verdeling, de hoeveelheid toppen (modaliteit) en mogelijke uitbijters. Een normale verdeling is symmetrisch, heeft één top en geen uitbijters.[^16]<sup>, </sup>[^17]

<!-- ## OPENBLOK: Histogram.py -->
```{python histogram}
## Histogram met matplotlib
import matplotlib.pyplot as plt
fig = plt.figure(figsize = (15, 10))
sub1 = fig.add_subplot(1, 3, 1)
title1 = plt.title("Arabische Taal en Cultuur")
ylab = plt.ylabel("Frequentiedichtheid")
hist1 = plt.hist(Reistijd_ATC, density = True, edgecolor = "black", bins = 10)

sub2 = fig.add_subplot(1, 3, 2)
title2 = plt.title("Filosofie")
xlab = plt.xlabel("Reistijd")
hist2 = plt.hist(Reistijd_FIL, density = True, edgecolor = "black", bins = 10)

sub3 = fig.add_subplot(1, 3, 3)
title3 = plt.title("Geschiedenis")
hist3 = plt.hist(Reistijd_GSC, density = True, edgecolor = "black", bins = 12)

main = fig.suptitle('Reistijd per opleiding')
plt.show()
```
<!-- ## /OPENBLOK: Histogram.py -->

De verdelingen van de opleidingen Filosofie en Geschiedenis lijken twee toppen te hebben. Alle drie de opleidingen hebben een niet geheel symmetrische verdeling, maar vertonen ook geen uitbijters. De verdeling van de opleiding Arabische taal en Cultuur is bij benadering normaal; voor de opleidingen Filosofie en Geschiedenis zijn de histogrammen niet overtuigend genoeg om een bij benadering normale verdeling aan te nemen.

### Q-Q plot
<!-- ## TEKSTBLOK: QQplot.py -->
Importeer `scipy.stats` om een Q-Q plot te maken en statistische testen uit te voeren. Voor een Q-Q plot kan de functie `scipy.stats.probplot()` worden gebruikt.
<!-- ## TEKSTBLOK: QQplot.py -->

Als over het algemeen de meeste datapunten op de lijn liggen, neem dan aan dat de data normaal verdeeld zijn.
<div class = "col-container">
  <div class="col">
<!-- ## OPENBLOK: QQplot1.py -->
```{python QQplot-t1}
import scipy.stats as stats
qq = stats.probplot(Reistijd_ATC, dist="norm", plot=plt)
title = plt.title("Arabische Taal en Cultuur")
xlab = plt.xlabel("Theoretische kwantielen")
ylab = plt.ylabel("Kwantielen in data")
plt.show()
```
<!-- ## /OPENBLOK: QQplot1.py -->
  </div>
  <div class = "col">
<!-- ## OPENBLOK: QQplot2.py -->
```{python QQplot-t2}
import scipy.stats as stats
qq = stats.probplot(Reistijd_FIL, dist="norm", plot=plt)
title = plt.title("Filosofie")
xlab = plt.xlabel("Theoretische kwantielen")
ylab = plt.ylabel("Kwantielen in data")
plt.show()

```
<!-- ## /OPENBLOK: QQplot2.py -->
  </div>
  <div class = "col">
<!-- ## OPENBLOK: QQplot3.py -->
```{python QQplot-t3}
import scipy.stats as stats
qq = stats.probplot(Reistijd_GSC, dist="norm", plot=plt)
title = plt.title("Geschiedenis")
xlab = plt.xlabel("Theoretische kwantielen")
ylab = plt.ylabel("Kwantielen in data")
plt.show()

```
<!-- ## OPENBLOK: QQplot3.py -->
  </div>
</div>
Bij alle drie de verdelingen liggen de meeste datapunten op of vlakbij de lijn. Hoewel er bij de uiteinden van de verdeling wat afwijkingen zijn, duidt deze grafiek op een goede benadering van de normaalverdeling voor de drie verdelingen.


### Boxplot
De box geeft de middelste 50% van de reistijd weer. De zwarte lijn binnen de box is de mediaan. In de staarten of snorreharen zitten de eerste 25% en de laatste 25%. Cirkels visualiseren mogelijke uitbijters.[^16]<sup>, </sup>[^17] Hoe meer de boxen overlappen, hoe waarschijnlijker er geen significant verschil is tussen de groepen. 

<!-- ## OPENBLOK: Boxplot.py -->
```{python boxplot}
fig, ax = plt.subplots()
box = ax.boxplot([Reistijd_ATC, Reistijd_FIL, Reistijd_GSC], labels = ["Arabische Taal en Cultuur", "Filosofie", "Geschiedenis"])
title = plt.title("Reistijd per opleiding")
ylab = plt.ylabel("Reistijd in minuten")
plt.show()
```
<!-- ## /OPENBLOK: Boxplot.py -->

De boxplotten geven de spreiding weer van de gemiddelde reistijd van uitwonende studenten voor de opleidingen Arabische Taal en Cultuur, Filosofie en Geschiedenis. De boxplotten Arabische Taal en Cultuur en Geschiedenis zien er symmetrisch uit; de boxen zijn even hoog boven als onder de mediaan en de snorreharen zijn onder en boven even groot. De boxplot van Filosofie is boven de mediaan groter dan onder de mediaan, de data kan wat scheef verdeeld zijn. De mediaan Arabische Taal en Cultuur ligt hoger dan de twee andere opleidingen.

## Toetsen van normaliteit
Om te controleren of de data normaal verdeeld zijn, kan de normaliteit getoetst worden. Twee veelgebruikte toetsen zijn: de *Kolmogorov-Smirnov test* en de *Shapiro-Wilk test*.

### Kolmogorov-Smirnov
De *Kolmogorov-Smirnov test* toetst het verschil tussen twee verdelingen. Standaard toetst deze toets het verschil tussen een normale verdeling en de verdeling van de steekproef. De Lilliefors correctie is vereist als het gemiddelde en de standaardafwijking niet van tevoren bekend of bepaald zijn, wat meestal het geval is bij een steekproef. Als de p < 0,05 is, is de verdeling van de data significant verschillend van de normale verdeling.

<!-- ## TEKSTBLOK: Lilliefors-test1.py -->
De standaard interpretatie van een statitische toets in Python is: `(<teststatistiek>, <p-waarde>)`. Verder toetst Python standaard tweezijdig.
<!-- ## /TEKSTBLOK: Lilliefors-test1.py -->

<!-- ## OPENBLOK: Library-nortest.py -->
```{python}
import statsmodels.stats.api as smod
```
<!-- ## /OPENBLOK: Library-nortest.py -->

<div class="col-container"> 
  <div class="col">
<!-- ## OPENBLOK: Lilliefors-test-1.py -->
``` {python Lilliefors Test-1, warning=FALSE}
print(statsmodels.stats.api.lilliefors(Reistijd_ATC, pvalmethod="table"))
```
<!-- ## OPENBLOK: Lilliefors-test-1.py -->
  </div>
  <div class = "col">
<!-- ## OPENBLOK: Lilliefors-test-2.py -->
``` {python Lilliefors Test-2, warning=FALSE}
print(statsmodels.stats.api.lilliefors(Reistijd_FIL, pvalmethod="table"))
```
<!-- ## OPENBLOK: Lilliefors-test-2.py -->
  </div>
  <div class = "col">
<!-- ## OPENBLOK: Lilliefors-test-3.py -->
``` {python Lilliefors Test-3, warning=FALSE}
print(statsmodels.stats.api.lilliefors(Reistijd_GSC, pvalmethod="table"))
```
<!-- ## /OPENBLOK: Lilliefors-test-3.py -->
  </div>
</div>

De p-waarde is groter dan 0,05 voor elke groep; er is geen significant verschil gevonden tussen de verdeling van de steekproef en de normale verdeling. [^18] De *one-way ANOVA* kan uitgevoerd worden.

### Shapiro-Wilk Test
De *Shapiro-Wilk test* is een soortgelijke toets als de *Kolmogorov-Smirnov test* en vooral geschikt bij kleine steekproeven (*n* < 50). Als de p-waarde kleiner dan 0,05 is, is de verdeling van de data significant verschillend van de normale verdeling.

<div class="col-container"> 
  <div class="col">
<!-- ## OPENBLOK: Shapiro-Wilk-test-3.py -->
``` {python Shapiro-Wilk Test-1, warning=FALSE}
import scipy.stats as stats
print(stats.shapiro(Reistijd_GSC))

```
<!-- ## /OPENBLOK: Shapiro-Wilk-test-3.py -->
  </div>
  <div class= "col">
<!-- ## OPENBLOK: Shapiro-Wilk-test-2.py -->
``` {python Shapiro-Wilk Test-2, warning=FALSE}
import scipy.stats as stats
print(stats.shapiro(Reistijd_FIL))

```
<!-- ## OPENBLOK: Shapiro-Wilk-test-2.py -->
  </div>
  <div class= "col"> 
<!-- ## OPENBLOK: Shapiro-Wilk-test-1.py -->
``` {python Shapiro-Wilk Test-3, warning=FALSE}
import scipy.stats as stats
print(stats.shapiro(Reistijd_ATC))
```
<!-- ## OPENBLOK: Shapiro-Wilk-test-1.py -->
  </div>
</div>

De p-waarde is groter dan 0,05 voor elke groep, dus er is geen significant verschil gevonden tussen de verdeling van de steekproef en de normale verdeling. De *one-way ANOVA* kan uitgevoerd worden.

## Toetsen van Homogeniteit van varianties
Toets met de *Levene's test* de homogeniteit van varianties. Als uit de *Levene's test* blijkt dat de steekproeven verschillen in variantie, voer dan de [Kruskal-Wallis toets](10-Kruskal-Wallis-toets-R.html) uit. Omdat de ANOVA een robuuste toets is, kan deze ook gebruikt worden wanneer deze assumptie geschonden is, maar dan heeft de toets misschien minder onderscheidend vermogen.

<!-- ## OPENBLOK: Levenes-test.py -->
```{python Levenes test}
import scipy.stats as stats
# Geef de drie variabelen met de reistijden per opleiding als argumenten
print(stats.levene(Reistijd_ATC, Reistijd_FIL, Reistijd_GSC))
```
<!-- ## /OPENBLOK: Levenes-test.py -->
<!-- ## CLOSEDBLOK: Levenes-test.py -->
```{python Levenes test als object, echo = FALSE}
stat, pval = stats.levene(Reistijd_ATC, Reistijd_FIL, Reistijd_GSC)
vDF1 = 2
vDF2 = len(Reistijd_ATC) + len(Reistijd_FIL) + len(Reistijd_GSC) - 3
```
<!-- ## /CLOSEDBLOK: Levenes-test.py -->
<!-- ## TEKSTBLOK: Levenes-test.py -->
* *F*~`r py$vDF1`~~,~~`r py$vDF2`~ = `r Round_and_format(py$stat)`, p-waarde = `r Round_and_format(py$pval)`, 
* De p-waarde is groter dan 0,05, dus er is geen significant verschil gevonden tussen de groepen in spreiding.
*  Vrijheidsgraden bestaan uit twee cijfers, het eerste cijfer (het aantal groepen - 1 = `r py$vDF1`) en het tweede cijfer (*n~1~* + *n~2~*+*n~3~* - 3 = `r py$vDF2`).  
<!-- ## TEKSTBLOK: Levenes-test.py -->

## One-way ANOVA 
Voer de *one-way ANOVA* uit om de vraag te beantwoorden of de gemiddelde reistijd van de studenten per opleiding verschilt.  
<!-- ## TEKSTBLOK: ANOVA-toets.py -->
Gebruik `.anova()` uit de package `pingouin` om een ANOVA-test uit te voeren. De argumenten van de functie zijn de dataset `data = dfReistijd_per_opleiding`, de afhankelijke variabele `dv = "Reistijd"`, de groepsvariabele `between = "Opleiding"` en `detailed = True` om aan te geven dat de functie een uitgebreide versie van de resultaten geeft.
<!-- ## /TEKSTBLOK: ANOVA-toets.py -->  
<!-- ## OPENBLOK: ANOVA-toets.py -->
```{python}
# We importeren een library om de ANOVA toets te kunnen berekenen
import pingouin as pg
```

```{python ANOVA}
aov = pg.anova(data = dfReistijd_per_opleiding, dv = 'Reistijd', between = 'Opleiding', detailed = True)
print(aov)
```
<!-- ## /OPENBLOK: ANOVA-toets.py -->

<!-- ## CLOSEDBLOK: ANOVA-toets.py -->
```{python ANOVA als object, echo=FALSE}
vDF1 = aov['DF'][0]
vDF2 = aov['DF'][1]
vF_waarde = aov['F'][0]
```
<!-- ## /CLOSEDBLOK: ANOVA-toets.py -->

<!-- ## TEKSTBLOK: ANOVA-toets1.py -->
* *F* ~`r py$vDF1`~~,~~`r py$vDF2`~ = `r Round_and_format(py$stat)`, *p* < 0,0001.
* p-waarde is kleiner dan 0,05, dus de H~0~ wordt verworpen.[^16] 
* Vrijheidsgraden: het aantal groepen - 1 = `r py$vDF1`; *n~1~* + *n~2~* + *n~3~*- 3 = `r py$vDF2`.

<!-- ## /TEKSTBLOK: ANOVA-toets1.py -->


### Effectmaat: Eta squared

<!-- ## TEKSTBLOK: Eta-squared-tekst.py -->
De effectmaat *η^2^* is in de resultaten te vinden onder `np2`.
<!-- ## /TEKSTBLOK: Eta-squared-tekst.py -->

<!-- ## OPENBLOK: Eta-squared.py --> 
<!-- ## /OPENBLOK: Eta-squared.py -->
<!-- ## CLOSEDBLOK: Eta-squared.py -->
```{python, include=FALSE}
Esq = float(aov["np2"][0])
```
<!-- ## /CLOSEDBLOK: Eta-squared.py -->
<!-- ## TEKSTBLOK: Eta-squared.py -->
*η^2^* = `r Round_and_format(py$Esq)`, de sterkte van het effect van de type opleiding op de reistijd is groot. 
<!-- ## /TEKSTBLOK: Eta-squared.py -->

## Post-hoc toets: Tukey's toets
Voer een post-hoc toets uit om te bepalen welke van de type opleidingen in reistijd verschillen. Gebruik bij groepen met gelijke variantie de Tukey Honestly Significant Difference Test.
<!-- ## TEKSTBLOK: Tukey-HSD.py -->
Gebruik de functie `.pairwise_tukey()` met als argumenten de dataset `data = dfReistijd_per_opleiding`, de afhankelijke variabele `dv = "Reistijd"`, de groepsvariabele `between = "Opleiding"` en `effsize = "cohen"` om aan te geven dat Cohen's d als effectmaat voor de post-hoc toets wordt gebruikt.
<!-- ## /TEKSTBLOK: Tukey-HSD.py -->

<!-- ## OPENBLOK: Tukey-HSD.py -->
```{python}
print(pg.pairwise_tukey(data = dfReistijd_per_opleiding, dv = "Reistijd", between = "Opleiding", effsize = "cohen"))
```
<!-- ## /OPENBLOK: Tukey-HSD.py -->
<!-- ## CLOSEDBLOK: Tukey-HSD.py -->
```{python TukeyHSD als object}
THSD = pg.pairwise_tukey(data = dfReistijd_per_opleiding, dv = "Reistijd", between = "Opleiding", effsize = "cohen")
vATCvsFIL = THSD['diff'][0]
vATCvsGSC = THSD['diff'][1]
vFILvsGSC = THSD['diff'][2]
vpFILvsGSC = THSD['p-tukey'][2]
```
<!-- ## /CLOSEDBLOK: Tukey-HSD.py -->
<!-- ## TEKSTBLOK: Tukey-HSD1.py -->
Het verschil tussen Filosofie en Arabische Taal en Cultuur is *MD* = `r Round_and_format(py$vATCvsFIL)`, *p* = 0,001.  
Het verschil tussen Geschiedenis en Arabische Taal en Cultuur is *MD* = `r Round_and_format(py$vATCvsGSC)`, *p* = 0,001.  
Het verschil tussen Geschiedenis en Filosofie is *MD* = `r Round_and_format(py$vFILvsGSC)`, *p* = `r Round_and_format(py$vpFILvsGSC)`.  
<!-- ## /TEKSTBLOK: Tukey-HSD1.py -->

# Rapportage
<!-- ## TEKSTBLOK: Rapportage.py -->
Een *one-way ANOVA* is uitgevoerd om te toetsen of de gemiddelde reistijd van de studenten per opleiding gelijk is aan elkaar. De opleidingen zijn: Arabische Taal en Cultuur (*M~atc~* = `r Round_and_format(py$vM_ATC)`, *SD~atc~* = `r Round_and_format(py$vSD_ATC)`), Filosofie (*M~fil~* = `r Round_and_format(py$vM_FIL)`, *SD~fil~* = `r Round_and_format(py$vSD_FIL)`) en Geschiedenis (*M~gsc~* = `r Round_and_format(py$vM_GSC)`, *SD~fil~* = `r Round_and_format(py$vSD_FIL)`; zie ook Tabel 1. De gemiddelde reistijd van de groepen verschilt significant van elkaar, *F*(`r py$vDF1`, `r py$vDF2`) = `r Round_and_format(py$vF_waarde)`, *p* < 0,0001, *η^2^* = `r Round_and_format(py$Esq)`. De sterkte van het effect van de type opleiding op de reistijd is groot.


| Opleiding     | N          | M          | SD          |
| ------------- | ---------- | ---------- | ----------- |
| Arabisch      | `r Round_and_format(py$vN_ATC)` | `r Round_and_format(py$vM_ATC)` | `r Round_and_format(py$vSD_ATC)` |
| Filosofie     | `r Round_and_format(py$vN_FIL)` | `r Round_and_format(py$vM_FIL)` | `r Round_and_format(py$vSD_FIL)` |
| Geschiedenis  | `r Round_and_format(py$vN_GSC)` | `r Round_and_format(py$vM_GSC)` | `r Round_and_format(py$vSD_GSC)` |
<!-- ## /TEKSTBLOK: Rapportage.py -->
*Tabel 1. Groepsgrootte, gemiddelde reistijd en standaarddeviatie per opleiding*
<!-- ## TEKSTBLOK: Rapportage-tukey.py -->
*Tukey's HSD test* is uitgevoerd om te toetsen welke van de drie gemiddelden significant verschillen. Filosofie en Arabische Taal en Cultuur verschillen significant (*MD* = `r Round_and_format(py$vATCvsFIL)`, *p* < 0,01). Tussen Geschiedenis en Arabische Taal en Cultuur is een significant verschil (*MD* = `r Round_and_format(py$vATCvsGSC)`, *p* < 0,01). Tussen Geschiedenis en Filosofie is geen significant verschil gevonden (*MD* = `r Round_and_format(py$vFILvsGSC)`, *p* = 0,26). 
<!-- ## /TEKSTBLOK: Rapportage-tukey.py -->

Aan de hand van de resultaten kan geconcludeerd worden dat de studenten van Arabische Taal en Cultuur significant langer moeten reizen dan de andere twee opleidingen. Tussen de studenten Filosofie en Geschiedenis is geen significant verschil gevonden. 

<!-- ## CLOSEDBLOK: Footer.R -->
```{r footer, include = TRUE, echo = FALSE, results='asis', code =  readLines(paste0(here::here(),"/01. Includes/code/Footer.R"))}
```
<!-- ## /CLOSEDBLOK: Footer.R -->

[^1]: Van Geloven, N. (25 mei 2016). *One-way ANOVA*. [Wiki Statistiek Academisch Medisch Centrum](https://wikistatistiek.amc.nl/index.php/One-way_ANOVA).
[^2]: Universiteit van Amsterdam (8 juli 2014). *One-way ANOVA*. [UvA Wiki Methodologiewinkel](https://wiki.uva.nl/methodologiewinkel/index.php/One-way_ANOVA).
[^3]: Onderscheidend vermogen, in het Engels power genoemd, is de kans dat de nulhypothese verworpen wordt wanneer de alternatieve hypothese 'waar' is.  
[^4]: Field, A., Miles, J., & Field, Z. (2012). *Discovering statistics using R*. London: Sage publications.
[^5]: Van Geloven, N. (21 maart 2018). *Kruskal Wallis*. [Wiki Statistiek Academisch Medisch Centrum](https://wikistatistiek.amc.nl/index.php/Kruskal_Wallis).
[^6]: De [Kruskal-Wallis toets](10-Kruskal-Wallis-toets-R.html) maakt een rangschikking van de data. Hierdoor is de toets verdelingsvrij en is normaliteit geen assumptie. Ook zijn uitbijters minder van invloed op het eindresultaat. Toch wordt er voor deze toets minder vaak gekozen, omdat bij het maken van een rankschikking de dataset informatie verliest. Als de data wel normaal verdeeld zijn, heeft de [Kruskal-Wallis toets](10-Kruskal-Wallis-toets-R.html) minder onderscheidend vermogen dan wanneer de *one-way ANOVA* uitgevoerd zou worden.
[^7]: Laerd statistics (2018). *Testing for Normality using SPSS Statistics*. https://statistics.laerd.com/spss-tutorials/testing-for-normality-using-spss-statistics.php. 
[^8]: Universiteit van Amsterdam (14 juli 2014). *Normaliteit*. [UvA Wiki Methodologiewinkel](https://wiki.uva.nl/methodologiewinkel/index.php/Normaliteit).
[^9]: Bereken de logaritme van de variabele en de inverse (1 gedeeld door de variabele), en bekijk of deze normaal verdeeld zijn. Als dat zo is, mag je die gebruiken voor de analyse.
[^10]: Wikipedia (7 september 2019). *Analysis of variance*. https://en.wikipedia.org/wiki/Analysis_of_variance.
[^11]: Field, A., Miles, J., & Field, Z. (2012). *Discovering statistics using R*. London: Sage publications.
[^12]: Watson, P. (30 oktober 2019). *Rules of thumb on magnitudes of effect sizes*. [MRC Cognition and Brain Sciences Unit Wiki](http://imaging.mrc-cbu.cam.ac.uk/statswiki/FAQ/effectSize).
[^13]: Eta-squared. (2019 May 14). Retrieved from: https://en.wikiversity.org/wiki/Eta-squared.
[^14]: Universiteit van Amsterdam (26 augustus 2014). *MANOVA*. [UvA Wiki Methodologiewinkel](https://wiki.uva.nl/methodologiewinkel/index.php/MANOVA).
[^15]: Marshall, E., & Boggis, E. (2016). *The statistics tutor’s quick guide to commonly used statistical tests*. http://www.statstutor.ac.uk/resources/uploaded/tutorsquickguidetostatistics.pdf. 
[^16]: Outliers (13 augustus 2016). [UvA Wiki Methodologiewinkel](https://wiki.uva.nl/methodologiewinkel/index.php/Outliers).
[^17]: Uitbijters kunnen bepalend zijn voor de uitkomst van toetsen. Bekijk of de uitbijters valide uitbijters zijn en niet een meetfout of op een andere manier incorrect verkregen data. Het weghalen van uitbijters kan de uitkomst ook vertekenen, daarom is het belangrijk om verwijderde uitbijters te melden in een rapport. 
[^18]: In dit voorbeeld wordt uitgegaan van een waarschijnlijkheid van 95% c.q. een p-waardegrens van 0,05. De grens is naar eigen inzicht aan te passen; houd hierbij rekening met type I en type II fouten.

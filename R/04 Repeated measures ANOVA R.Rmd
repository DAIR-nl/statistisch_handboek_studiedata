---
title: "Rpeated measures ANOVA"
output:
  html_document:
    theme: lumen
    toc: yes
    toc_float: 
      collapsed: FALSE 
    number_sections: true
    includes:
      in_header: ["../01. Includes/html/favicon.html", "../01. Includes/html/analytics.html"]
  keywords: [statistisch handboek, studiedata]
---

<!-- ## CLOSEDBLOK: Functies.R -->
```{r functies, include = TRUE, echo = FALSE, results='asis', warning=FALSE, message=FALSE}
library(here)
if (!exists("Substitute_var")) {
  ## Installeer packages en functies
  source(paste0(here::here(), "/99. Functies en Libraries/00. Voorbereidingen.R"), echo = FALSE)
}
```
<!-- ## /CLOSEDBLOK: Functies.R -->

<!-- ## CLOSEDBLOK: CSS -->
<style>
`r htmltools::includeHTML(paste0(here::here(),"/01. Includes/css/Stylesheet_SHHO.css"))`
</style>
<!-- ## /CLOSEDBLOK: CSS -->

<!-- ## CLOSEDBLOK: Header.R -->
```{r header, include = TRUE, echo = FALSE, results='asis', code =  readLines(paste0(here::here(),"/01. Includes/code/Header.R"))} 
```
<!-- ## /CLOSEDBLOK: Header.R -->

<!-- ## CLOSEDBLOK: Reticulate.R -->

<!-- ## /CLOSEDBLOK: Reticulate.R -->

<!-- ## CLOSEDBLOK: Status.R -->
```{r status, include = TRUE, echo = FALSE, results='asis', code =  readLines(paste0(here::here(),"/01. Includes/code/Status.R"))} 
```
<!-- ## /CLOSEDBLOK: Status.R -->

```{r set-options, echo=FALSE, cache=FALSE}
options(width = 80)
## Zodat de TukeyHSD naast elkaar geprint wordt
```

<!-- ## OPENBLOK: Data-aanmaken.R -->
```{r aanmaken data, include=FALSE, echo=TRUE}
source(paste0(here::here(),"/01. Includes/data/04.R"))
```

<!-- ## /OPENBLOK: Data-aanmaken.R -->

# Toepassing
Gebruik de *repeated measures ANOVA* om te toetsen of de gemiddelden van te vergelijken van een groep bij drie of meer herhaalde metingen.[^1] 

# Onderwijscasus
<div id = "casus">

De opleidingsdirecteur van de bachelor Technische Natuurkunde hoort vanuit de opleidingscommissie dat de eerstejaarsstudenten de studielast van de eerste onderwijsperiode als erg hoog ervaren. Om te onderzoeken hoe deze ervaren studielast verminderd kan worden, wil hij onderzoeken hoeveel tijd deze studenten per week besteden aan hun vakken. Uit vakevaluaties verzamelt hij gegevens van het aantal uur per week dat eerstejaars studenten besteden aan de vakken in periode 1: lineaire algebra, relativiteitstheorie en kosmologie. Op deze manier kan hij onderzoeken of er verschillen in de tijdsbesteding aan de verschillende vakken zijn en om te bepalen van welke vakken de studielast aangepast moeten worden.

*H~0~*: Het aantal studieuren per week van eerstejaars studenten van de bachelor Technische Natuurkunde is hetzelfde voor de drie vakken in periode 1

*H~A~*: Het aantal studieuren per week van eerstejaars studenten van de bachelor Technsiche Natuurkunde is niet hetzelfde voor de drie vakken in periode 1

</div>

# Assumpties
Om een valide toetsresultaat te bereiken met de *repeated measures ANOVA*, moeten de data aan een aantal voorwaarden voldoen: normaliteit, sphericiteit en onafhankelijkheid.[^1] 

## Normaliteit
De assumptie van normaliteit houdt in dat er een normale
verdeling van de afhankelijke variabele is in elke groep. Wanneer er duidelijke afwijkingen van normaliteit zijn,
is het transformeren van de data een optie.[^2] Een andere optie is het gebruik van de nonparametrische
*Friedman toets* waar normaliteit geen assumptie is.[^3] Controleer de assumptie van normaliteit voor elke groep met de volgende stappen:  
1. Controleer de data visueel met een histogram, een boxplot of een Q-Q plot.   
2. Toets of de data normaal verdeeld zijn met de *Kolmogorov-Smirnov test* of bij een kleinere steekproef (n < 50) met de *Shapiro-Wilk test*.[^7]<sup>, </sup>[^8]  

## Sphericiteit
De assumptie van sphericiteit houdt in dat de variantie van de verschilscores tussen groepen ongeveer aan elkaar gelijk zijn.[^4] In deze casus zijn dat de verschilscores tussen de drie vakken: Lineaire Algebra minus Relativiteitstheorie, Relativiteitstheorie minus Kosmologie en Kosmologie minus Lineaire Algebra. Toets deze assumptie met *Mauchly's test*. Wanneer de data niet aan de assumptie voldoen, geeft de gewone *repeated measures ANOVA* een verkeerd resultaat. Er zijn echter correcties die gebruikt kunnen worden wanneer de data niet aan sphericiteit voldoen. Een voorbeeld van mogelijke output van *Mauchly's test* in R is hieronder weergegeven.

```{r, echo=FALSE}
cat("$`Mauchly's Test for Sphericity`
  Effect         W           p p<.05
2    Vak 0.8732982 0.005073887     *

$`Sphericity Corrections`
  Effect       GGe        p[GG] p[GG]<.05       HFe        p[HF] p[HF]<.05
2    Vak   0.47683     0.05279         *   0.56298      0.04692         ")
```

Bij een p-waarde < 0,05, toont *Mauchly's test* dat de assumptie van sphericiteit geschonden is. In de output is dit te zien aan de p-waarde van 0,0051 onder ` $Mauchly's Test for Sphericity `. Er zijn twee mogelijke correcties wannner er geen sphericiteit is: de Greenhouse-Geisser (GG) en Huynh-Feldt (HF) correctie. De Greenhouse-Geisser correctie staat bekend als conservatief wat betekent dat de correctie een relatief lage kans op een type I fout heeft. In andere woorden, het zal niet vaak gebeuren dat deze correctie een significant effect aantoont wanneer dat er in werkelijkheid niet is. De Huynh-Feldt correctie staat echter bekend als liberaal, wat betekent dat er een relatief hoge kans op een type I fout is. De teststatistiek en p-waarde van beide correcties is in de output te vinden onder ` $Sphericity Corrections `.

Houd de volgende richtlijnen aan bij het interpreteren van de *repeated measures ANOVA* wanneer niet aan sphericiteit is voldaan:

* Wanneer beide correcties significant zijn, rapporteer de (conservatieve) Greenhouse-Geisser correctie.
* Wanneer beide correcties niet significant zijn, rapporteer de (liberale) Huynh-Feldt correctie.
* Wanneer de een significant is en de ander niet, bereken de gemiddelde p-waarde van beide testen.
    * Wanneer deze p-waarde significant is, rapporteer dan de significante correctie.
    * Wanneer deze p-waarde niet significant is, rapporteer dan de niet significante correctie.

In de voorbeeldoutput is de p-waarde van de Greenhouse-Geisser correctie > 0,05 en de p-waarde van de Huynh-Feldt correctie < 0,05. Het gemiddelde van beide p-waarden is 0,049855, wat betekent dat er een significant resultaat is. Rapporteer in dit geval dus de (significante) Huynh-Feldt correctie, i.e. *F* = 0,56, *p* < 0,05.  


# Effectmaat
De p-waarde geeft aan of het verschil tussen groepen statistisch significant is. De grootte van het verschil of effect is echter ook relevant. Een effectmaat is een gestandaardiseerde maat die de grootte van een effect weergeeft zodat effecten vergeleken kunnen worden voor verschillende onderzoeken.[^4] Voor de *one-way ANOVA* wordt de effectmaat eta squared vaak gebruikt.

## Eta squared
De effectmaat eta squared (*η^2^*) berekent de proportie van de variantie in de afhankelijke variabele wat verklaard wordt door de onafhankelijke variabele. In deze casus berekent het de proportie van de variantie in de lengte van de reistijd die verklaard kan worden door de opleiding. Een indicatie om *η^2^* te interpreteren is: rond 0,01 is een klein effect, rond 0,06 is een gemiddeld effect en rond 0,14 is een groot effect.[^3]

# Post-hoc toetsen
De one-way ANOVA toetst of één of meerdere van de gemiddelden anders is dan de andere gemiddelden. Voer een post-hoc toets uit om te bepalen welke groepen significant verschillen.

Gebruik een correctie voor de p-waarden, omdat er meerdere testen tegelijkertijd worden gebruikt. In deze toetspagina wordt de *Bonferroni correctie* gebruikt. Deze correctie past de p-waarde aan door de p-waarde te vermenigvuldigen met het aantal uitgevoerde toetsen en verlaagt hiermee de kans dat er bij toeval een verband wordt ontdekt dat er niet is (type I fout).[^8] Er zijn ook andere opties voor een correctie op de p-waarden. De keuze voor een correctie is afhankelijk van het onderzoek.[^4]

# Uitvoering
<!-- ## TEKSTBLOK: Dataset-inladen.R-->
Er is een dataset `Studieuren_technische_natuurkunde` ingeladen met het aantal studieuren van eerstejaars studenten van de bachelor Technische Natuurkunde voor de drie vakken in periode 1.
<!-- ## /TEKSTBLOK: Dataset-inladen.R-->

## De data bekijken
<!-- ## TEKSTBLOK: Data-bekijken.R -->
Gebruik `head()` en `tail()` om de structuur van de data te bekijken.
<!-- ## /TEKSTBLOK: Data-bekijken.R -->

<!-- ## OPENBLOK: Data-bekijken.R -->
```{r data bekijken, collapse = TRUE}
## Eerste 5 observaties
head(Studieuren_technische_natuurkunde)

## Laatste 5 observaties
tail(Studieuren_technische_natuurkunde)
```
<!-- ## /OPENBLOK: Data-bekijken.R -->

Selecteer de drie groepen en sla deze op in een vector om deze makkelijker aan te kunnen roepen. 
<!-- ## OPENBLOK: Data-selecteren.R -->
```{r data selecteren}

Studieuren_lineaire_algebra <- Studieuren_technische_natuurkunde$Studieuren[Studieuren_technische_natuurkunde$Vak=="Lineaire Algebra"]
Studieuren_relativiteitstheorie <- Studieuren_technische_natuurkunde$Studieuren[Studieuren_technische_natuurkunde$Vak=="Relativiteitstheorie"]
Studieuren_kosmologie <- Studieuren_technische_natuurkunde$Studieuren[Studieuren_technische_natuurkunde$Vak=="Kosmologie"]
```
<!-- ## /OPENBLOK: Data-selecteren.R -->


<!-- ## TEKSTBLOK: Data-beschrijven.R -->
Inspecteer de data met `length()`, `mean()`en `sd()` om meer inzicht te krijgen in de data.
<!-- ## /TEKSTBLOK: Data-beschrijven.R -->


<div class="col-container"> 
  <div class="col">
<!-- ## OPENBLOK: Lilliefors-test-1.R -->
```{r descriptives 1, warning=FALSE, collapse=TRUE}
# Gemiddelde
mean(Studieuren_lineaire_algebra)
# Standaardafwijking
sd(Studieuren_lineaire_algebra)
# Aantal observaties
length(Studieuren_lineaire_algebra)
```
<!-- ## OPENBLOK: Lilliefors-test-1.R -->
  </div>
  <div class = "col">
<!-- ## OPENBLOK: Lilliefors-test-2.R -->
```{r descriptives 2, warning=FALSE, collapse=TRUE}
# Gemiddelde
mean(Studieuren_relativiteitstheorie)
# Standaardafwijking
sd(Studieuren_relativiteitstheorie)
# Aantal observaties
length(Studieuren_relativiteitstheorie)
```
<!-- ## OPENBLOK: Lilliefors-test-2.R -->
  </div>
  <div class = "col">
<!-- ## OPENBLOK: Lilliefors-test-3.R -->
```{r descriptives 3, warning=FALSE, collapse=TRUE}
# Gemiddelde
mean(Studieuren_kosmologie)
# Standaardafwijking
sd(Studieuren_kosmologie)
# Aantal observaties
length(Studieuren_kosmologie)
```
<!-- ## /OPENBLOK: Lilliefors-test-3.R -->
  </div>
</div>


<!-- ## CLOSEDBLOK: Data-beschrijven.R -->
```{r data beschrijven als object, include=FALSE, echo=TRUE}
vM_LA  <- Round_and_format(mean(Studieuren_lineaire_algebra))
vSD_LA <- Round_and_format(sd(Studieuren_lineaire_algebra))
vN_LA  <- Round_and_format(length(Studieuren_lineaire_algebra))

vM_RT  <- Round_and_format(mean(Studieuren_relativiteitstheorie))
vSD_RT <- Round_and_format(sd(Studieuren_relativiteitstheorie))
vN_RT  <- Round_and_format(length(Studieuren_relativiteitstheorie))

vM_KL  <- Round_and_format(mean(Studieuren_kosmologie))
vSD_KL <- Round_and_format(sd(Studieuren_kosmologie))
vN_KL  <- Round_and_format(length(Studieuren_kosmologie))
```
<!-- ## /CLOSEDBLOK: Data-beschrijven.R -->

<!-- ## TEKSTBLOK: Datatekst-beschrijven.R -->
* Gemiddelde aantal studieuren Lineaire Algebra (standaarddeviatie): `r vM_LA` (`r vSD_LA`). *n* = `r vN_LA`  
* Gemiddelde aantal studieuren Relativiteitstheorie (standaarddeviatie): `r vM_RT` (`r vSD_RT`). *n* = `r vN_RT`  
* Gemiddelde aantal studieuren Kosmologie (standaarddeviatie): `r vM_KL` (`r vSD_KL`). *n* = `r vN_KL`  

<!-- ## /TEKSTBLOK: Datatekst-beschrijven.R -->

## Visuele inspectie van normaliteit
Geef de verdeling van de data visueel weer met een histogram, Q-Q plot of boxplot.

### Histogram
<!-- ## OPENBLOK: Histogram.R -->
```{r histogram}
## Histogram met ggplot
library(ggplot2)

ggplot(Studieuren_technische_natuurkunde,
  aes(x = Studieuren)) +
  geom_histogram(aes(y = ..density..),
                 binwidth = 2,
                 color = "grey30",
                 fill = "#0089CF") +
  facet_wrap(~ Vak) +
  geom_density(alpha = .2, adjust = 1) +
  ylab("Frequentiedichtheid") +
  labs(title = "Aantal studieuren")
```
<!-- ## /OPENBLOK: Histogram.R -->

Alle drie de vakken lijken redelijk normaal verdeeld te zijn.

### Q-Q plot
<!-- ## TEKSTBLOK: QQplot.R-->
Gebruik `qqnorm()` en `qqline()` met `pch = 1`om een Q-Q plot te maken, met als datapunten kleine cirkels.
<!-- ## /TEKSTBLOK: QQplot.R-->

Als over het algemeen de meeste datapunten op de lijn liggen, neem dan aan dat de data normaal verdeeld zijn.
<div class = "col-container">
  <div class="col">
<!-- ## OPENBLOK: QQplot1.R -->
```{r qqplot la}
qqnorm(
 Studieuren_lineaire_algebra, pch = 1,
 main = "Normaal Q-Q plot van aantal studieuren Lineaire Algebra",
 ylab = "Kwantielen in data",
 xlab = "Theoretische kwantielen")
qqline(Studieuren_lineaire_algebra)
```
<!-- ## /OPENBLOK: QQplot1.R -->
  </div>
  <div class = "col">
<!-- ## OPENBLOK: QQplot2.R -->
```{r qqplot rt}
qqnorm(
 Studieuren_relativiteitstheorie, pch = 1,
 main = "Normaal Q-Q plot van aantal studieuren Relativiteitstheorie",
 ylab = "Kwantielen in data",
 xlab = "Theoretische kwantielen")
qqline(Studieuren_relativiteitstheorie)
```
<!-- ## /OPENBLOK: QQplot2.R -->
  </div>
  <div class = "col">
<!-- ## OPENBLOK: QQplot3.R -->
```{r qqplot gsc}
qqnorm(
 Studieuren_kosmologie, pch = 1,
 main = "Normaal Q-Q plot van aantal studieuren Kosmologie",
 ylab = "Kwantielen in data",
 xlab = "Theoretische kwantielen")

qqline(Studieuren_kosmologie)
```
<!-- ## OPENBLOK: QQplot3.R -->
  </div>
</div>

Bij de Q-Q plots van Lineaire Algebra en Kosmologie liggen de punten rond de lijn die normaliteit aangeeft; vermoedelijk zijn deze data normaal verdeeld. Bij Relativiteitstheorie echter zijn er afwijkingen van de lijn bij de staarten van de verdeling. De statistische toetsen wijzen uit of deze afwijking van de normale verdeling significant is.


### Boxplot
De box geeft de middelste 50% van de reistijd weer. De zwarte lijn binnen de box is de mediaan. De staarten bevatten de eerste 25% en de laatste 25%. Cirkels visualiseren mogelijke uitbijters.[^8]<sup>, </sup>[^9] Hoe meer de boxen overlappen, hoe waarschijnlijker er geen significant verschil is tussen de groepen. 

<!-- ## OPENBLOK: Boxplot.R -->
```{r boxplot}
library(graphics)
boxplot(Studieuren ~ Vak, Studieuren_technische_natuurkunde)
```
<!-- ## /OPENBLOK: Boxplot.R -->

De boxplotten geven de spreiding weer van het aantal studieuren voor de drie vakken in periode 1: Kosmologie, Lineaire Algebra en Relativiteitstheorie. Bij Kosmologie en Lineaire Algebra lijkt er enige asymmetrie te zijn: de boxen zijn niet even breed. Daarnaast liggen de medianen van beide vakken een stuk lager dan de mediaan van Relativiteitstheorie. Kosmologie en Relativiteitstheorie hebben mogelijke uitbijters. In het algemeen lijken de vakken een symmetrische verdeling te hebben.


## Toetsen van normaliteit
Om te controleren of de data normaal verdeeld zijn, kan de normaliteit getoetst worden. Twee veelgebruikte toetsen zijn: de *Kolmogorov-Smirnov test* en de *Shapiro-Wilk test*.

### Kolmogorov-Smirnov
De *Kolmogorov-Smirnov test* toetst het verschil tussen twee verdelingen. Standaard toetst deze test het verschil tussen een normale verdeling en de verdeling van de steekproef. De Lilliefors correctie is vereist als het gemiddelde en de standaardafwijking niet van tevoren bekend of bepaald zijn, wat meestal het geval is bij een steekproef. Als de p < 0,05 is, is de verdeling van de data significant verschillend van de normale verdeling.

<!-- ## TEKSTBLOK: Lilliefors-test1.R -->

<!-- ## /TEKSTBLOK: Lilliefors-test1.R -->

<!-- ## OPENBLOK: Library-nortest.R -->
```{r library nortest}
library("nortest")
```
<!-- ## /OPENBLOK: Library-nortest.R -->

<div class="col-container"> 
  <div class="col">
<!-- ## OPENBLOK: Lilliefors-test-1.R -->
```{r Lilliefors Test-1, warning=FALSE}
lillie.test(Studieuren_lineaire_algebra)
```
<!-- ## OPENBLOK: Lilliefors-test-1.R -->
  </div>
  <div class = "col">
<!-- ## OPENBLOK: Lilliefors-test-2.R -->
```{r Lilliefors Test-2, warning=FALSE}
lillie.test(Studieuren_relativiteitstheorie)
```
<!-- ## OPENBLOK: Lilliefors-test-2.R -->
  </div>
  <div class = "col">
<!-- ## OPENBLOK: Lilliefors-test-3.R -->
```{r Lilliefors Test-3, warning=FALSE}
lillie.test(Studieuren_kosmologie)
```
<!-- ## /OPENBLOK: Lilliefors-test-3.R -->
  </div>
</div>

De p-waarde is *p* > 0,05 voor elke groep; er is geen statistisch significant verschil gevonden tussen de verdeling van de steekproef en de normale verdeling. [^10] De *repeated measures ANOVA* kan uitgevoerd worden.

### Shapiro-Wilk Test
De *Shapiro-Wilk test* is een soortgelijke toets als de *Kolmogorov-Smirnov test* en vooral geschikt bij kleine steekproeven (n < 50). Als de p < 0,05 is, is de verdeling van de data significant verschillend van de normale verdeling.

<div class="col-container"> 
  <div class="col">
<!-- ## OPENBLOK: Shapiro-Wilk-test-3.R -->
``` {r Shapiro-Wilk Test-3, warning=FALSE}
shapiro.test(Studieuren_lineaire_algebra)
```
<!-- ## /OPENBLOK: Shapiro-Wilk-test-3.R -->
  </div>
  <div class= "col">
<!-- ## OPENBLOK: Shapiro-Wilk-test-2.R -->
``` {r Shapiro-Wilk Test-2, warning=FALSE}
shapiro.test(Studieuren_relativiteitstheorie)
```
<!-- ## OPENBLOK: Shapiro-Wilk-test-2.R -->
  </div>
  <div class= "col"> 
<!-- ## OPENBLOK: Shapiro-Wilk-test-1.R -->
``` {r Shapiro-Wilk Test-1, warning=FALSE}
shapiro.test(Studieuren_kosmologie)
```
<!-- ## OPENBLOK: Shapiro-Wilk-test-1.R -->
  </div>
</div>

De p-waarde is *p* > 0,05 voor elke groep, dus er is geen statistisch significant verschil gevonden tussen de verdeling van de steekproef en de normale verdeling. De *repeated measures ANOVA* kan uitgevoerd worden.


## Repeated measures ANOVA 
Voer de *repeated measures ANOVA* uit om de vraag te beantwoorden of er verschillen zijn tussen het aantal studieuren voor de vakken in periode 1 van het eerste jaar van de bachelor Technische Natuurkunde.

<!-- ## TEKSTBLOK: ANOVA-toets.R -->


Gebruik `aov()` om een ANOVA-object (`aov`) te creëren. Het eerste argument bestaat uit de afhankelijke variabele `Reistijd` en de groepvariabele `Opleiding`; het tweede argument bevat de dataset `Reistijd_per_opleiding`.  Geef het resultaat overzichtelijk weer met `summary()`.
<!-- ## /TEKSTBLOK: ANOVA-toets.R -->
<!-- ## OPENBLOK: ANOVA-toets.R -->
```{r ANOVA}
library(ez)
ezANOVA(Studieuren_technische_natuurkunde, dv = Studieuren, wid = Studentnummer,
               within = Vak)
```
<!-- ## /OPENBLOK: ANOVA-toets.R -->

<!-- ## CLOSEDBLOK: ANOVA-toets.R -->
```{r ANOVA als object, echo=FALSE}
#ANOVA <- summary(res.aov)
#vF_waarde <- Round_and_format(ANOVA[[1]]$`F value`[1])
```
<!-- ## /CLOSEDBLOK: ANOVA-toets.R -->

<!-- ## TEKSTBLOK: ANOVA-toets1.R -->
```{r }
#* *F* ~`r vDF1`~~,~~`r vDF2`~ = `r vF_waarde`, *p* < 0,0001.
#* De p-waarde < 0,05, dus de H~0~ wordt verworpen.[^18] 
#* Vrijheidsgraden: het aantal groepen - 1 = `r vDF1`; *n~1~* + *n~2~* + *n~3~*- 3 = `r vDF2`.

```
<!-- ## /TEKSTBLOK: ANOVA-toets1.R -->


### Effectmaat: Eta squared

<!-- ## TEKSTBLOK: Eta-squared-tekst.R -->
Gebruik `EtaSq()` op een een object met `class = aov` om het effect te meten.
<!-- ## /TEKSTBLOK: Eta-squared-tekst.R -->

<!-- ## OPENBLOK: Eta-squared.R --> 
```{r eta-squared, message = FALSE, warning=FALSE}
#library(DescTools)
#EtaSq(res.aov)
```
<!-- ## /OPENBLOK: Eta-squared.R -->
<!-- ## CLOSEDBLOK: Eta-squared.R -->
```{r eta-squared als object, include = FALSE}
#Esq <- Round_and_format(EtaSq(res.aov)[1])
#*η^2^* = `r Esq`, de sterkte van het effect van de type opleiding op de reistijd is groot. 

```
<!-- ## /CLOSEDBLOK: Eta-squared.R -->
<!-- ## TEKSTBLOK: Eta-squared.R -->

<!-- ## /TEKSTBLOK: Eta-squared.R -->

## Post-hoc toets: Tukey's toets
Voer om te bepalen welke van de type opleidingen in reistijd verschillen een post-hoc toets uit. Gebruik bij groepen met gelijke variantie de Tukey Honestly Significant Difference Test.
<!-- ## TEKSTBLOK: Tukey-HSD.R -->
Gebruik `TukeyHSD()` op de uitkomsten van de *one-way ANOVA*, het ANOVA-object `res.aov`.
<!-- ## /TEKSTBLOK: Tukey-HSD.R -->

<!-- ## OPENBLOK: Tukey-HSD.R -->
```{r TukeyHSD}
#TukeyHSD(res.aov)
```
<!-- ## /OPENBLOK: Tukey-HSD.R -->
<!-- ## CLOSEDBLOK: Tukey-HSD.R -->
```{r TukeyHSD als object, include=FALSE}
#THSD <- TukeyHSD(res.aov)
#$vATCvsFIL <- Round_and_format(THSD$Opleiding[1,1])
#vATCvsGSC <- Round_and_format(THSD$Opleiding[2,1])
#vFILvsGSC <- Round_and_format(THSD$Opleiding[3,1])

#<!-- ## TEKSTBLOK: Tukey-HSD1.R -->
#Het verschil tussen Filosofie en Arabische Taal en Cultuur: *MD* = `r vATCvsFIL`, p < 0,0001.  
#Het verschil tussen Geschiedenis en Arabische Taal en Cultuur: *MD* = `r vATCvsGSC`, p < 0,0001.  
#Het verschil tussen Geschiedenis en Filosofie: *MD* = `r vFILvsGSC`, p = 0,26.  
#<!-- ## /TEKSTBLOK: Tukey-HSD1.R -->

```
<!-- ## /CLOSEDBLOK: Tukey-HSD.R -->

```{r}

# Rapportage
#<!-- ## TEKSTBLOK: Rapportage.R -->
#Een *one-way ANOVA* is uitgevoerd om te toetsen of de gemiddelde reistijd van de studenten is per opleiding gelijk aan elkaar is. De opleidingen zijn: Arabische Taal en Cultuur (*M~atc~* = `r vM_ATC`, *SD~atc~* = `r vSD_ATC`), Filosofie (*M~fil~* = `r vM_FIL`, *SD~fil~* = `r vSD_FIL`) en Geschiedenis (*M~gsc~* = `r vM_GSC`, *SD~fil~* = `r vSD_FIL`); zie ook tabel. De gemiddelde reistijd van de groepen verschillen significant van elkaar, *F*(`r vDF1`, `r vDF2`) = `r vF_waarde`, *p* < 0,0001, *η^2^* = `r Esq`. De sterkte van het effect van de type opleiding op de reistijd is groot.

#| Opleiding     | N          | M          | SD          |
#| ------------- | ---------- | ---------- | ----------- |
#| Arabisch      | `r vN_ATC` | `r vM_ATC` | `r vSD_ATC` |
#| Filosofie     | `r vN_FIL` | `r vM_FIL` | `r vSD_FIL` |
#| Geschiedenis  | `r vN_GSC` | `r vM_GSC` | `r vSD_GSC` |
#<!-- ## /TEKSTBLOK: Rapportage.R -->
#*Tabel 1. Groepsgrootte, gemiddelde reistijd en standaarddeviatie per opleiding*
#<!-- ## TEKSTBLOK: Rapportage-tukey.R -->

#*Tukey's HSD test* is uitgevoerd om te toetsen welke van de drie gemiddelden significant verschillen. Filosofie en Arabische Taal en Cultuur verschillen significant (*MD* = `r vATCvsFIL`, p < 0,0001). Tussen Geschiedenis en Arabische Taal en Cultuur is een significant verschil (*MD* = `r vATCvsGSC`, p < 0,0001). Tussen Geschiedenis en Filosofie is geen significant verschil gevonden (*MD* = `r vFILvsGSC`, p = 0,26). 
#<!-- ## /TEKSTBLOK: Rapportage-tukey.R -->

#Aan de hand van de resultaten kan geconcludeerd worden dat de studenten van Arabische Taal en Cultuur significant langer moeten reizen dan de andere twee opleidingen. Tussen de studenten Filosofie en Geschiedenis is geen significant verschil gevonden. 
```

<!-- ## CLOSEDBLOK: Footer.R -->
```{r footer, include = TRUE, echo = FALSE, results='asis', code =  readLines(paste0(here::here(),"/01. Includes/code/Footer.R"))}
```
<!-- ## /CLOSEDBLOK: Footer.R -->

[^1]: Universiteit van Amsterdam (26 augustus 2014). *Repeated-Measures ANOVA*. [UvA Wiki Methodologiewinkel](https://wiki.uva.nl/methodologiewinkel/index.php/Repeated-Measures_ANOVA).
[^2]: Bereken de logaritme van de variabele, en de inverse (1 gedeeld door de variabele), en bekijk of deze normaal verdeeld zijn. Als dat zo is mag je die gebruiken voor de analyse.
[^3]: Allen, P. & Bennett, K. (2012). *SPSS A practical Guide version 20.0*. Cengage Learning Australia Pty Limited.
[^4]: Field, A., Miles, J., & Field, Z. (2012). *Discovering statistics using R*. London: Sage publications.
[^5]: Laerd statistics (2018). *Testing for Normality using SPSS Statistics*. https://statistics.laerd.com/spss-tutorials/testing-for-normality-using-spss-statistics.php. 
[^6]: Universiteit van Amsterdam (14 juli 2014). *Normaliteit*. [UvA Wiki Methodologiewinkel](https://wiki.uva.nl/methodologiewinkel/index.php/Normaliteit).
[^7]: Type I fout: Ten onrechte H~0~ verwerpen.
[^8]: Outliers (13 augustus 2016). [UvA Wiki Methodologiewinkel](https://wiki.uva.nl/methodologiewinkel/index.php/Outliers).
[^9]: Uitbijters kunnen bepalend zijn voor de uitkomst van toetsen. Bekijk of de uitbijters valide uitbijters zijn en niet een meetfout of op een andere manier incorrect verkregen data. Het weghalen van uitbijters kan de uitkomst ook vertekenen, daarom is het belangrijk om verwijderde uitbijters te melden in een rapport. 
[^10]: In dit voorbeeld wordt uitgegaan van een waarschijnlijkheid van 95% c.q. een p-waardegrens van 0,05. De grens is naar eigen inzicht aan te passen; houd hierbij rekening met type I en type II fouten.



[^7]: Laerd statistics (2018). *Testing for Normality using SPSS Statistics*. https://statistics.laerd.com/spss-tutorials/testing-for-normality-using-spss-statistics.php. 
[^8]: Universiteit van Amsterdam (14 juli 2014). *Normaliteit*. [UvA Wiki Methodologiewinkel](https://wiki.uva.nl/methodologiewinkel/index.php/Normaliteit).
[^9]: Bereken de logaritme van de variabele, en de inverse (1 gedeeld door de variabele), en bekijk of deze normaal verdeeld zijn. Als dat zo is mag je die gebruiken voor de analyse.
[^10]: Wikipedia (7 september 2019). *Analysis of variance*. https://en.wikipedia.org/wiki/Analysis_of_variance.
[^13]: Eta-squared. (2019 May 14). Retrieved from: https://en.wikiversity.org/wiki/Eta-squared.
[^15]: Marshall, E., & Boggis, E. (2016). *The statistics tutor’s quick guide to commonly used statistical tests*. http://www.statstutor.ac.uk/resources/uploaded/tutorsquickguidetostatistics.pdf. 
[^16]: Outliers (13 augustus 2016). [UvA Wiki Methodologiewinkel](https://wiki.uva.nl/methodologiewinkel/index.php/Outliers).
[^17]: Uitbijters kunnen bepalend zijn voor de uitkomst van toetsen. Bekijk of de uitbijters valide uitbijters zijn en niet een meetfout of op een andere manier incorrect verkregen data. Het weghalen van uitbijters kan de uitkomst ook vertekenen, daarom is het belangrijk om verwijderde uitbijters te melden in een rapport. 
[^18]: In dit voorbeeld wordt uitgegaan van een waarschijnlijkheid van 95% c.q. een p-waardegrens van 0,05. De grens is naar eigen inzicht aan te passen; houd hierbij rekening met type I en type II fouten.

---
title: "Tekentoets"
output:
  html_document:
    theme: lumen
    toc: yes
    toc_float: 
      collapsed: FALSE 
    number_sections: true
    includes:
      in_header: ["../01. Includes/html/nocache.html", "../01. Includes/html/favicon.html", "../01. Includes/html/analytics.html"]
  keywords: [statistisch handboek, studiedata]
---

<!-- ## CLOSEDBLOK: Functies.R -->
```{r functies, include = TRUE, echo = FALSE, results='asis', warning=FALSE, message=FALSE}
library(here)
if (!exists("Substitute_var")) {
  ## Installeer packages en functies
  source(paste0(here::here(), "/99. Functies en Libraries/00. Voorbereidingen.R"), echo = FALSE)
}
```
<!-- ## /CLOSEDBLOK: Functies.R -->

<!-- ## CLOSEDBLOK: CSS -->
<style>
`r htmltools::includeHTML(paste0(here::here(),"/01. Includes/css/Stylesheet_SHHO.css"))`
</style>
<!-- ## /CLOSEDBLOK: CSS -->

<!-- ## CLOSEDBLOK: Header.R -->
```{r header, include = TRUE, echo = FALSE, results='asis', code =  readLines(paste0(here::here(),"/01. Includes/code/Header.R"))} 
```
<!-- ## /CLOSEDBLOK: Header.R -->

<!-- ## CLOSEDBLOK: Status.R -->
```{r status, include = TRUE, echo = FALSE, results='asis', code =  readLines(paste0(here::here(),"/01. Includes/code/Status.R"))} 
```
<!-- ## /CLOSEDBLOK: Status.R -->

<!-- ## OPENBLOK: Data-aanmaken.R -->
```{r aanmaken data, include=FALSE, echo=TRUE}
source(paste0(here::here(),"/01. Includes/data/06.R"))
```
<!-- ## /OPENBLOK: Data-aanmaken.R -->
# Toepassing
Gebruik de *tekentoets* om de mediaan van een steekproef te vergelijken met een bekende mediaan of norm in een populatie.[^1] Deze toets is een alternatief voor de [one sample t-toets](01-One-sample-t-toets-R.html) wanneer de data niet normaal verdeeld is. De *Wilcoxon signed rank toets* kan ook gebruikt worden om de mediaan van een steekproef te vergelijken met een bekende mediaan. Deze toets heeft een hoger onderscheidend vermogen[^9], maar vereist dat de verdeling van de data symmetrisch is.[^8] Dit is geen vereiste bij de *tekentoets*.


# Onderwijscasus
<div id ="casus">
De opleidingsdirecteur van de school voor Journalistiek is benieuwd wat alumni verdienen ten opzichte van de gemiddelde Nederlander. Daarom wil zij de jaarinkomens van oud-studenten vergelijken met het modale inkomen van €36.000.[^2] Op deze manier vergaart zij meer informatie over het succes op de arbeidsmarkt na de opleiding Journalistiek.

Dit onderzoek vertaalt zich in de volgende combinatie van hypothesen, waarbij de nulhypothese zo geformuleerd is dat er geen effect is en de alternatieve hypothese zo geformuleerd is dat er een effect is wat overeenkomt met de verwachting van de onderzoeker.

*H~0~*: De mediaan van het jaarinkomen van alumni Journalistiek is gelijk aan €36.000, het modale jaarinkomen in Nederland.

*H~A~*: De mediaan van het jaarinkomen van alumni Journalistiek is niet gelijk aan €36.000, het modale jaarinkomen in Nederland. 
</div>

# Assumpties

Het meetniveau van de variabele is continu.[^10]

# Uitvoering in R
Er is data ingeladen met jaarlijkse bruto inkomens van alumni van de school voor Journalistiek genaamd `Jaarlijks_inkomen`. De directeur wil kijken hoe haar oud-studenten scoren ten opzichte van het modale inkomen in Nederland.

## De data bekijken
<!-- ## TEKSTBLOK: Data-bekijken.R -->
Gebruik `head()` en `tail()` om de data te bekijken.
<!-- ## /TEKSTBLOK: Data-bekijken.R -->

<!-- ## OPENBLOK: Data-bekijken.R -->
```{r data bekijken, collapse = TRUE}
## Eerste 6 observaties
head(Jaarlijks_inkomen)

## Laatste 6 observaties
tail(Jaarlijks_inkomen)
```
<!-- ## /OPENBLOK: Data-bekijken.R -->

<!-- ## TEKSTBLOK: Data-beschrijven.R -->
Inspecteer de data met `mean()`, `sd()`, `median()` en `length()` om meer inzicht te krijgen in de data.
<!-- ## /TEKSTBLOK: Data-beschrijven.R -->

<!-- ## OPENBLOK: Data-beschrijven.R -->
```{r data beschrijven, collapse=TRUE}
mean(Jaarlijks_inkomen)
sd(Jaarlijks_inkomen)
median(Jaarlijks_inkomen)
length(Jaarlijks_inkomen)
```
<!-- ## /OPENBLOK: Data-beschrijven.R -->
<!-- ## CLOSEDBLOK: Data-beschrijven2.R -->
```{r Var beschrijven, include=FALSE, echo=TRUE}
vMean <- Round_and_format(mean(Jaarlijks_inkomen))
vSD   <- Round_and_format(sd(Jaarlijks_inkomen))
vN    <- Round_and_format(length(Jaarlijks_inkomen))
vMed  <- Round_and_format(median(Jaarlijks_inkomen))
```
<!-- ## /CLOSEDBLOK: Data-beschrijven2.R -->

<!-- ## TEKSTBLOK: Datatekst-beschrijven2.R -->
Het gemiddelde jaarinkomen van de alumni is `r paste("€", vMean, sep="")` met een standaardafwijking van `r paste("€", vSD, sep="")` (*n* = `r vN`). De mediaan van het inkomen is `r paste("€", vMed, sep="")`.
<!-- ## /TEKSTBLOK: Datatekst-beschrijven2.R -->

## Normaliteit visualiseren en testen

De *tekentoets* is een alternatief voor de [one-sample t-toets](01-One-sample-t-toets-R.html) wanneer de data geen normale verdeling volgt. Hoewel het visueel inspecteren en testen van normaliteit niet vereist is, is het nuttig om de verdeling van de data te visualiseren en te vergelijken met de normaalverdeling.

### Histogram
Geef de verdeling van de data weer in een histogram. Focus bij het analyseren van een histogram op de symmetrie van de verdeling, de hoeveelheid toppen (modaliteit) en mogelijke uitbijters. Een normale verdeling is symmetrisch, heeft één top en geen uitbijters.[^6]<sup>, </sup>[^7]
<!-- ## OPENBLOK: Histogram.R -->
```{r histogram, warning=FALSE, message=FALSE}
## Histogram met ggplot2
library(ggplot2)

ggplot(data.frame(Jaarlijks_inkomen), 
       aes(x = Jaarlijks_inkomen)) +
  geom_histogram(aes(y = ..density..),
                 binwidth = 10000, 
                 color = "white", 
                 fill = "#158CBA") +
  #geom_density(alpha = .2, adjust = 1) +
  ylab("Frequentiedichtheid") +
  xlab("Jaarlijks_inkomen") +
scale_x_continuous(labels = as.character(seq(20000, 100000, 20000)), 
                   breaks = seq(20000, 100000, 20000)) +
labs(title = "Jaarinkomen alumni Journalistiek", 
     subtitle = "")

```
<!-- ## /OPENBLOK: Histogram.R -->

De verdeling heeft één top en geen uitbijters. De histogram laat echter ook zien dat de verdeling een langere staart aan de rechterkant heeft en dus enigszins afwijkt van de (symmetrische) normaalverdeling. Aangezien de verdeling niet symmetrisch is, kan de *Wilcoxon signed rank toets* niet gebruikt worden om een hypothese over de mediaan te toetsen.

## Toetsen van normaliteit
Om te controleren of de data normaal verdeeld zijn, kan de normaliteit getoetst worden. Twee veelgebruikte toetsen zijn de *Kolmogorov-Smirnov test* en de *Shapiro-Wilk test*. Toets normaliteit met de *Kolmogorov-Smirnov test*.

### Kolmogorov-Smirnov test

De *Kolmogorov-Smirnov test* toetst het verschil tussen twee verdelingen. Standaard toetst deze test het verschil tussen een normale verdeling en de verdeling van de steekproef. De Lilliefors correctie is vereist als het gemiddelde en de standaardafwijking niet van tevoren bekend of bepaald zijn, wat meestal het geval is bij een steekproef. Als de p-waarde < 0,05 is, is de verdeling van de data significant verschillend van de normale verdeling.

<!-- ## OPENBLOK: Library-nortest.R -->
```{r normaliteit, warning=FALSE}
library(nortest)
lillie.test(Jaarlijks_inkomen)
```
<!-- ## /OPENBLOK: Library-nortest.R -->
De p-waarde van de *Kolmogorov-Smirnov test* is kleiner dan 0,0001, dus de data zijn niet normaal verdeeld. Naast deze test, kan de *Shapiro-Wilk test* ook gebruikt worden om normaliteit te testen. Gebruik bij normaal verdeelde data de [one-sample t-toets](01-One-sample-t-toets-R.html).

# Tekentoets 
Voer een tweezijdige *tekentoets* uit om te bepalen of het mediane jaarinkomen van de alumni Journalistiek hoger ligt dan het modale inkomen van €36.000. Gebruik van het `DescTools` package de `SignTest()` functie met de argumenten `x = Jaarlijks_inkomen` voor de data van de steekproef, `mu = 36000` voor de waarde van de mediaan die getoetst wordt en `alternative="two.sided"` om een tweezijdige alternatieve hypothese te toetsen.

<!-- ## OPENBLOK: Tekentoets.R -->
```{r Tekentoets}
library(DescTools)
SignTest(x = Jaarlijks_inkomen, mu = 36000, alternative = "two.sided")
```
<!-- ## /OPENBLOK: Tekentoets.R -->

<!-- ## CLOSEDBLOK: Tekentoets.R -->
```{r T-test als object, echo = FALSE}
b <- SignTest(x = Jaarlijks_inkomen, mu = 36000, alternative = "two.sided")

vS <- b$statistic
vN <- b$parameter
vconf.int1 <- Round_and_format(b$conf.int[1])
vconf.int2 <- Round_and_format(b$conf.int[2])
vMed <- Round_and_format(b$estimate)
```
<!-- ## /CLOSEDBLOK: Tekentoets.R -->

<!-- ## TEKSTBLOK: Tekentoets.R -->
* De mediaan van de steekproef is significant verschillend van €36.000, *S* = `r vS`, *N* = `r vN`, *p* < 0,0001. De H~0~ wordt verworpen. [^5]
* De toetsstatistiek *S* is het aantal positieve verschillen (inkomen hoger dan modaal inkomen), *N* is het totaal aantal verschillen
* Van de `r vN` alumni verdienen `r vS` alumni boven modaal
* De geschatte mediaan van de steekproef is `r vMed` met bijbehorend 95%-betrouwbaarheidsinterval van `r vconf.int1` tot `r vconf.int2`.

<!-- ## /TEKSTBLOK: Tekentoets.R -->


# Rapportage

De *tekentoets* is uitgevoerd om te toetsen of het mediane inkomen van alumni van de opleiding Journalistiek veschilt van het modale inkomen in Nederland van €36.000. Het mediane inkomen van alumni verschilt significant van €36.000 (*S* = `r vS`, *N* = `r vN`, *p* < 0,0001). De geschatte mediaan is `r vMed` met bijbehorend 95%-betrouwbaarheidsinterval van `r vconf.int1` tot `r vconf.int2`. Van de `r vN` alumni verdienen `r vS` alumni boven modaal. Deze resultaten duiden op een verschil tussen het mediane jaarinkomen van alumni van de opleiding Journalistiek en het mediane jaarinkomen van de gemiddelde Nederlander waarbij de inkomens van de alumni hoger lijken te liggen.




<!-- ## CLOSEDBLOK: Footer.R -->
```{r footer, include = TRUE, echo = FALSE, results='asis', code =  readLines(paste0(here::here(),"/01. Includes/code/Footer.R"))}
```
<!-- ## /CLOSEDBLOK: Footer.R -->

[^1]: Van Geloven, N. (25 mei 2016). *Tekentoets* [Wiki Statistiek Academisch Medisch Centrum](https://wikistatistiek.amc.nl/index.php/Tekentoets). 
[^2]: Bruto modaal inkomen 2019, Centraal Planbureau. 
[^5]: In dit voorbeeld wordt uitgegaan van een waarschijnlijkheid van 95% c.q. een p-waardegrens van 0,05. De grens is naar eigen inzicht aan te passen; houd hierbij rekening met type I en type II fouten.
[^6]: Outliers (13 augustus 2016). [UvA Wiki Methodologiewinkel](https://wiki.uva.nl/methodologiewinkel/index.php/Outliers).
[^7]: Uitbijters kunnen bepalend zijn voor de uitkomst van toetsen. Bekijk of de uitbijters valide uitbijters zijn en niet een meetfout of op een andere manier incorrect verkregen data. Het weghalen van uitbijters kan de uitkomst ook vertekenen, daarom is het belangrijk om verwijderde uitbijters te melden in een rapport.
[^8]: Statistics How To (27 mei 2018). *One Sample Median Test*. [Statistics How to](https://www.statisticshowto.datasciencecentral.com/one-sample-median-test/).
[^9]: Onderscheidend vermogen, in het Engels power genoemd, is de kans dat de nulhypothese verworpen wordt wanneer de alternatieve hypothese waar is.
[^10]: Miller, I. & Miller, C. (2012). *John E. Freund's Mathematical Statistics with Applications*. Pearson: eighth edition.
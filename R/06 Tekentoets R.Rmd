---
title: "Tekentoets"
output:
  html_document:
    theme: lumen
    toc: yes
    toc_float: 
      collapsed: FALSE 
    number_sections: true
  keywords: [statistisch handboek, studiedata]
---

<!-- ## CLOSEDBLOK: Functies.R -->
```{r functies, include = TRUE, echo = FALSE, results='asis', warning=FALSE, message=FALSE}
library(here)
if (!exists("Substitute_var")) {
  ## Installeer packages en functies
  source(paste0(here::here(), "/99. Functies en Libraries/00. Voorbereidingen.R"), echo = FALSE)
}
```
<!-- ## /CLOSEDBLOK: Functies.R -->

<style>
`r htmltools::includeHTML(paste0(here::here(),"/01. Includes/css/Stylesheet_SHHO.css"))`
</style>

<!-- ## CLOSEDBLOK: Header.R -->
```{r header, include = TRUE, echo = FALSE, results='asis', code =  readLines(paste0(here::here(),"/01. Includes/code/Header.R"))} 
```
<!-- ## /CLOSEDBLOK: Header.R -->

<!-- ## CLOSEDBLOK: Status.R -->
```{r status, include = TRUE, echo = FALSE, results='asis', code =  readLines(paste0(here::here(),"/01. Includes/code/Status.R"))} 
```
<!-- ## /CLOSEDBLOK: Status.R -->

<!-- ## OPENBLOK: Data-aanmaken.R -->
```{r aanmaken data, include=FALSE, echo=TRUE}
source(paste0(here::here(),"/01. Includes/data/06.R"))
```
<!-- ## /OPENBLOK: Data-aanmaken.R -->
# Toepassing
Gebruik de *tekentoets* om de mediaan van een steekproef te vergelijken met een bekende mediaan of norm in de populatie.[^1] 

# Onderwijscasus
<div id ="casus">

De opleidingsdirecteur van de school voor Journalistiek is benieuwd wat alumni verdienen ten opzichte van de gemiddelde nederlander. Daarom wil zij de jaarinkomens van oud-studenten vergelijken met het modale inkomen van €36000[^2] . Op deze manier vergaart zij meer informatie over het succes op de arbeidsmarkt na de opleiding Journalistiek.

*H~0~*: De mediaan van het jaarinkomen van alumni Journalistiek is gelijk aan €36.000, het modale jaarinkomen in Nederland.

*H~A~*: De mediaan van het jaarinkomen van alumni Journalistiek is niet gelijk aan €36.000, het modale jaarinkomen in Nederland. 

</div>

# Assumpties

Er zijn geen assumpties vereist voor deze test.

# Uitvoering in R
Er is data ingeladen met jaarlijkse bruto inkomens van alumni van de school voor Journalistiek genaamd `Jaarlijks_inkomen`. De directeur wil kijken hoe zijn oud-studenten scoren ten opzichte van gemiddelde inkomens in Nederland.

## De data bekijken
<!-- ## TEKSTBLOK: Data-bekijken.R -->
Gebruik `head()` en `tail()` om de data te bekijken.
<!-- ## /TEKSTBLOK: Data-bekijken.R -->

<!-- ## OPENBLOK: Data-bekijken.R -->
```{r data bekijken, collapse = TRUE}
## Eerste 6 observaties
head(Jaarlijks_inkomen)

## Laatste 6 observaties
tail(Jaarlijks_inkomen)
```
<!-- ## /OPENBLOK: Data-bekijken.R -->

<!-- ## TEKSTBLOK: Data-beschrijven.R -->
Inspecteer de data met `mean()`, `sd()`, `median()` en `length()` om meer inzicht te krijgen in de dataa.
<!-- ## /TEKSTBLOK: Data-beschrijven.R -->

<!-- ## OPENBLOK: Data-beschrijven.R -->
```{r data beschrijven, collapse=TRUE}
mean(Jaarlijks_inkomen)
sd(Jaarlijks_inkomen)
median(Jaarlijks_inkomen)
length(Jaarlijks_inkomen)
```
<!-- ## /OPENBLOK: Data-beschrijven.R -->
<!-- ## CLOSEDBLOK: Data-beschrijven2.R -->
```{r Var beschrijven, include=FALSE, echo=TRUE}
vMean <- Round_and_format(mean(Jaarlijks_inkomen))
vSD <- Round_and_format(sd(Jaarlijks_inkomen))
vN <- Round_and_format(length(Jaarlijks_inkomen))
vMed <- Round_and_format(median(Jaarlijks_inkomen))
```
<!-- ## /CLOSEDBLOK: Data-beschrijven2.R -->

<!-- ## TEKSTBLOK: Datatekst-beschrijven2.R -->
Het gemiddelde jaarinkomen van de alumni is `r vMean` met een standaardafwijking van `r vSD` (*n* = `r vN`). De mediaan van het inkomen is `r vMed`.
<!-- ## /TEKSTBLOK: Datatekst-beschrijven2.R -->

## Normaliteit visualizeren en testen

De *tekentoets* is een alternatief voor de *one-sample t-toets* wanneer de data geen normale verdeling volgt. Hoewel het visueel inspecteren en testen van normaliteit [^3] niet vereist is, is het nuttig om de verdeling van de data te visualizeren en te vergelijken met de normaalverdeling.

### Histogram
Geef de verdeling weer in een histogram.
<!-- ## OPENBLOK: Histogram.R -->
```{r histogram, warning=FALSE, message=FALSE}
## Histogram met ggplot2
library(ggplot2)

ggplot(data.frame(Jaarlijks_inkomen), 
       aes(x = Jaarlijks_inkomen)) +
  geom_histogram(aes(y = ..density..),
                 binwidth = 10000, 
                 color = "white", 
                 fill = "#158CBA") +
  geom_density(alpha = .2, adjust = 1) +
  ylab("Frequentiedichtheid") +
  xlab("Jaarlijks_inkomen") +
scale_x_continuous(labels = as.character(seq(20000, 100000, 20000)), 
                   breaks = seq(20000, 100000, 20000)) +
labs(title = "Jaarinkomen alumni Journalistiek", 
     subtitle = "")

```
<!-- ## /OPENBLOK: Histogram.R -->

De histogram laat zien dat de verdeling een langere staart aan de rechterkant heeft en daarom enigzin afwijkt van de (symmetrische) normaalverdeling.

## Toetsen van normaliteit
Om te controleren of de data normaal verdeeld zijn, kan de normaliteit getoetst worden. Twee veelgebruikte toetsen zijn: de *Kolmogorov-Smirnov test* en de *Shapiro-Wilk test*.

### Kolmogorov-Smirnov test

De *Kolmogorov-Smirnov test* toetst het verschil tussen twee verdelingen. Standaard toetst deze test het verschil tussen een normale verdeling en de verdeling van de steekproef. De Lilliefors correctie wordt gebruikt als het gemiddelde en standaardafwijking niet van tevoren bekend of bepaald zijn. Als de p < 0,05 is, is de verdeling van de data statistisch significant verschillend van de normale verdeling.

<!-- ## OPENBLOK: Library-nortest.R -->
```{r normaliteit, warning=FALSE}
library (nortest)
lillie.test(Jaarlijks_inkomen)
```
<!-- ## /OPENBLOK: Library-nortest.R -->
De p-waarde van de Kolmogorov-Smirnov test is kleiner dan 0.05, dus de data zijn niet normaal verdeeld. Naast deze test, kan de Shapiro-Wilk test ook gebruikt worden om normaliteit te testen. Gebruik bij normaal verdeelde data de *One-sample t-toets*.

# Tekentoets 
Voer een tweezijdige *tekentoets* uit om te bepalen of het mediane jaarinkomen van de alumni Journalistiek hoger ligt dan het modale inkomen van €36.000[^2]. Dit wordt gedaan met de `binom.test` functie [^4] met de volgende argumenten: het aantal alumni dat een hoger jaarinkomen heeft dan het modale inkomen van €36.000 `boven_modaal`, het totale aantal alumni `totaal_alumni` (gelijk aan de steekproefgrootte) en `alternative="two.sided"` om een tweezijdige alternatieve hypothese te testen.

<!-- ## OPENBLOK: Tekentoets.R -->
```{r Tekentoets}
boven_modaal <- length(Jaarlijks_inkomen[Jaarlijks_inkomen > 36000])
totaal_alumni <- length(Jaarlijks_inkomen)

binom.test(boven_modaal, totaal_alumni, alternative = "two.sided")
```
<!-- ## /OPENBLOK: Tekentoets.R -->

<!-- ## CLOSEDBLOK: Tekentoets.R -->
```{r T-test als object, echo = FALSE}
boven_modaal <- length(Jaarlijks_inkomen[Jaarlijks_inkomen > 36000])
totaal_alumni <- length(Jaarlijks_inkomen)

b <- binom.test(boven_modaal, totaal_alumni, alternative = "two.sided")

vD_waarde <- Round_and_format(b$statistic)
vN <- b$parameter
vDF <- b$parameter
vconf.int1 <- Round_and_format(b$conf.int[1])
vconf.int2 <- Round_and_format(b$conf.int[2])
vProp <- Round_and_format(b$estimate)
```
<!-- ## /CLOSEDBLOK: Tekentoets.R -->

<!-- ## TEKSTBLOK: Tekentoets.R -->
* `r boven_modaal` van de `r totaal_alumni` alumni verdienen boven_modaal, dit is een proportie van `r vProp`
* p-waarde < 0,05, dus de H~0~ wordt verworpen [^4]
* 95%-betrouwbaarheidsinterval: bij het herhalen van het onderzoek zal in 95% van de gevallen de proportie in het interval vallen. In deze casus is het interval tussen `r vconf.int1` en `r vconf.int2`.

<!-- ## /TEKSTBLOK: Tekentoets.R -->


# Rapportage

De *tekentoets* is uitgevoerd om te toetsen of het mediane inkomen van alumni van de opleiding Journalistiek veschilt van het modale inkomen in Nederland van €36.000. `r boven_modaal` van de `r totaal_alumni` alumni verdienen meer dan het modale inkomen, *p* < 0,05. Deze resultaten duiden op een significant verschil tussen de inkomens van alumni van de opleiding Journalistiek en de gemiddelde nederlander waarbij de inkomens van de alumni hoger lijken te liggen.

<!-- ## CLOSEDBLOK: Footer.R -->
```{r footer, include = TRUE, echo = FALSE, results='asis', code =  readLines(paste0(here::here(),"/01. Includes/code/Footer.R"))}
```
<!-- ## /CLOSEDBLOK: Footer.R -->


[^1]: Van Geloven, N. (25 mei 2016). *Tekentoets* [Wiki Statistiek Academisch Medisch Centrum](https://wikistatistiek.amc.nl/index.php/Tekentoets). 
[^2]: Bruto modaal inkomen 2019, Centraal Planbureau. 
[^3]: Universiteit van Amsterdam (14 juli 2014). *Normaliteit*. [UvA Wiki Methodologiewinkel](https://wiki.uva.nl/methodologiewinkel/index.php/Normaliteit).  
[^4]: Wikipedia (5 februari 2020). *Sign test*. [https://en.wikipedia.org/wiki/Sign_test](https://en.wikipedia.org/wiki/Sign_test).
[^5]: In dit voorbeeld wordt uitgegaan van een waarschijnlijkheid van 95% c.q. een p-waardegrens van 0,05. De grens is naar eigen inzicht aan te passen; houd hierbij rekening met type I en type II fouten. 

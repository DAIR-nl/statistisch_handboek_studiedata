---
title: "07 Wilcoxon signed rank toets"
date: "`r format(Sys.time(), '%d-%m-%Y')`"
output:
  html_document:
    theme: lumen
    toc: yes
    toc_float: 
      collapsed: FALSE 
    number_sections: true
  keywords: [statistisch handboek, studiedata]
---

<style>
`r htmltools::includeHTML(paste0(here::here(),"/01. Includes/css/Stylesheet_SHHO.css"))`
</style>

<!-- ## CLOSEDBLOK: Header.R -->
```{r header, include = T, echo = TRUE, results='asis'} 
paste0(here::here(),"/01. Includes/code/Header.R")
```
<!-- ## /CLOSEDBLOK: Header.R -->

<!-- ## CLOSEDBLOK: Functiedefinities.R -->
```{r functiedefinities,include=FALSE, echo=TRUE}
library(stringr)
Round_and_format <- function(x, digits = 2) {
  x <- as.character(round(x, digits))
  x <- str_replace(x, "[.]", ",")
  return(x)
}
```
<!-- ## /CLOSEDBLOK: Functiedefinities.R -->

```{r opmerking, include=FALSE, eval=FALSE}
# Onderwijscasus idee 2: Beoordelen studenten opleiding X positiever nadat ze met hun tutor hebben gesproken?
```

<!-- ## OPENBLOK: Data-aanmaken.R -->
```{r aanmaken data, include=FALSE, echo=TRUE}
source(paste0(here::here(),"/01. Includes/data/07.R"))
```
<!-- ## /OPENBLOK: Data-aanmaken.R -->

# Toepassing
Gebruik de *Wilcoxon signed rank toets* om te toetsen of bij een herhaalde meting de waardes van een groep aan elkaar gelijk zijn. Een voordeel van deze test is dat het voor alle type data gebruikt kan worden.[^1]   

# Onderwijscasus
<div id ="casus">
De directeur van de Academie Mens & Maatschappij wil bekijken hoe het inkomen van zijn alumni zich ontwikkeld nadat zij zijn afgestudeerd. Hij bekijkt de maandelijke inkomens van de alumni 1 jaar na afstuderen en vergelijkt het met de inkomen 5 jaar na afstuderen. 

*H~0~*: De inkomens van de alumni van de Academie Mens & Maatschappij zijn in vier jaar tijd niet veranderd.  
*H~A~*: De inkomens van de alumni van de Academie Mens & Maatschappij zijn in vier jaar tijd veranderd.
</div>

# Assumpties
De data zijn nomimaal, ordinaal of numeriek gemeten. De *Wilcoxon Signed Rank Test* kan een alternatief zijn voor de *gepaarde t-toets*. 

De *Wilcoxon Signed Rank Test* telt geen eisen aan de data en hoeft onder andere niet te voldoen aan de assumptie normaliteit. Bij de *Wilcoxon Signed Rank Test* hebben uitbijters hebben minder invloed op het eindresultaat, dan bij de *gepaarde t-toets*. Daarentegen, als de data wel normaal verdeeld zijn, heeft de *Wilcoxon Signed Rank Test* minder onderscheidend vermogen dan de *gepaarde t-toets*.[^2]<sup>, </sup>[^3] Vandaar dat ondanks de voordelen er toch minder vaak voor de *Wilcoxon Signed Rank Test* test gekozen wordt. 

# Uitvoering
<!-- ## TEKSTBLOK: Dataset-inladen.R-->
Er is data ingeladen met jaarlijkse bruto inkomens van alumni van de Academie Mens & Maatschappij genaamd `Maandelijks_inkomen`. De directeur wil kijken hoe het inkomen van zijn alumni zich ontwikkeld 5 jaar nadat zij afgestudeerd zijn. Meetmoment T~1~ is 1 jaar na afstuderen, meetmoment T~2~ is 5 jaar na afstuderen. 
<!-- ## /TEKSTBLOK: Dataset-inladen.R-->

## De data bekijken
<!-- ## TEKSTBLOK: Data-bekijken.R -->
Gebruik `head()` en `tail()` om de structuur van de data te bekijken.
<!-- ## /TEKSTBLOK: Data-bekijken.R -->

<!-- ## OPENBLOK: Data-bekijken.R -->
```{r data bekijken, collapse = TRUE}
## Eerste 6 observaties
head(Alumni_inkomens)

## Laatste 6 observaties
tail(Alumni_inkomens)
```
<!-- ## /OPENBLOK: Data-bekijken.R -->

<!-- ## OPENBLOK: Data-selecteren.R -->
<!-- ## TEKSTBLOK: Data-beschrijven.R-->
Bekijk de grootte, de mediaan en de kwantielen van de data met `length()` en `quantile()`. 
<!-- ## /TEKSTBLOK: Data-beschrijven.R-->
<!-- ## OPENBLOK: Data-selecteren.R-->
```{r data selecteren}
Alumni_inkomens_T1 <- Alumni_inkomens$Inkomen[Alumni_inkomens$Meetmoment == "T1"]
Alumni_inkomens_T2 <- Alumni_inkomens$Inkomen[Alumni_inkomens$Meetmoment == "T2"]
```
<!-- ## /CLOSEDBLOK: Data-selecteren.R-->

<div class="col-container">
  <div class="col">
<!-- ## OPENBLOK: Data-beschrijven-1.R -->
```{r, data beschrijven 1, collapse=TRUE}
length(Alumni_inkomens_T1)
median(Alumni_inkomens_T1)
```
<!-- ## /OPENBLOK: Data-beschrijven-1.R -->
  </div>
  <div class="col">
<!-- ## OPENBLOK: Data-beschrijven-2.R -->
```{r Data beschrijven 2, collapse=TRUE}
length(Alumni_inkomens_T2)
median(Alumni_inkomens_T2)
```
<!-- ## /OPENBLOK: Data-beschrijven-2.R -->
  </div>
</div>
<!-- ## CLOSEDBLOK: Data-beschrijven-2.R -->
```{r data beschrijven als object, include=FALSE, echo=TRUE}
vMed_T1 <- median(Alumni_inkomens_T1)
vN_T1 <- length(Alumni_inkomens_T1)
vMed_T2 <- median(Alumni_inkomens_T2)
vN_T2 <- length(Alumni_inkomens_T2)
```
<!-- ## /CLOSEDBLOK: Data-beschrijven-2.R -->
<!-- ## TEKSTBLOK: Data-beschrijven.R-->
* Mediaan inkomens op T~1~: `r vMed_T1`, *n~T1~* = `r vN_T1`
* Mediaan inkomens op T~2~: `r vMed_T2`, *n~T2~* = `r vN_T2`

<!-- ## /TEKSTBLOK: Data-beschrijven.R-->

### Histogram
Geef de data visueel weer met een histogram of boxplot.
<!-- ## OPENBLOK: Histogram.R -->
```{r histogram}
## Histogram met ggplot2
library(ggplot2)

ggplot(Alumni_inkomens,
  aes(x = Inkomen)) +
  geom_histogram(binwidth = 500,
                 color = "grey30",
                 fill = "#0089CF") +
  facet_wrap(~ Meetmoment) +
  geom_density(alpha = .2, adjust = 1) +
  ylab("Frequentiedichtheid") +
  scale_x_continuous(
    labels = as.character(seq(0, 15000, 1000)),
    breaks = seq(0, 15000, 1000)) + 
  theme(axis.text.x = element_text(angle = 45)) +
  labs(title = "Maandelijkse inkomens alumni Mens & Maatschappij")
```
<!-- ## /OPENBLOK: Histogram.R -->

Op beide tijdstippen is te zien dat de meeste alumni tussen de 0 en 4.000 euro per maand verdienen en een paar alumni verdienen ver boven modaal. 

### Boxplot
De box geeft de middelste 50% van de tentamencijfers weer. De zwarte lijn binnen de box is de mediaan. In de staarten zitten de eerste 25% en de laatste 25%. Cirkels visualiseren mogelijke uitbijters.[^4] Hoe meer de boxen overlappen, hoe waarschijnlijker er geen significant verschil is tussen de groepen.  

<!-- ## OPENBLOK: Boxplot.R -->
```{r boxplot}
boxplot(Inkomen ~ Meetmoment, Alumni_inkomens,
        main = "Maandelijkse inkomens alumni Mens & Maatschappij")
```
<!-- ## /OPENBLOK: Boxplot.R -->

De boxplotten laten zien dat er op beide meetmomenten veel inkomens rondom de 2000 euro liggen. De mediaan is van T~2~ is iets hoger, maar of er een verschil is tussen beide groepen is op het oog niet te zien. Toets met de *Wilcoxon signed rang toets* of er een significant verschil is.  
In de data zitten er extremere inkomens, deze uitbijters zijn niet van invloed op de uitkomst van de *Wilcoxon signed rang toets*. 

## Wilcoxon signed rank toets
<!-- ## TEKSTBLOK: Wilcoxon-signed-rank-toets.R -->
Voer een Wilcoxon signed rank toets uit met `paired=TRUE`.
<!-- ## /TEKSTBLOK: Wilcoxon-signed-rank-toets.R -->
<!-- ## OPENBLOK: Wilcoxon-signed-rank-toets.R -->
```{r wilcox test}
wilcox.test(Alumni_inkomens_T2, Alumni_inkomens_T1, paired = TRUE, alternative = "greater")
```
<!-- ## /OPENBLOK: Wilcoxon-signed-rank-toets.R -->
<!-- ## CLOSEDBLOK: Wilcoxon-signed-rank-toets.R -->
```{r wilcox test als object, include=FALSE, echo=TRUE}
wilcox <- wilcox.test(Alumni_inkomens_T2, Alumni_inkomens_T1, paired=TRUE, alternative = "greater")
vVstatistic <- wilcox$statistic
```
<!-- ## /CLOSEDLOK: Wilcoxon-signed-rank-toets.R -->
<!-- ## TEKSTBLOK: Wilcoxon-signed-rank-toets.R -->
* *V* = `r vVstatistic`, p < 0,05  
* p-waarde < 0,05, dus de H~0~ wordt verworpen en de H~A~ wordt aangenomen[^5]

<!-- ## /TEKSTBLOK: Wilcoxon-signed-rank-toets.R -->

# Rapportage
<!-- ## TEKSTBLOK: Rapportage.R -->
De *Wilcoxon signed rank toets* is uitgevoerd om de vraag te beantwoorden of de inkomens van de alumni van de Academie Mens & Maatschappij zijn in vier jaar tijd is veranderd. De mediaan van de inkomens van 1 jaar na afstuderen: `r vMed_T1` De mediaan van de inkomens van 5 jaar na afstuderen: `r vMed_T2`, *V* = TEST, p-waarde < 0,05. Uit de resultaten kan afgelezen worden dat er een statistisch significant verschil is tussen de inkomens van de alumni van de Academie Mens & Maatschappij in vier jaar tijd is veranderd. 
<!-- ## /TEKSTBLOK: Rapportage.R -->

[^1]: Van Geloven, N. (25 september2013). *Wilcoxon signed rank toets* [Wiki Statistiek Academisch Medisch Centrum](https://wikistatistiek.amc.nl/index.php/Wilcoxon_signed_rank_toets).
[^2]: Universiteit van Amsterdam (7 juli 2014). *Kruskal-Wallis Test*. [UvA Wiki Methodologiewinkel](https://wiki.uva.nl/methodologiewinkel/index.php/Kruskal-Wallis_Test). 
[^3]: Onderscheidend vermogen: wordt in het Engels power genoemd, is de kans dat de nulhypothese verworpen wordt wanneer de alternatieve hypothese 'waar' is.  
[^4]: Outliers (13 augustus 2016). [UvA Wiki Methodologiewinkel](https://wiki.uva.nl/methodologiewinkel/index.php/Outliers).
[^5]: In dit voorbeeld wordt uitgegaan van een waarschijnlijkheid van 95% en c.q. een p-waardegrens van 0,05. De grens is naar eigen inzicht aan te passen, houd hierbij rekening met type I en type II fouten.

---
title: "Wilcoxon signed rank toets"
output:
  html_document:
    theme: lumen
    toc: yes
    toc_float: 
      collapsed: FALSE 
    number_sections: true
  keywords: [statistisch handboek, studiedata]
---

<!-- ## CLOSEDBLOK: Functies.R -->
```{r functies, include = TRUE, echo = FALSE, results='asis', warning=FALSE, message=FALSE}
library(here)
if (!exists("Substitute_var")) {
  ## Installeer packages en functies
  source(paste0(here::here(), "/99. Functies en Libraries/00. Voorbereidingen.R"), echo = FALSE)
}
```
<!-- ## /CLOSEDBLOK: Functies.R -->

<style>
`r htmltools::includeHTML(paste0(here::here(),"/01. Includes/css/Stylesheet_SHHO.css"))`
</style>

<!-- ## CLOSEDBLOK: Header.R -->
```{r header, include = TRUE, echo = FALSE, results='asis', code =  readLines(paste0(here::here(),"/01. Includes/code/Header.R"))} 
```
<!-- ## /CLOSEDBLOK: Header.R -->

```{r opmerking, include=FALSE, eval=FALSE}
# Onderwijscasus idee 2: Beoordelen studenten opleiding X positiever nadat ze met hun tutor hebben gesproken?
```

<!-- ## OPENBLOK: Data-aanmaken.R -->
```{r aanmaken data, include=FALSE, echo=TRUE}
source(paste0(here::here(),"/01. Includes/data/07.R"))
```
<!-- ## /OPENBLOK: Data-aanmaken.R -->

# Toepassing
Gebruik de *Wilcoxon signed rank toets* om te toetsen of bij een herhaalde meting de waardes van een groep van elkaar verschillen.[^1]   

# Onderwijscasus
<div id ="casus">
De directeur van de Academie Mens & Maatschappij wil bekijken hoe het inkomen van zijn alumni zich ontwikkeld nadat zij zijn afgestudeerd. Hij verwacht dat er na vijf jaar een groei te zien is in de inkomens. Hij bekijkt de maandelijke inkomens van de alumni 1 jaar na afstuderen en vergelijkt het met de inkomen 5 jaar na afstuderen. 

*H~0~*: De inkomens van de alumni van de Academie Mens & Maatschappij zijn in vier jaar tijd verminderd of gelijk gebleven.  
*H~A~*: De inkomens van de alumni van de Academie Mens & Maatschappij zijn in vier jaar tijd gestegen. 
</div>

# Assumpties
De data zijn (semi)continu.[^2] De *Wilcoxon Signed Rank Test* kan een alternatief zijn voor de *gepaarde t-toets*. 

Er zijn een aantal voordelen van de *Wilcoxon Signed Rank Test*, bijvoorbeeld, de data hoeven niet aan de assumptie van normaliteit te voldoen. Daarentegen, als de data wel normaal verdeeld zijn, heeft de *Wilcoxon Signed Rank Test* minder onderscheidend vermogen dan de *gepaarde t-toets*.[^3]<sup>, </sup>[^4] Vandaar dat ondanks de voordelen er toch minder vaak voor de *Wilcoxon Signed Rank Test* test gekozen wordt. 

# Uitvoering
<!-- ## TEKSTBLOK: Dataset-inladen.R-->
Er is data ingeladen met jaarlijkse bruto inkomens van alumni van de Academie Mens & Maatschappij genaamd `Maandelijks_inkomen`. De directeur wil kijken hoe het inkomen van zijn alumni zich ontwikkeld 4 jaar nadat zij afgestudeerd zijn. Meetmoment T~1~ is 1 jaar na afstuderen, meetmoment T~2~ is 5 jaar na afstuderen. 
<!-- ## /TEKSTBLOK: Dataset-inladen.R-->

## De data bekijken
<!-- ## TEKSTBLOK: Data-bekijken.R -->
Gebruik `head()` en `tail()` om de structuur van de data te bekijken.
<!-- ## /TEKSTBLOK: Data-bekijken.R -->

<!-- ## OPENBLOK: Data-bekijken.R -->
```{r data bekijken, collapse = TRUE}
## Eerste 6 observaties
head(Alumni_inkomens)

## Laatste 6 observaties
tail(Alumni_inkomens)
```
<!-- ## /OPENBLOK: Data-bekijken.R -->

<!-- ## OPENBLOK: Data-selecteren.R -->
<!-- ## TEKSTBLOK: Data-beschrijven.R-->
Bekijk de grootte, de mediaan en de kwantielen van de data met `length()` en `quantile()`. 
<!-- ## /TEKSTBLOK: Data-beschrijven.R-->
<!-- ## OPENBLOK: Data-selecteren.R-->
```{r data selecteren}
Alumni_inkomens_T1 <- Alumni_inkomens$Inkomen[Alumni_inkomens$Meetmoment == "T1"]
Alumni_inkomens_T2 <- Alumni_inkomens$Inkomen[Alumni_inkomens$Meetmoment == "T2"]
```
<!-- ## /OPENBLOK: Data-selecteren.R-->

<div class="col-container">
  <div class="col">
<!-- ## OPENBLOK: Data-beschrijven-1.R -->
```{r, data beschrijven 1, collapse=TRUE}
length(Alumni_inkomens_T1)
median(Alumni_inkomens_T1)
```
<!-- ## /OPENBLOK: Data-beschrijven-1.R -->
  </div>
  <div class="col">
<!-- ## OPENBLOK: Data-beschrijven-2.R -->
```{r Data beschrijven 2, collapse=TRUE}
length(Alumni_inkomens_T2)
median(Alumni_inkomens_T2)
```
<!-- ## /OPENBLOK: Data-beschrijven-2.R -->
  </div>
</div>
<!-- ## CLOSEDBLOK: Data-beschrijven-2.R -->
```{r data beschrijven als object, include=FALSE, echo=TRUE}
vMed_T1 <- median(Alumni_inkomens_T1)
vN_T1 <- length(Alumni_inkomens_T1)
vMed_T2 <- median(Alumni_inkomens_T2)
vN_T2 <- length(Alumni_inkomens_T2)
```
<!-- ## /CLOSEDBLOK: Data-beschrijven-2.R -->
<!-- ## TEKSTBLOK: Data-beschrijven.R-->
* Mediaan inkomens op T~1~: `r vMed_T1` 
* Mediaan inkomens op T~2~: `r vMed_T2` 
* Aangezien de gegevens gepaard zijn, zijn de groepsgrootes op beide meetmomenten gelijk: *n~T1~* = `r vN_T1` en *n~T2~* = `r vN_T2`
<!-- ## /TEKSTBLOK: Data-beschrijven.R-->

### Histogram
Geef de data visueel weer met een histogram of boxplot.
<!-- ## OPENBLOK: Histogram.R -->
```{r histogram}
## Histogram met ggplot2
library(ggplot2)

ggplot(Alumni_inkomens,
  aes(x = Inkomen)) +
  geom_histogram(binwidth = 500,
                 color = "grey30",
                 fill = "#0089CF") +
  facet_wrap(~ Meetmoment) +
  geom_density(alpha = .2, adjust = 1) +
  ylab("Frequentiedichtheid") +
  scale_x_continuous(
    labels = as.character(seq(0, 15000, 1000)),
    breaks = seq(0, 15000, 1000)) + 
  theme(axis.text.x = element_text(angle = 45)) +
  labs(title = "Maandelijkse inkomens alumni Mens & Maatschappij")
```
<!-- ## /OPENBLOK: Histogram.R -->

Op beide tijdstippen is te zien dat de meeste alumni tussen de 0 en 4.000 euro per maand verdienen en een paar alumni verdienen ver boven modaal. 

### Boxplot
De box geeft de middelste 50% van de tentamencijfers weer. De zwarte lijn binnen de box is de mediaan. In de staarten zitten de eerste 25% en de laatste 25%. Cirkels visualiseren mogelijke uitbijters, echter uitbijters zijn niet direct van invloed op de uitkomst van de *Wilcoxon signed rang toets*.[^5] Hoe meer de boxen overlappen, hoe waarschijnlijker dat er geen significant verschil is tussen de groepen.  

<!-- ## OPENBLOK: Boxplot.R -->
```{r boxplot}
boxplot(Inkomen ~ Meetmoment, Alumni_inkomens,
        main = "Maandelijkse inkomens alumni Mens & Maatschappij")
```
<!-- ## /OPENBLOK: Boxplot.R -->

De boxplotten laten zien dat er op beide meetmomenten veel inkomens rondom de 2000 euro liggen. De mediaan is van T~2~ is iets hoger dan van T~1~, dus op T~2~ lijken de alumni meer te verdienen, maar of er een significant verschil is tussen beide meetmomenten is op het oog niet te zien. Toets met de *Wilcoxon signed rang toets* of er een significant verschil is tussen de meetmomenten. 

## Wilcoxon signed rank toets
<!-- ## TEKSTBLOK: Wilcoxon-signed-rank-toets.R -->
Voer een *Wilcoxon signed rank toets* uit. Om aan te geven dat de twee meetmomenten aan elkaar gepaard zijn gebruik het argument `paired = TRUE`. De *Wilcoxon signed rank toets* wordt uitgevoerd om de vraag te beantwoorden of de inkomens van alumni in vier jaar significant gestegen zijn. Er wordt eenzijdig getoetst omdat er een duidelijke verwachting is, gebruik het argument `alternative = "greater"`. 
<!-- ## /TEKSTBLOK: Wilcoxon-signed-rank-toets.R -->

<!-- ## OPENBLOK: Wilcoxon-signed-rank-toets.R -->
```{r wilcox test}
wilcox.test(Alumni_inkomens_T2, Alumni_inkomens_T1, paired = TRUE, alternative = "greater")
```
<!-- ## /OPENBLOK: Wilcoxon-signed-rank-toets.R -->
<!-- ## CLOSEDBLOK: Wilcoxon-signed-rank-toets.R -->
```{r wilcox test als object, include=FALSE, echo=TRUE}
wilcox <- wilcox.test(Alumni_inkomens_T2, Alumni_inkomens_T1, paired=TRUE, alternative = "greater")
vVstatistic <- Round_and_format(wilcox$statistic)
```
<!-- ## /CLOSEDBLOK: Wilcoxon-signed-rank-toets.R -->
<!-- ## TEKSTBLOK: Wilcoxon-signed-rank-toets.R -->
* *V* = `r vVstatistic`, p < 0,05  
* p-waarde < 0,05, dus de H~0~ wordt verworpen en de H~A~ wordt aangenomen[^6]

<!-- ## /TEKSTBLOK: Wilcoxon-signed-rank-toets.R -->

# Rapportage
<!-- ## TEKSTBLOK: Rapportage.R -->
De *Wilcoxon signed rank toets* is uitgevoerd om de vraag te beantwoorden of de inkomens van de alumni van de Academie Mens & Maatschappij in vier jaar tijd is gestegen. De mediaan van de inkomens van 1 jaar na afstuderen is `r vMed_T1` per maand. De mediaan van de inkomens van 5 jaar na afstuderen is `r vMed_T2` per maand. Uit de resultaten kan afgelezen worden dat er een statistisch significant verschil is tussen de inkomens van de alumni van de Academie Mens & Maatschappij bij T~0~ en T~1~, *V* = `r vVstatistic`, *p* < 0,05.
<!-- ## /TEKSTBLOK: Rapportage.R -->

<!-- ## CLOSEDBLOK: Footer.R -->
```{r footer, include = TRUE, echo = FALSE, results='asis', code =  readLines(paste0(here::here(),"/01. Includes/code/Footer.R"))}
```
<!-- ## /CLOSEDBLOK: Footer.R -->

[^1]: Van Geloven, N. (25 september2013). *Wilcoxon signed rank toets* [Wiki Statistiek Academisch Medisch Centrum](https://wikistatistiek.amc.nl/index.php/Wilcoxon_signed_rank_toets).
[^2]: *Semi-continue data*: de data zijn discreet, bijvoorbeeld gehele getallen, met zoveel mogelijkheden dat de data geanalyseerd kunnen worden alsof ze continu zijn.  
[^3]: Universiteit van Amsterdam (7 juli 2014). *Kruskal-Wallis Test*. [UvA Wiki Methodologiewinkel](https://wiki.uva.nl/methodologiewinkel/index.php/Kruskal-Wallis_Test). 
[^4]: Onderscheidend vermogen: wordt in het Engels power genoemd, is de kans dat de nulhypothese verworpen wordt wanneer de alternatieve hypothese 'waar' is.  
[^5]: Outliers (13 augustus 2016). [UvA Wiki Methodologiewinkel](https://wiki.uva.nl/methodologiewinkel/index.php/Outliers).
[^6]: In dit voorbeeld wordt uitgegaan van een waarschijnlijkheid van 95% en c.q. een p-waardegrens van 0,05. De grens is naar eigen inzicht aan te passen, houd hierbij rekening met type I en type II fouten.

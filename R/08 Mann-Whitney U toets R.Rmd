---
title: "Mann-Whitney U toets"
author: "© `r format(Sys.time(), '%Y')`, SURF Versnellingsagenda - Statistisch Handboek Hoger Onderwijs"
date: "`r format(Sys.time(), '%d-%m-%Y')`"
output:
  html_document:
    theme: lumen
    toc: yes
    toc_float: 
      collapsed: FALSE 
    number_sections: true
  keywords: [statistisch handboek, studiedata]
---

<style>
`r htmltools::includeHTML(paste0(here::here(),"/01. Includes/css/Stylesheet_SHHO.css"))`
</style>

<!-- ## CLOSEDBLOK: Header.R -->
```{r header, include = FALSE, echo = TRUE, results='asis'} 
paste0(here::here(),"/01. Includes/code/Header.R")
```
<!-- ## /CLOSEDBLOK: Header.R -->

<!-- ## CLOSEDBLOK: Functiedefinities.R -->
```{r functiedefinities,include=FALSE, echo=TRUE}
library(stringr)
Round_and_format <- function(x, digits = 2) {
  x <- as.character(round(x, digits))
  x <- str_replace(x, "[.]", ",")
  return(x)
}

Round_and_format_0decimals <- function(x, digits = 0) {
  x <- as.character(round(x, digits))
  x <- str_replace(x, "[.]", ",")
  return(x)
}
```
<!-- ## /CLOSEDBLOK: Functiedefinities.R -->

<!-- ## OPENBLOK: Data-aanmaken.R -->
```{r aanmaken data, include=FALSE, echo=TRUE}
source(paste0(here::here(),"/01. Includes/data/07.R"))
```
<!-- ## /OPENBLOK: Data-aanmaken.R -->
# Toepassing
Gebruik de *Mann-Whitney U toets* om te toetsen of twee onafhankelijke groepen significant van elkaar verschillen. 

Deze toets wordt ook *Mann–Whitney–Wilcoxon*, *Wilcoxon rank-sum toets*, of *Wilcoxon–Mann–Whitney toets* genoemd.[^1] Niet te verwarren met de *Wilcoxon Signed Rank Test* die toets of twee afhankelijke groepen significant van elkaar verschillen. 

De *Mann-Whitney U toets* kan een alternatief zijn voor de *ongepaarde t-toets*. De *Mann-Whitney U toets* stelt minder eisen aan de data en hoeft onder andere niet te voldoen aan de assumptie van normaliteit. Bij de *Mann-Whitney U toets* hebben uitbijters hebben minder invloed op het eindresultaat dan bij de *ongepaarde t-toets*. Daarentegen, als de data wel normaal verdeeld zijn heeft de *Mann-Whitney U toets* minder onderscheidend vermogen dan de *ongepaarde t-toets*.[^2] Vandaar dat ondanks de voordelen er toch minder vaak voor de *Mann-Whitney U toets* test gekozen wordt. 

# Onderwijscasus
<div id ="casus">
De directeur van een hogeschool vraagt zich af wat de invloed is van internationalisering op zijn instelling. Om uitval een minder grote rol te laten spelen gebruikt hij hiervoor het totaal aantal punten behaald in het tweedejaar. Hij vraagt af: ‘Is het behaald aantal EC in het tweede jaar van internationale studenten anders is dan van de Nederlandse studenten?’ 

*H~0~*: Het behaalde aantal EC in het tweede jaar van internationale studenten is hetzelfde als van Nederlandse studenten. 

*H~A~*: Het behaalde aantal EC in het tweede jaar van internationale studenten is anders als van Nederlandse studenten.
</div>

# Assumpties
 Voor een valide resultaat moeten de data aan een aantal voorwaarden voldoen voordat de toets uitgevoerd kan worden: de data zijn nomimaal, ordinaal of numeriek. De groepen zijn onafhankelijk van elkaar [^3] en het aantal groepen is 2. Gebruik bij > 2 groepen de *Kruskal Wallis toets*.

# Uitvoering 
<!-- ## TEKSTBLOK: Dataset-inladen.R-->
Er is data ingeladen met het aantal punten dat studenten in het tweede jaar halen. `Punten_jaar2_NL` bevat Nederlandse studenten, `Punten_jaar2_inter` bevat internationale studenten. 
<!-- ## /TEKSTBLOK: Dataset-inladen.R-->

## De data bekijken
<!-- ## TEKSTBLOK: Data-bekijken.R -->
Gebruik `head()` en `tail()` om de structuur van de data te bekijken.
<!-- ## /TEKSTBLOK: Data-bekijken.R -->
<!-- ## OPENBLOK: Data-bekijken.R -->
```{r data bekijken, collapse = TRUE}
## Eerste 6 observaties
head(Punten_jaar2)
## Eerste 6 observaties
tail(Punten_jaar2)
```
<!-- ## /OPENBLOK: Data-bekijken.R -->
<!-- ## TEKSTBLOK: Data-beschrijven.R -->
Bekijk de grootte, de mediaan en de kwantielen van de data met `length()` en `quantile()`.
<!-- ## /TEKSTBLOK: Data-beschrijven.R -->
<!-- ## OPENBLOK: Data-selecteren.R -->
```{r data selecteren}
Nederlands <- Punten_jaar2$Nederlands == "ja"
```
<!-- ## /OPENBLOK: Data-selecteren.R -->

<div class="col-container">
  <div class="col">
<!-- ## OPENBLOK: Data-beschrijven-1.R -->
```{r, data beschrijven 1, collapse=TRUE}
length(Punten_jaar2$EC_Jaar2[Nederlands])
quantile(Punten_jaar2$EC_Jaar2[Nederlands])
```
<!-- ## /OPENBLOK: Data-beschrijven-1.R -->
  </div>
  <div class="col">
<!-- ## OPENBLOK: Data-beschrijven-2.R -->
``````{r Data beschrijven 2, collapse=TRUE}
length(Punten_jaar2$EC_Jaar2[!Nederlands])
quantile(Punten_jaar2$EC_Jaar2[!Nederlands])
```
<!-- ## /OPENBLOK: Data-beschrijven-2.R -->
  </div>
</div>
<!-- ## CLOSEDBLOK: Data-beschrijven.R -->
``` {r data beschrijven als object, include=FALSE, echo=TRUE}
## Onderstaand zijn de dynamische variabelen te vinden
library(dplyr)

x <- group_by(Punten_jaar2, Nederlands) %>%
  summarise(
    N = n(),
    Q1 = quantile(EC_Jaar2)[2],
    Mediaan = median(EC_Jaar2),
    Q3 = quantile(EC_Jaar2)[4]
  )

vN_NL <- Round_and_format(x[1,2])
vN_Inter <- Round_and_format(x[2,2])

vQ1_NL <- Round_and_format(x[1,3])
vQ1_Inter <- Round_and_format(x[2,3])

vMed_NL <- Round_and_format(x[1,4])
vMed_Inter <- Round_and_format(x[2,4])

vQ3_NL <- Round_and_format(x[1,5])
vQ3_Inter <- Round_and_format(x[2,5])
```
<!-- ## /CLOSEDBLOK: Data-beschrijven.R -->
<!-- ## TEKSTBLOK: Data-beschrijven2.R -->
* Mediaan Nederlandse studenten: `r vMed_NL`. *n* = `r vN_NL`.
* Mediaan internationale studenten: `r vMed_Inter`. *n* = `r vN_Inter`.

<!-- ## /TEKSTBLOK: Data-beschrijven2.R -->

## Mann-Whitney U toets
Gebruik `wilcox.test()` met twee argumenten om een Mann-Whitney U toets te doen in R.
<!-- ## OPENBLOK: Mann-Whitney-U-toets.R -->
```{r Mann Whitney U toets}
wilcox.test(Punten_jaar2$EC_Jaar2[Nederlands], 
            Punten_jaar2$EC_Jaar2[!Nederlands])
```
<!-- ## /OPENBLOK: Mann-Whitney-U-toets.R -->
<!-- ## CLOSEDBLOK: Mann-Whitney-U-toets.R -->
```{r Mann Whitney U toets als object, include = FALSE}
wcx <- wilcox.test(Punten_jaar2$EC_Jaar2[Nederlands],
                   Punten_jaar2$EC_Jaar2[!Nederlands])
vW_W <- Round_and_format_0decimals(wcx$statistic)
vW_P <- Round_and_format(wcx$p.value)
```
<!-- ## /CLOSEDBLOK: Mann-Whitney-U-toets.R -->
<!-- ## TEKSTBLOK: Mann-Whitney-U-toets.R -->
* *W* = `r vW_W`, *p* = `r vW_P`
* p-waarde > 0,05, dus de H~0~ wordt niet verworpen.[^4]

<!-- ## /TEKSTBLOK: Mann-Whitney-U-toets.R -->


# Rapportage
<!-- ## /TEKSTBLOK: Rapportage.R -->
De *Mann-Whitney U toets* is uitgevoerd om te toetsen of het behaalde aantal EC in het tweede jaar hetzelfde is van internationale studenten als van Nederlandse studenten. Uit de resultaten kan afgelezen worden dat er geen statistisch significant verschil is tussen het aantal studiepunten van internationale studenten als van Nederlandse studenten. *W* = `r vW_W`, p-waarde < 0,05. 
<!-- ## /TEKSTBLOK: Rapportage.R -->
 
[^1]: Van Geloven, N. (13 maart 2018). *Mann-Whitney U toets*. [Wiki Statistiek Academisch Medisch Centrum](https://wikistatistiek.amc.nl/index.php/Mann-Whitney_U_toets).
[^2]: Onderscheidend vermogen: wordt in het Engels power genoemd, is de kans dat de nulhypothese verworpen wordt wanneer de alternatieve hypothese 'waar' is.  
[^3]: Elke groep heeft geen overlap met één van de andere groepen en de groepen kunnen elkaars deelname niet beïnvloeden. Deze stap wordt beredeneerd en wordt niet getoetst.  
[^4]: In dit voorbeeld wordt uitgegaan van een waarschijnlijkheid van 95% en c.q. een p-waardegrens van 0,05. De grens is naar eigen inzicht aan te passen, houd hierbij rekening met type I en type II fouten.
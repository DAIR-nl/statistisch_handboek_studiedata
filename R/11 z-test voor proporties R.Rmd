---
title: "Chi-kwadraat toets en binomiaaltoets"
output:
  html_document:
    theme: lumen
    toc: yes
    toc_float: 
      collapsed: FALSE 
    number_sections: true
  keywords: [statistisch handboek, studiedata]
---
<!-- ## CLOSEDBLOK: Functies.R -->
```{r functies, include = TRUE, echo = FALSE, results='asis', warning=FALSE, message=FALSE}
library(here)
if (!exists("Substitute_var")) {
  ## Installeer packages en functies
  source(paste0(here::here(), "/99. Functies en Libraries/00. Voorbereidingen.R"), echo = FALSE)
}
```
<!-- ## /CLOSEDBLOK: Functies.R -->

<style>
`r htmltools::includeHTML(paste0(here::here(),"/01. Includes/css/Stylesheet_SHHO.css"))`
</style>

<!-- ## CLOSEDBLOK: Header.R -->
```{r header, include = TRUE, echo = FALSE, results='asis', code =  readLines(paste0(here::here(),"/01. Includes/code/Header.R"))} 
```
<!-- ## /CLOSEDBLOK: Header.R -->

<!-- ## CLOSEDBLOK: Status.R -->
```{r status, include = TRUE, echo = FALSE, results='asis', code =  readLines(paste0(here::here(),"/01. Includes/code/Status.R"))} 
```
<!-- ## /CLOSEDBLOK: Status.R -->

<!-- ## OPENBLOK: Data-aanmaken.R -->
```{r aanmaken data, include=FALSE, echo=TRUE}
source(paste0(here::here(),"/01. Includes/data/11.R"))
```
<!-- ## /OPENBLOK: Data-aanmaken.R -->
# Toepassing

Gebruik de *Chi-kwadraat toets* bij het vergelijken van een geobserveerd percentage met een referentiewaarde voor dit percentage, zoals een bekend of verwacht percentage. Gebruik de exacte *binomiaaltoets* bij een kleine steekproef.[^2] 




# Onderwijscasus
<div id = "casus">
De controller van een Universiteit is geïnteresseerd in de instroom van studenten met een hbo-achtergrond. Zij wil weten of haar Universiteit relatief veel studenten met een achtergrond in het hbo heeft in vergelijking met het landelijke gemiddelde. Op de website van de VSNU vindt ze dat studenten met een hbo-achtergrond in het hbo 11,13% uitmaken van de totale instroom voor Bachelors en Masters in het wetenschappelijk onderwijs (wo) in 2018.[^3] Ze wil weten of er op haar instelling naar verhouiding meer hbo-studenten zijn dan het landelijk gemiddelde. 

H~0~: Het percentage hbo-studenten is gelijk aan het landelijk percentage van 11,13 %. 

H~A~: Het percentage hbo-studenten verschilt van het landelijk percentage van 11,13 %.
</div>

# Assumpties

Om de *Chi-kwadraat toets* uit te voeren, moet de variabele binair[^4] zijn. Daarnaast moeten de categorieën niet overlappen, wat wil zeggen dat elke observatie slechts in een van beide categorieën past. Het aantal observaties in beide categorieën moet hoger dan 10 zijn, gebruik de *binomiaaltoets* als dit niet het geval is.[^5]




# De data bekijken

<!-- ## TEKSTBLOK: Data-bekijken1.R -->
Er is een dataset ingeladen genaamd `Instroom_2018_totaal`. Dit is een dataframe met studentnummers is een binaire variabele die laat zien of de student een hbo-achtergrond heeft.
<!-- ## /TEKSTBLOK: Data-bekijken1.R -->

<!-- ## OPENBLOK: Data-bekijken2.R -->
```{r data bekijken, collapse=TRUE}
## Eerste 6 observaties
head(Instroom_2018_totaal)
## Laatste 6 observaties
tail(Instroom_2018_totaal)
```
<!-- ## /OPENBLOK: Data-bekijken2.R -->

Het is informatief om het percentage studenten met hbo-achtergrond in de data te bepalen.

<!-- ## OPENBLOK: Data-bekijken3.R -->
```{r percentage berekenen}
percentage <- 100 * sum(Instroom_2018_totaal$hbo_achtergrond=="ja")/length(Instroom_2018_totaal$hbo_achtergrond)
print(percentage)
```
<!-- ## /OPENBLOK: Data-bekijken3.R -->

<!-- ## TEKSTBLOK: Data-bekijken4.R -->
Het percentage studenten met hbo-achtergrond is `r Round_and_format(percentage)`. Dit percentage lijkt hoger te liggen dan het landelijk percentage van 11,13 %. De *Chi-kwadraat toets* of de *binomiaaltoets* toetst of dit verschil significant is.
<!-- ## /TEKSTBLOK: Data-bekijken4.R -->

# Chi-kwadraat toets

## Uitvoering

Voer de *Chi-kwadraat toets*  uit om te onderzoeken of het percentage studenten met hbo-achtergrond verschilt van het landelijk percentage van 11,13 %.

<!-- ## TEKSTBLOK: Chi-kwadraat1.R -->
Gebruik de functie `prop.test()` met argument  `x =` voor de hoeveelheid studenten met een hbo achtergrond, `n =` voor de totale instroom van de universiteit, `p =` voor de referentieproportie en `alternative =` voor het soort toets (eenzijdig of tweezijdig).
<!-- ## /TEKSTBLOK: Chi-kwadraat1.R -->


<!-- ## OPENBLOK: Chi-kwadraat2.R-->
```{r chi-kwadraat}
prop.test(x = length(Instroom_2018_totaal$hbo_achtergrond[Instroom_2018_totaal$hbo_achtergrond == "ja"]), 
          n = length(Instroom_2018_totaal$hbo_achtergrond), 
          p = 0.1113,
          alternative = "two.sided")
```
<!-- ## /OPENBLOK: Chi-kwadraat2.R-->

<!-- ## CLOSEDBLOK: Chi-kwadraat3.R-->
```{r chi-kwadraat verstopt, include=FALSE, echo=TRUE}
chi2 <- prop.test(x = length(Instroom_2018_totaal$hbo_achtergrond[Instroom_2018_totaal$hbo_achtergrond == "ja"]), 
          n = length(Instroom_2018_totaal$hbo_achtergrond), 
          p = 0.1113,
          alternative = "two.sided")

vchi2 <- Round_and_format(chi2$statistic)
vp <- Round_and_format(chi2$p.value)
vdf <- chi2$parameter
vest <- Round_and_format(chi2$estimate)
vlb <-  Round_and_format(chi2$conf.int[1])
vub <-  Round_and_format(chi2$conf.int[2])
```
<!-- ## /CLOSEDBLOK: Chi-kwadraat3.R-->

<!-- ## TEKSTBLOK: Chi-kwadraat4.R-->
* $\chi^2$~`r vdf`~ = `r vchi2`, *p* < 0,0001
* p-waarde < 0,05, dus de H~0~ wordt verworpen.[^6]
* de geschatte proportie in de data is `r vest`, het 95-% betrouwbaarheidsinterval loopt van `r vlb` tot `r vub`

<!-- ## /TEKSTBLOK: Chi-kwadraat4.R-->



## Rapportage
<!-- ## TEKSTBLOK: Chi-kwadraat5.R-->
De *Chi-kwadraat toets* is uitgevoerd om te onderzoeken of het percentage studenten met een hbo-achtergrond verschilt van het landelijk percentage van 11,13 %. Het percentage hbo-studenten is significant verschillend van 11,13 % ($\chi^2$~`r vdf`~ = `r vchi2`, *p* < 0,0001), dus de nulhypothese kan verworpen worden. De schatting van het percentage is `r vest` met een 95-% betrouwbaarheidsinterval van `r vlb` tot `r vub` en ligt hoger dan het landelijk gemiddelde van 11,13 %.

<!-- ## /TEKSTBLOK: Chi-kwadraat5.R-->



# Binomiaaltoets

## Uitvoering

<!-- ## TEKSTBLOK: Binomiaaltoets1.R -->
Voer de *binomiaaltoets*  uit om te bepalen of er verschillen zijn tussen het percentage studenten met een hbo-achtergrond en het landelijk percentage van 11,13 %. Deze toets is een alternatief voor de *Chi-kwadraat toets* bij lage aantallen observaties. Er is een subset `Instroom_2018_totaal_steekproef` van de dataset ingeladen `Instroom_2018_totaal` met daarin een lager aantal observaties.

Maak een tabel van de variabele `hbo_achtergrond` om het aantal observaties per categorie te tellen.
<!-- ## /TEKSTBLOK: Binomiaaltoets1.R -->

<!-- ## OPENBLOK: Binomiaaltoets2.R -->
```{r tabel}
table(Instroom_2018_totaal_steekproef$hbo_achtergrond)

```
<!-- ## /OPENBLOK: Binomiaaltoets2.R -->

<!-- ## TEKSTBLOK: Binomiaaltoets3.R -->
Het aantal studenten met een hbo-achtergrond is `r table(Instroom_2018_totaal_steekproef$hbo_achtergrond)[1]` en het aantal zonder hbo-achtergrond `r table(Instroom_2018_totaal_steekproef$hbo_achtergrond)[2]`. Voer de *binomiaaltoets* uit, aangezien het aantal studenten met hbo-achtergrond lager dan 10 is.
<!-- ## /TEKSTBLOK: Binomiaaltoets3.R -->

<!-- ## TEKSTBLOK: Binomiaaltoets4.R -->
Tel eerst het aantal studenten met ee hbo-achtergrond in de dataset. Voer daarna de *binomiaaltoets* uit met de functie `binom.test()` en met argument  `x =` voor de hoeveelheid studenten met een hbo achtergrond, `n =` voor de totale instroom van de universiteit, `p =` voor de referentieproportie,  `alternative =` voor het soort toets (eenzijdig of tweezijdig) en `conf.level` om het significantieniveau aan te geven.
<!-- ## /TEKSTBLOK: Binomiaaltoets4.R -->


<!-- ## OPENBLOK: Binomiaaltoets5.R -->
```{r Tekentoets}
Aantal_studenten_hbo_achtergrond <- length(Instroom_2018_totaal_steekproef$hbo_achtergrond[Instroom_2018_totaal_steekproef$hbo_achtergrond == "ja"])

binom.test(x = Aantal_studenten_hbo_achtergrond, 
          n = length(Instroom_2018_totaal_steekproef$hbo_achtergrond), 
          p = 0.1113, alternative = "two.sided",conf.level = 0.95)
```
<!-- ## /OPENBLOK: Binomiaaltoets5.R -->

<!-- ## CLOSEDBLOK: Binomiaaltoets6.R -->
```{r T-test als object, echo = FALSE}
Aantal_studenten_hbo_achtergrond <- length(Instroom_2018_totaal_steekproef$hbo_achtergrond[Instroom_2018_totaal_steekproef$hbo_achtergrond == "ja"])

b <- binom.test(x = Aantal_studenten_hbo_achtergrond, 
          n = length(Instroom_2018_totaal_steekproef$hbo_achtergrond), 
          p = 0.1113, 
          alternative = "two.sided",
          conf.level = 0.95)

baantal <- Round_and_format(b$statistic)
btotaal <- b$parameter
bp <- Round_and_format(b$p.value)
blb <- Round_and_format(b$conf.int[1])
bub <- Round_and_format(b$conf.int[2])
bprop <- Round_and_format(b$estimate)
```
<!-- ## /CLOSEDBLOK: Binomiaaltoets6.R -->

<!-- ## TEKSTBLOK: Binomiaaltoets7.R-->
* de geschatte proportie in de data is `r bprop`, het 95-% betrouwbaarheidsinterval loopt van `r blb` tot `r bub`
* p-waarde = `r bp`, dus de H~0~ kan niet worden verworpen.[^6]  

<!-- ## /TEKSTBLOK: Binomiaaltoets7.R-->


## Rapportage

<!-- ## TEKSTBLOK: Binomiaaltoets8.R-->
De *binomiaaltoets* is uitgevoerd om te onderzoeken of het percentage studenten met een hbo-achtergrond verschilt van het landelijk percentage van 11,13 % voor een dataset met een laag aantal observaties. Het percentage hbo-studenten is niet significant verschillend van 11,13 % (*p* = `r bp`), dus de nulhypothese kan niet verworpen worden. De schatting van het percentage is `r bprop` met een 95-% betrouwbaarheidsinterval van `r blb` tot `r bub` en is niet significant verschillend van het landelijk gemiddelde van 11,13 %.

<!-- ## /TEKSTBLOK: Binomiaaltoets8.R-->




<!-- ## CLOSEDBLOK: Footer.R -->
```{r footer, include = TRUE, echo = FALSE, results='asis', code =  readLines(paste0(here::here(),"/01. Includes/code/Footer.R"))}
```
<!-- ## /CLOSEDBLOK: Footer.R -->

[^2]: Agresti, A. (2003). *Categorical data analysis*. Vol. 482, John Wiley & Sons.
[^3]: Het percentage is een berekening op basis van cijfers van de Vereniging van Universiteiten (VSNU). In 2018 zijn er 102.147 studenten ingestroomd in Universitaire Bachelors en Masters. In dat zelfde jaar stroomden bij de universiteiten 11.374 studenten met een hbo achtergrond in. Deze studenten maken dus 11,13% uit van de totale instroom.  Deze cijfers zijn respectievelijk te vinden in de volgende website en publicatie: Vereniging van Universiteiten (2019). *Downloadbare tabellen Studenten*. Opgehaald van de website van de VSNU: https://www.vsnu.nl/nl_NL/f_c_studenten_downloads.html. Vereniging van Universiteiten (2019). *Factsheet - Nederlandse Universiteiten Zijn Toegankelijk*. Opgehaald van de website van de VSNU: https://www.vsnu.nl/files/documenten/Nederlands%20universiteiten%20zijn%20toegankelijk%20-%20tbv%20AO%20Toegankelijkheid%20en%20Kansengelijkheid%20in%20het%20hoger%20onderwijs%20d.d.%2020-2-2019.pdf
[^4]: Binaire variabelen: twee elkaar uitsluitende waarden, zoals ja of nee, 0 of 1, aan of uit.
[^5]: Van Geloven, N. (20 augustus 2015). *Chi-kwadraat toets*. [Wiki Statistiek Academisch Medisch Centrum](https://wikistatistiek.amc.nl/index.php/Chi-kwadraat_toets).
[^6]: In dit voorbeeld wordt uitgegaan van een waarschijnlijkheid van 95% c.q. een p-waardegrens van 0,05. De grens is naar eigen inzicht aan te passen; houd hierbij rekening met type I en type II fouten.


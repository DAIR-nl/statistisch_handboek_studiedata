---
title: "15 Chi-kwadraat & Fisher-Freeman-Halton exact toets"
date: "`r format(Sys.time(), '%d-%m-%Y')`"
output:
  html_document:
    theme: lumen
    toc: yes
    toc_float: 
      collapsed: FALSE 
    number_sections: true
  keywords: [statistisch handboek, studiedata]
---

<!-- ## CLOSEDBLOK: Functies.R -->
```{r functies, include = TRUE, echo = FALSE, results='asis', warning=FALSE, message=FALSE}
library(here)
if (!exists("Substitute_var")) {
  ## Installeer packages en functies
  source(paste0(here::here(), "/99. Functies en Libraries/00. Voorbereidingen.R"), echo = FALSE)
}
```
<!-- ## /CLOSEDBLOK: Functies.R -->

<style>
`r htmltools::includeHTML(paste0(here::here(),"/01. Includes/css/Stylesheet_SHHO.css"))`
</style>

<!-- ## CLOSEDBLOK: Header.R -->
```{r header, include = TRUE, echo = FALSE, results='asis', code =  readLines(paste0(here::here(),"/01. Includes/code/Header.R"))} 
```
<!-- ## /CLOSEDBLOK: Header.R -->


<!-- ## OPENBLOK: Data-aanmaken.R -->
```{r aanmaken data, include=FALSE, echo=TRUE}
source(paste0(here::here(),"/01. Includes/data/16.R"))
```
<!-- ## /OPENBLOK: Data-aanmaken.R -->

# Toepassing
Gebruikt de *Fisher-Freeman-Halton exact toets* om te toetsen of er een afhankelijkheid bestaat tussen twee ongepaarde variabelen, waarin één of beide variabelen meer dan twee categorieën hebben; m x n tabel. De *Fisher-Freeman-Halton exact toets* is een uitbreiding van de *Fisher's exact toets* die gebruikt wordt om te toetsen of er een afhankelijkheid bestaat tussen twee ongepaarde binaire variabelen; 2x2 tabel.[^1]

# Onderwijscasus
De opleidingsdirecteur van de Bachelor Anthropologie vraagt zich af wat de invloed is van de instroom van internationale studenten op het behalen van een positief BSA. Krijgen studenten uit bepaalde landen vaker een positief BSA dan studenten uit andere landen? Internationale studenten zijn 'studenten met een buitenlandse vooropleiding of een opleiding van een Europese school’. 

H~0~: De verhouding wel/geen positief BSA is onder de studenten van de Bachelor Anthropologie hetzelfde voor studenten uit elk land.  

H~A~: De verhouding wel/geen positief BSA is onder de studenten van de Bachelor Anthropologie anders voor een groep voor studenten uit één of meerdere landen.  

# Assumpties
Voor een valide resultaat moeten de data aan een aantal voorwaarden voldoen voordat de toets uitgevoerd kan worden. De groepen zijn op nominaal niveau gemeten en daarmee onafhankelijk van elkaar. 

# Uitvoering in R
<!-- ## TEKSTBLOK: Dataset-inladen.R-->
Er is een dataset (`Bsa_kt`) ingeladen over het BSA per instroomland van de faculteit Sociale Wetenschappen.
<!-- ## /TEKSTBLOK: Dataset-inladen.R-->

## De data bekijken
<!-- ## TEKSTBLOK: Data-bekijken.R -->
Print de kruistabel of geef deze grafisch weer met `barplot()`.
<!-- ## /TEKSTBLOK: Data-bekijken.R -->
<!-- ## OPENBLOK: Data-bekijken.R -->
```{r data bekijken, collapse=TRUE}
print(Bsa_kt)
barplot(Bsa_kt, beside = TRUE, legend.text = TRUE)
```
<!-- ## /OPENBLOK: Data-bekijken.R -->

## Chi-kwadraat toets
<!-- ## TEKSTBLOK: Chi2-toets.R -->
Om `chisq.test()` in R te gebruiken moet de data in een kruistabel staan.
<!-- ## /TEKSTBLOK: Chi2-toets.R -->
<!-- ## OPENBLOK: Chi2-toets-->
```{r collapse=TRUE}
chisq.test(Bsa_kt)
```
<!-- ## /OPENBLOK: Chi2-toets-->

## Fisher-Freeman-Halton exact toets
<!-- ## TEKSTBLOK: Fisher-Freeman-Halton-exact-toets-->
Gebruik `simulate.p.value = TRUE` bij `fisher.test()` om de p-waardes via een Monte Carlo simulatie te laten uitrekenen. Dit is nodig voor tabellen die groter zijn dan 2 bij 2.
<!-- ## /TEKSTBLOK: Fisher-Freeman-Halton-exact-toets-->
<!-- ## OPENBLOK: Fisher-Freeman-Halton-exact-toets-->
``` {r fisher toets}
fisher.test(Bsa_kt_n10, simulate.p.value = TRUE)
fisher.test(Bsa_kt, simulate.p.value = TRUE)
```
<!-- ## /OPENBLOK: Fisher-Freeman-Halton-exact-toets-->
* p-waarde < 0,05, dus de H~0~ wordt verworpen en de H~A~ wordt aangenomen [^10]


# Rapportage
<!-- ## TEKSTBLOK: Rapportage.R -->

<!-- ## /TEKSTBLOK: Rapportage.R -->

<!-- ## CLOSEDBLOK: Footer.R -->
```{r footer, include = TRUE, echo = FALSE, results='asis', code =  readLines(paste0(here::here(),"/01. Includes/code/Footer.R"))}
```
<!-- ## /CLOSEDBLOK: Footer.R -->

[^1]: Van Geloven, N. & Holman, R. (6 mei 2016). *Fisher's exact toets* Co-Auteur	dr. R. [Wiki Statistiek Academisch Medisch Centrum](https://wikistatistiek.amc.nl/index.php/Fisher%27s_exact_toets).
[^10]: In dit voorbeeld wordt eruit gegaan van een waarschijnlijkheid van 95% en zodoende een p-waardegrens van 0,05. Dit is naar eigen inzicht aan te passen. Hou hierbij rekening met type I en type II fouten.
---
title: "15 Chi-kwadraat & Fisher-Freeman-Halton exact toets"
author: "© `r format(Sys.time(), '%Y')`, SURF Versnellingsagenda - Statistisch Handboek Hoger Onderwijs"
date: "`r format(Sys.time(), '%d-%m-%Y')`"
output:
  html_document:
    theme: lumen
    toc: yes
    toc_float: 
      collapsed: FALSE 
    number_sections: true
  keywords: [statistisch handboek, studiedata]
---

<style>
`r htmltools::includeHTML(paste0(here::here(),"/01. Includes/css/Stylesheet_SHHO.css"))`
</style>

```{r header, include = FALSE, echo = TRUE, results='asis'} 
paste0(here::here(),"/01. Includes/code/Header.R")
```

<!-- ## OPENBLOK: Functiedefinities.R -->
```{r functiedefinities,include=FALSE, echo=TRUE}
library(stringr)
Round_and_format <- function(x, digits = 2) {
  x <- as.character(round(x, digits))
  x <- str_replace(x, "[.]", ",")
  return(x)
}
```
<!-- ## /BLOK: Functiedefinities.R -->

<!-- ## OPENBLOK: Data-aanmaken.R -->
```{r aanmaken data, include=FALSE, echo=TRUE}
## De opleidingsdirecteur van de Bachelor Anthropologie vraagt zich af wat de invloed is van de instroom van internationale studenten. Krijgen studenten uit bepaalde landen vaker een positief BSA dan studenten uit andere landen?

RNGkind(sample.kind = "Rounding")
set.seed(1) #noodzakelijk omdat we simulate.p.values gebruiken bij de fisher.test
Landen_instroom <- c("NL", "GE", "IT", "UK", "BE", "ES", "US")  ##ISO-codes
Pos_bsa <- c(1171, 213,  60, 119,  45,  81, 270)
Verhouding <- c(0.1, 0.14, 0.36, 0.04, 0.12, 0.22, 0.19)
Neg_bsa <- round(Pos_bsa * Verhouding)
Bsa_kt <- data.frame(Pos_bsa, Neg_bsa)
Bsa_kt <- t(Bsa_kt)
colnames(Bsa_kt) <- Landen_instroom

Pos_bsa_n10 <- c(49, 37, 62, 67, 73, 70, 69)
Neg_bsa_n10 <- c(10, 7, 13, 14, 15, 19, 18)
Bsa_kt_n10 <- data.frame(Pos_bsa_n10, Neg_bsa_n10)
Bsa_kt_n10 <- t(Bsa_kt_n10)
colnames (Bsa_kt_n10) <- Landen_instroom
```
<!-- ## /BLOK: Data-aanmaken.R -->

# Toepassing
Gebruikt de *Fisher-Freeman-Halton exact toets* om te toetsen of er een afhankelijkheid bestaat tussen twee ongepaarde variabelen, waarin één of beide variabelen meer dan twee categorieën hebben; m x n tabel. De *Fisher-Freeman-Halton exact toets* is een uitbreiding van de *Fisher's exact toets* die gebruikt wordt om te toetsen of er een afhankelijkheid bestaat tussen twee ongepaarde binaire variabelen; 2x2 tabel.[^1]

# Onderwijscasus
De opleidingsdirecteur van de Bachelor Anthropologie vraagt zich af wat de invloed is van de instroom van internationale studenten op het behalen van een positief BSA. Krijgen studenten uit bepaalde landen vaker een positief BSA dan studenten uit andere landen? Internationale studenten zijn 'studenten met een buitenlandse vooropleiding of een opleiding van een Europese school’. 

H~0~: De verhouding wel/geen positief BSA is onder de studenten van de Bachelor Anthropologie hetzelfde voor studenten uit elk land.  

H~A~: De verhouding wel/geen positief BSA is onder de studenten van de Bachelor Anthropologie anders voor een groep voor studenten uit één of meerdere landen.  

# Assumpties
Voor een valide resultaat moeten de data aan een aantal voorwaarden voldoen voordat de toets uitgevoerd kan worden. De groepen zijn op nominaal niveau gemeten en daarmee onafhankelijk van elkaar. 

# Uitvoering in R
Er is een dataset (`Bsa_kt`) ingeladen over het BSA per instroomland van de faculteit Sociale Wetenschappen.

## De data bekijken
Print de kruistabel of geef deze grafisch weer met `barplot()`.
<!-- ## OPENBLOK: Data-bekijken.R -->
```{r data bekijken, collapse=TRUE}
print(Bsa_kt)
barplot(Bsa_kt, beside = TRUE, legend.text = TRUE)
```
<!-- ## /BLOK: Data-bekijken.R -->

## Fisher-Freeman-Halton exact toets
Gebruik `simulate.p.value = TRUE` bij `fisher.test()` om de p-waardes via een Monte Carlo simulatie te laten uitrekenen. Dit is nodig voor tabellen die groter zijn dan 2 bij 2.
<!-- ## OPENBLOK: Fisher-Freeman-Halton-exact-toets-->
``` {r fisher toets}
fisher.test(Bsa_kt_n10, simulate.p.value = TRUE)
fisher.test(Bsa_kt, simulate.p.value = TRUE)
```
<!-- ## /BLOK: Fisher-Freeman-Halton-exact-toets-->
* p-waarde < 0,05, dus de H~0~ wordt verworpen en de H~A~ wordt aangenomen [^10]
*

# Rapportage

[^1]: Van Geloven, N. & Holman, R. (6 mei 2016). *Fisher's exact toets* Co-Auteur	dr. R. [Wiki Statistiek Academisch Medisch Centrum](https://wikistatistiek.amc.nl/index.php/Fisher%27s_exact_toets).
[^10]: In dit voorbeeld wordt eruit gegaan van een waarschijnlijkheid van 95% en zodoende een p-waardegrens van 0,05. Dit is naar eigen inzicht aan te passen. Hou hierbij rekening met type I en type II fouten.



## Chi-kwadraat toets
Om `chisq.test()` in R te gebruiken moet de data in een kruistabel staan.
<!-- ## OPENBLOK: Chi2-toets-->
```{r collapse=TRUE}
chisq.test(Bsa_kt)
```
<!-- ## /BLOK: Chi2-toets-->
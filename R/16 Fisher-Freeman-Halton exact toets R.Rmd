---
title: "Chi-kwadraat toets en Fisher-Freeman-Halton exact toets"
output:
  html_document:
    theme: lumen
    toc: yes
    toc_float: 
      collapsed: FALSE 
    number_sections: true
    includes:
      in_header: ["../01. Includes/html/favicon.html", "../01. Includes/html/analytics.html"]
  keywords: [statistisch handboek, studiedata]
---

<!-- ## CLOSEDBLOK: Functies.R -->
```{r functies, include = TRUE, echo = FALSE, results='asis', warning=FALSE, message=FALSE}
library(here)
if (!exists("Substitute_var")) {
  ## Installeer packages en functies
  source(paste0(here::here(), "/99. Functies en Libraries/00. Voorbereidingen.R"), echo = FALSE)
}
```
<!-- ## /CLOSEDBLOK: Functies.R -->

<!-- ## CLOSEDBLOK: CSS -->
<style>
`r htmltools::includeHTML(paste0(here::here(),"/01. Includes/css/Stylesheet_SHHO.css"))`
</style>
<!-- ## /CLOSEDBLOK: CSS -->

<!-- ## CLOSEDBLOK: Header.R -->
```{r header, include = TRUE, echo = FALSE, results='asis', code =  readLines(paste0(here::here(),"/01. Includes/code/Header.R"))} 
```
<!-- ## /CLOSEDBLOK: Header.R -->

<!-- ## CLOSEDBLOK: Status.R -->
```{r status, include = TRUE, echo = FALSE, results='asis', code =  readLines(paste0(here::here(),"/01. Includes/code/Status.R"))} 
```
<!-- ## /CLOSEDBLOK: Status.R -->

<!-- ## OPENBLOK: Data-aanmaken.R -->
```{r aanmaken data, include=FALSE, echo=TRUE}
source(paste0(here::here(),"/01. Includes/data/16.R"))
```
<!-- ## /OPENBLOK: Data-aanmaken.R -->

# Toepassing
Gebruik de *Chi-kwadraat toets*[^1] of de *Fisher-Freeman-Halton exact toets*[^2] om te toetsen of er een verband is tussen twee ongepaarde variabelen, waarin één of beide variabelen meer dan twee categorieën hebben. De *Fisher-Freeman-Halton exact toets* is een alternatief voor de *Chi-kwadraat toets* wanneer er kleine aantallen observaties zijn. [^2]<sup>,</sup>[^3] De *Fisher-Freeman-Halton exact toets* is een uitbreiding van de *Fisher's exact toets* welke gebruikt wordt om te toetsen of er een verband bestaat tussen twee ongepaarde binaire variabelen, oftewel een 2x2 tabel. 

# Onderwijscasus
<div id = "casus">
De opleidingsdirecteur van de Bachelor Antropologie vraagt zich af wat de invloed is van de instroom van studenten met een vooropleiding in het buitenland op het behalen van een positief BSA. Krijgen studenten met een vooropleiding uit bepaalde landen vaker een positief BSA dan studenten met een vooropleiding uit andere landen? Op basis van deze analyse kan de opleidingsdirecteur overwegen om bij de inrichting van het tutoraat rekening te houden met de vooropleidingen van studenten.


H~0~: De verhouding wel/geen positief BSA is onder de studenten van de Bachelor Antropologie hetzelfde voor studenten ongeacht het land van de hoogste vooropleiding.

H~A~: De verhouding wel/geen positief BSA is onder de studenten van de Bachelor Antropologie anders voor ten minste een land van hoogste vooropleiding.  
</div>

# Assumpties
Voor een valide resultaat moeten de data aan een aantal voorwaarden voldoen voordat de toets uitgevoerd kan worden. De groepen zijn op nominaal of ordinaal niveau [^4] gemeten en daarmee onafhankelijk van elkaar. 

## Groepsgrootte
Beide testen maken gebruik van een kruistabel; zie Tabel 1 voor de geoberveerde aantallen van de casus. 

<!-- ## TEKSTBLOK: Groepsgrootte1.R -->

|                      | NL   | GE | IT | UK | BE | ES | US |   |
| ------------- | ---------| ------------| -------------| ---------|---------|---------|---------| ------------- |
| **Positief BSA** |`r BSA_kruistabel[1,1]` | `r BSA_kruistabel[1,2]`  | `r BSA_kruistabel[1,3]`  | `r BSA_kruistabel[1,4]`  | `r BSA_kruistabel[1,5]`  | `r BSA_kruistabel[1,6]`  | `r BSA_kruistabel[1,7]`  | **`r sum(BSA_kruistabel[1,1:7])`**|
| **Negatief BSA**  |`r BSA_kruistabel[2,1]`   | `r BSA_kruistabel[2,2]` | `r BSA_kruistabel[2,3]` | `r BSA_kruistabel[2,4]` | `r BSA_kruistabel[2,5]` | `r BSA_kruistabel[2,6]` | `r BSA_kruistabel[2,7]` | **`r sum(BSA_kruistabel[2,1:7])`**|
|**Totaal** |**`r sum(BSA_kruistabel[1:2,1])`**   | **`r sum(BSA_kruistabel[1:2,2])`** | **`r sum(BSA_kruistabel[1:2,3])`**   | **`r sum(BSA_kruistabel[1:2,4])`**   | **`r sum(BSA_kruistabel[1:2,5])`**   | **`r sum(BSA_kruistabel[1:2,6])`**   | **`r sum(BSA_kruistabel[1:2,7])`**   | **`r sum(BSA_kruistabel)`** |
*Tabel 1. Geobserveerde aantallen casus BSA en land van hoogste vooropleiding.*
<!-- ## TEKSTBLOK: Groepsgrootte1.R -->

Op basis van de aanname van onafhankelijkheid kunnen de verwachte aantallen observaties in elke cel berekend worden. In deze casus kan het verwachte aantal observaties van de studenten met een Nederlandse vooropleiding met positief BSA berekend worden door het aantal studenten met positief BSA te vermenigvuldigen met het aantal studenten met Nederlandse vooropleiding en de uitkomst te delen door het totaal aantal studenten:

<!-- ## TEKSTBLOK: Groepsgrootte2.R -->
* aantal studenten positief BSA: `r sum(BSA_kruistabel[1,1:7])`   
* aantal studenten met Nederlandse vooropleiding: `r sum(BSA_kruistabel[1:2,1])`  
* totaal aantal studenten: `r sum(BSA_kruistabel)` 
* verwacht aantal studenten met Nederlandse vooropleiding met positief BSA: `r sum(BSA_kruistabel[1,1:7])`*`r sum(BSA_kruistabel[1:2,1])`/`r sum(BSA_kruistabel)` ≈ `r round(sum(BSA_kruistabel[1,1:7])*sum(BSA_kruistabel[1:2,1])/sum(BSA_kruistabel)) `. Deze en overige aantallen zijn berekend in Tabel 2. 

|                      | NL   | GE | IT | UK | BE | ES | US |   |
| ------------- | ---------| ------------| -------------| ---------|---------|---------|---------| ------------- |
| **Positief BSA** |`r round(sum(BSA_kruistabel[1,1:7])*sum(BSA_kruistabel[1:2,1])/sum(BSA_kruistabel)) ` | `r round(sum(BSA_kruistabel[1,1:7])*sum(BSA_kruistabel[1:2,2])/sum(BSA_kruistabel)) `  | `r round(sum(BSA_kruistabel[1,1:7])*sum(BSA_kruistabel[1:2,3])/sum(BSA_kruistabel)) `  | `r round(sum(BSA_kruistabel[1,1:7])*sum(BSA_kruistabel[1:2,4])/sum(BSA_kruistabel)) `  | `r round(sum(BSA_kruistabel[1,1:7])*sum(BSA_kruistabel[1:2,5])/sum(BSA_kruistabel)) `  | `r round(sum(BSA_kruistabel[1,1:7])*sum(BSA_kruistabel[1:2,6])/sum(BSA_kruistabel)) `  | `r round(sum(BSA_kruistabel[1,1:7])*sum(BSA_kruistabel[1:2,7])/sum(BSA_kruistabel)) `  | **`r sum(BSA_kruistabel[1,1:7])`**|
| **Negatief BSA**  |`r round(sum(BSA_kruistabel[2,1:7])*sum(BSA_kruistabel[1:2,1])/sum(BSA_kruistabel)) `   | `r round(sum(BSA_kruistabel[2,1:7])*sum(BSA_kruistabel[1:2,2])/sum(BSA_kruistabel)) ` | `r round(sum(BSA_kruistabel[2,1:7])*sum(BSA_kruistabel[1:2,3])/sum(BSA_kruistabel)) ` | `r round(sum(BSA_kruistabel[2,1:7])*sum(BSA_kruistabel[1:2,4])/sum(BSA_kruistabel)) ` | `r round(sum(BSA_kruistabel[2,1:7])*sum(BSA_kruistabel[1:2,5])/sum(BSA_kruistabel)) ` | `r round(sum(BSA_kruistabel[2,1:7])*sum(BSA_kruistabel[1:2,6])/sum(BSA_kruistabel)) ` | `r round(sum(BSA_kruistabel[2,1:7])*sum(BSA_kruistabel[1:2,7])/sum(BSA_kruistabel)) ` | **`r sum(BSA_kruistabel[2,1:7])`**|
|**Totaal** |**`r sum(BSA_kruistabel[1:2,1])`**   | **`r sum(BSA_kruistabel[1:2,2])`** | **`r sum(BSA_kruistabel[1:2,3])`**   | **`r sum(BSA_kruistabel[1:2,4])`**   | **`r sum(BSA_kruistabel[1:2,5])`**   | **`r sum(BSA_kruistabel[1:2,6])`**   | **`r sum(BSA_kruistabel[1:2,7])`**   | **`r sum(BSA_kruistabel)`** |
*Tabel 2. Verwachte aantallen observaties casus BSA en land van hoogste vooropleiding.*
<!-- ## TEKSTBLOK: Groepsgrootte2.R -->

De *Chi-kwadraat toets* wordt onbetrouwbaar als er in meer dan 20 % van de gevallen een verwacht aantal observaties van 5 of lager is.[^5] Gebruik in die gevallen de *Fisher-Freeman-Halton exact toets*.  

# Post-hoc toetsen

De *Chi-kwadraat toets* en *Fisher-Freeman-Halton exact toets* worden gebruikt om een afhankelijkheid aan te tonen tussen twee ongepaarde categorische variabelen. Wanneer een of beide variabelen meer dan twee categorieën bevat, worden post-hoc toetsen uitgevoerd om te bepalen welke categorieën significant van elkaar verschillen.

Als post-hoc toets voor de *Chi-kwadraat toets* wordt het gestandaardiseerde residu gebruikt. Dit is het gestandaardiseerde verschil tussen de geobserveerde en verwacht aantal, waarbij gestandaardiseerd betekent dat het een gemiddelde van 0 en standaardafwijking van 1 heeft. Op deze manier kunnen de verschillende residuen met elkaar vergeleken worden omdat ze dezelfde schaal hebben. Voor elke cel in de kruistabel kan het gestandaardiseerde residu bepaald worden. Vergelijkbaar met z-scores zijn deze residuen significant bij een waarde groter dan ± 1,96 wanneer een significantieniveau (α) van 0,05 wordt gehanteerd. Op deze manier kan bepaald worden in welke cellen er afwijkingen van de verwachte aantallen zijn. [^5]

Voor de *Fisher-Freeman-Halton exact toets* is er geen specifiek voorgeschreven post-hoc toets.[^3]<sup>,</sup>[^5] Een goede optie is het uitvoeren van losse *Fisher's exact toetsen* voor elke mogelijke combinatie van 2x2 tabellen. Gebruik een correctie op de p-waarden, omdat er meerdere testen tegelijk uitgevoerd worden. Een bekende correctie is de Bonferroni methode, andere opties zijn ook mogelijk.

# Effectmaat

De p-waarde geeft aan of het verschil tussen twee groepen statistisch significant is. De grootte van het verschil of effect is echter ook relevant. Een effectmaat is een gestandaardiseerde maat die de grootte van een effect weergeeft, zodat effecten vergeleken kunnen worden voor verschillende onderzoeken.[^5] 
De *Chi-kwadraat toets* heeft als effectmaat *w*.[^6] Een indicatie om *w* te interpreteren is: rond 0,1 is het een klein effect, rond 0,3 is het een gemiddeld effect en rond 0,5 is het een groot effect.[^7]

De *Fisher-Freeman-Halton exact toets* heeft geen specifieke effectmaat. De post-hoc toets van deze toets - *Fisher's exact toets* - gebruikt echter de odds ratio als effectmaat. De odds ratio is een effectmaat die voor zowel de *Chi-kwadraat toets* als de *Fisher's exact toets* kan worden gebruikt. Een voorwaarde is echter dat beide variabelen binair zijn. In andere woorden, er moet een 2x2 kruistabel gevormd kunnen worden. Odds is een Engelse term voor de verhouding van twee kansen, bijvoorbeeld de verhouding tussen het aantal studenten dat uitvalt en niet uitvalt. Een odds ratio is de verhouding tussen twee odds, dus de verhouding van de odds van studentenuitval voor de periode met leenstelsel en de periode zonder leenstelsel. De odds ratio geeft dus een interpretatie van het effect van een leenstelsel op het uitvallen van studenten.[^5]

# De data bekijken
<!-- ## TEKSTBLOK: Data-bekijken.R -->
Er is een kruistabel ingeladen over het BSA advies voor bachelorstudenten antropologie met verschillende landen van hoogste vooropleiding. De variabele voor BSA advies is binair (positief of negatief) en de variabele voor land van hoogste vooropleiding bestaat uit zeven categorieën Deze kruistabel is gebaseerd op een dataset waarin BSA advies en land van hoogste vooropleiding voor studenten wordt bijgehouden. 
Print de kruistabel of geef deze grafisch weer met `barplot()`. 
<!-- ## /TEKSTBLOK: Data-bekijken.R -->
<!-- ## OPENBLOK: Data-bekijken.R -->
```{r data bekijken, collapse=TRUE}
print(BSA_kruistabel)
barplot(BSA_kruistabel, beside = TRUE, legend.text = TRUE)
```
<!-- ## /OPENBLOK: Data-bekijken.R -->

Hieronder wordt eerst de *Chi-kwadraat toets* met de data over het BSA advies voor bachelorstudenten antropologie (`BSA_kruistabel`). Daarna wordt de *Fisher-Freeman-Halton exact toets* uitgevoerd op een dataset met een lager aantal observaties.

# Chi-kwadraat toets
## Uitvoering
<!-- ## TEKSTBLOK: Chi2-toets.R -->
De *chi-kwadraat toets* wordt uitgevoerd om de vraag te beantwoorden of het percentage studenten met positief BSA gelijk is voor de verschillende landen van hoogste vooropleiding. Gebruik `chisq.test()` op de kruistabel `BSA_kruistabel`.  
<!-- ## /TEKSTBLOK: Chi2-toets.R -->
<!-- ## OPENBLOK: Chi2-toets-->
```{r collapse=TRUE}
chisq.test(BSA_kruistabel)
```
<!-- ## /OPENBLOK: Chi2-toets-->
<!-- ## CLOSEDBLOK: Chi2-toets.R-->
```{r chi2 als object, include=FALSE, echo=TRUE}
Chi2 <- chisq.test(BSA_kruistabel)
vChi2 <- Round_and_format(Chi2$statistic)
vP <- Round_and_format(Chi2$p.value)
vDF <- Chi2$parameter
```
<!-- ## /CLOSEDBLOK: Chi2-toets.R-->

Bereken de effectmaat *w* vervolgens op basis van de $\chi^2$-waarde van de *Chi-kwadraat toets*.
<!-- ## OPENBLOK: Chi2-toets-2.R -->
```{r effectsize}
# Sla de teststatistiek op
Chi2_teststatistiek <- chisq.test(BSA_kruistabel)$statistic

# Bereken het totaal aantal observaties als som van de kruistabel
N <- sum(BSA_kruistabel)

# Bereken eta squared
w <- sqrt(Chi2_teststatistiek / N)

# Print effectgrootte
paste("Effectgrootte is",w)


```
<!-- ## /OPENBLOK: Chi2-toets-2.R -->


<!-- ## TEKSTBLOK: Chi2-toets.R-->
* *χ^2^* ~6~ ≈ `r vChi2`, *p* < 0,0001  
* Vrijheidsgraden: *df* = (*k*-1)(*r*-1), waar k staat voor kolom en r voor rij. In dit geval geldt *df* = `r vDF`. 
* p-waarde < 0,05, de H~0~ wordt verworpen.[^8]
* Effectmaat is `r Round_and_format(w)`, dus een klein tot gemiddeld effect


<!-- ## /TEKSTBLOK: Chi2-toets.R-->

## Post-hoc toets: gestandaardiseerde residuen


Voer post-hoc toetsen uit om te bepalen welke landen van hoogste vooropleiding van elkaar verschillen wat betreft het percentage studenten met positief BSA. Inspecteer hiervoor de Pearson residuen van de *Chi-kwadraat toets* op waarden groter dan 1,96 en kleiner dan -1,96. Let op dat hier nog geen correctie voor meerdere testen plaatsvindt.[^9]

<!-- ## OPENBLOK: Chi2-toets post-hoc1-->
```{r collapse=TRUE}
resultaat <- chisq.test(BSA_kruistabel)
resultaat$residuals
```
<!-- ## /OPENBLOK: Chi2-toets post-hoc1-->

<!-- ## TEKSTBLOK: Chi2-toets post-hoc2.R-->
* Significant hoger aantal observaties bij negatief BSA Italië (IT), *z* = `r Round_and_format(resultaat$residuals["Neg_bsa","IT"])`
* Significant hoger aantal observaties bij negatief BSA Spanje (ES), *z* = `r Round_and_format(resultaat$residuals["Neg_bsa","ES"])`
* Significant hoger aantal observaties bij negatief BSA Verenigde Staten (US), *z* = `r Round_and_format(resultaat$residuals["Neg_bsa","US"])`
* Significant lager aantal observaties bij negatief BSA Nederland (NL), *z* = `r Round_and_format(resultaat$residuals["Neg_bsa","NL"])`
* Significant lager aantal observaties bij negatief BSA Verenigd Koninkrijk (VK), *z* = `r Round_and_format(resultaat$residuals["Neg_bsa","UK"])`

<!-- ## TEKSTBLOK: Chi2-toets post-hoc2.R-->



## Rapportage

<!-- ## TEKSTBLOK: RapportageChi2.R -->
De *Chi-kwadraat toets* is uitgevoerd om te onderzoeken of het percentage studenten met positief BSA verschilt per land van hoogste vooropleiding. De resultaten illustreren dat de nulthypothese verworpen kan worden, *χ^2^* ~`r vDF`~ ≈ `r vChi2`, *p* < 0,0001, *w* = `r Round_and_format(w)`. Er zijn verschillen tussen de landen van hoogste vooropleiding.

De resultaten van de post-hoc toetsen van de *Chi-kwadraat toets* zijn te vinden in Tabel 3, waarin geobserveerde aantallen met asterisk significant verschillend zijn van verwachte aantallen. De geobserveerde aantallen voor de verschillende landen van hoogste vooropleiding bij een positief BSA verschillen niet significant van de verwachte aantallen. Bij een negatief BSA is er echter een aantal landen waarbij significante verschillen van het verwachte aantal zijn op te merken. Nederland (NL; *z* = `r Round_and_format(resultaat$residuals["Neg_bsa","NL"])`) en het Verenigd Koninkrijk (UK; *z* = `r Round_and_format(resultaat$residuals["Neg_bsa","UK"])`) hebben een lager aantal studenten met een negatief BSA dan verwacht; Italië (IT; *z* = `r Round_and_format(resultaat$residuals["Neg_bsa","IT"])`), Spanje (ES; *z* = `r Round_and_format(resultaat$residuals["Neg_bsa","ES"])`) en de Verenigde Staten (US; *z* = `r Round_and_format(resultaat$residuals["Neg_bsa","US"])`) een hoger aantal studenten met negatief BSA dan verwacht.
<!-- ## TEKSTBLOK: RapportageChi2.R -->

<!-- ## TEKSTBLOK: RapportageChi3.R -->

|                      | NL   | GE | IT | UK | BE | ES | US |   |
| ------------- | ---------| ------------| -------------| ---------|---------|---------|---------| ------------- |
| **Positief BSA** |`r BSA_kruistabel[1,1]` | `r BSA_kruistabel[1,2]`  | `r BSA_kruistabel[1,3]`  | `r BSA_kruistabel[1,4]`  | `r BSA_kruistabel[1,5]`  | `r BSA_kruistabel[1,6]`  | `r BSA_kruistabel[1,7]`  | **`r sum(BSA_kruistabel[1,1:7])`**|
| **Negatief BSA**  |`r BSA_kruistabel[2,1]`\*   | `r BSA_kruistabel[2,2]` | `r BSA_kruistabel[2,3]`\* | `r BSA_kruistabel[2,4]`\* | `r BSA_kruistabel[2,5]` | `r BSA_kruistabel[2,6]`\* | `r BSA_kruistabel[2,7]`\* | **`r sum(BSA_kruistabel[2,1:7])`**|
|**Totaal** |**`r sum(BSA_kruistabel[1:2,1])`**   | **`r sum(BSA_kruistabel[1:2,2])`** | **`r sum(BSA_kruistabel[1:2,3])`**   | **`r sum(BSA_kruistabel[1:2,4])`**   | **`r sum(BSA_kruistabel[1:2,5])`**   | **`r sum(BSA_kruistabel[1:2,6])`**   | **`r sum(BSA_kruistabel[1:2,7])`**   | **`r sum(BSA_kruistabel)`** |
*Tabel 3. Geobserveerde aantallen casus BSA en land van hoogste vooropleiding. Aantallen met asterisk zijn significant verschillend van verwachte aantallen.*
<!-- ## TEKSTBLOK: RapportageChi3.R -->


# Fisher-Freeman-Halton exact toets
## Uitvoering
<!-- ## TEKSTBLOK: UitvoeringFFH.R -->
De *Fisher-Freeman-Halton exact toets* wordt uitgevoerd om de vraag te beantwoorden of het percentage studenten met positief BSA verschilt per land van hoogste vooropleiding. Deze toets wordt in plaats van de *Chi-kwadraat toets* gebruikt wanneer er in meer dan 20 % van de cellen een verwacht aantal observaties van 5 of lager is. Er is een steekproef van `BSA_kruistabel` ingeladen genaamd `BSA_kruistabel_n10` met daarin een lager aantal observaties per cel.
<!-- ## TEKSTBLOK: UitvoeringFFH.R -->

<!-- ## OPENBLOK: data-bekijken-n10 -->
```{r data bekijken n10}
print(BSA_kruistabel_n10)
```
<!-- ## /OPENBLOK: data-bekijken-n10 -->

<!-- ## TEKSTBLOK: Fisher-Freeman-Halton-exact-toets-->
Gebruik de functie `fisher.test()` met als eerste argument de dataset `BSA_kruistabel_n10` en als tweede argument `simulate.p.value = TRUE`. Hierdoor wordt de p-waarde met een simulatie berekent waardoor de rekentijd voor de copmuter een stuk lager is en de resultaten sneller weergegeven kunnen worden.
<!-- ## /TEKSTBLOK: Fisher-Freeman-Halton-exact-toets-->
<!-- ## OPENBLOK: Fisher-Freeman-Halton-exact-toets-->
``` {r fisher toets}
fisher.test(BSA_kruistabel_n10, simulate.p.value = TRUE)
```
<!-- ## /OPENBLOK: Fisher-Freeman-Halton-exact-toets-->

<!-- ## TEKSTBLOK: Fisher-Freeman-Halton-exact-toets2-->
* p-waarde is `r Round_and_format(fisher.test(BSA_kruistabel_n10, simulate.p.value = TRUE)$p.value)` , de H~0~ kan niet worden verworpen [^8]
<!-- ## /TEKSTBLOK: Fisher-Freeman-Halton-exact-toets2-->

## Post-hoc toets: Fisher's exact toets

<!-- ## TEKSTBLOK: Fisher-Freeman-Halton-exact-toets post-hoc1 -->
Omdat er geen afhankelijkheid is tussen het wel of niet halen van een positief BSA en het land van hoogste vooropleiding, hoeven er geen post-hoc toetsen uitgevoerd te worden. Indien dit wel nodig is, voer deze dan uit met de functie `fisher.multcomp()` met als eerste argument de kruistabel `BSA_kruistabel_10` en als tweede argument de gebruikte methode om te corrigeren voor meerdere testen, in dit geval `p.method = "bonferroni"`. Deze correctie past de p-waarde aan door de p-waarde te vermenigvuldigen met het aantal uitgevoerde toetsen en verlaagt hiermee de kans dat er bij toeval een verband wordt ontdekt dat er niet is.[^5] Naast de p-waarde toont *Fisher's exact toets* de odds ratio als effectmaat. Voor meer informatie, zie de toetspagina van de *Fisher's exact toets*.   
<!-- ## TEKSTBLOK: Fisher-Freeman-Halton-exact-toets post-hoc1 -->


<!-- ## OPENBLOK: Fisher-Freeman-Halton-exact-toets post-hoc2 -->
``` {r fisher toets post hoc, warning=FALSE, message=FALSE}
library(RVAideMemoire)
fisher.multcomp(BSA_kruistabel_n10, p.method = "bonferroni")

```
<!-- ## OPENBLOK: Fisher-Freeman-Halton-exact-toets post-hoc2 -->

De resultaten laten de significantie zien van de *Fisher's exact toets* voor elk mogelijke combinatie van 2x2 tabellen. Geen van de post-hoc toetsen is significant, wat logisch is aangezien de *Fisher-Freeman-Halton exact toets* niet significant was.  De eerste waarde is bijvoorbeeld de p-waarde van deze toets voor de kruistabel bestaande uit de aantallen positief en negatief BSA voor Nederland en Duitsland (NL:GE). De opmerkelijke p-waardes van 1 komen in een aantal gevallen door de Bonferroni correctie die de oorspronkelijke p-waarde met het aantal vergelijken (21) vermenigvuldigt. In andere gevallen zijn de verschillen zo klein dat dit leidt tot een p-waarde van 1.


## Rapportage
<!-- ## TEKSTBLOK: Rapportage.R -->
De *Fisher-Freeman-Halton exact toets* is uitgevoerd om te toetsen of het percentage studenten met positief BSA verschilt per land van hoogste vooropleiding voor een dataset met een laag aantal observaties. De nulhypothese kan niet verworpen worden (*p* = `r Round_and_format(fisher.test(BSA_kruistabel_n10, simulate.p.value = TRUE)$p.value)`); het percentage studenten met een positief BSA lijkt niet te verschillen per land van hoogste vooropleiding. 

<!-- ## /TEKSTBLOK: Rapportage.R -->

<!-- ## CLOSEDBLOK: Footer.R -->
```{r footer, include = TRUE, echo = FALSE, results='asis', code =  readLines(paste0(here::here(),"/01. Includes/code/Footer.R"))}
```
<!-- ## /CLOSEDBLOK: Footer.R -->


[^1]: Van Geloven, N. (20 augustus 2015). *Chi-kwadraat toets*. [Wiki Statistiek Academisch Medisch Centrum](https://wikistatistiek.amc.nl/index.php/Chi-kwadraat_toets).
[^2]: Van Geloven, N. & Holman, R. (6 mei 2016). *Fisher's exact toets*. [Wiki Statistiek Academisch Medisch Centrum](https://wikistatistiek.amc.nl/index.php/Fisher%27s_exact_toets).
[^3]: Agresti, A. (2003). *Categorical data analysis*. Vol. 482, John Wiley & Sons.
[^4]: Nominaal: variabelen die niet afhankelijk van elkaar zijn en niet op inhoudelijke basis geordend kunnen worden; voorbeelden hiervan zijn geslacht of achternamen. Een binaire variabele is een voorbeeld van een nominale variabele. Binaire variabelen hebben twee mogelijkheden, ja of nee, terwijl nominale variabelen meerdere mogelijkheden kunnen hebben. 
[^5]: Field, A., Miles, J., & Field, Z. (2012). *Discovering statistics using R*. London: Sage publications.
[^6]: De effectmaat *w* wordt voor de *Chi-kwadraat toets* berekend door de wortel te nemen van de
$\chi^2$-waarde gedeeld door het totaal aantal observaties, i.e. $\sqrt{ \frac{\chi^2}{N} }$.
[^7]: Allen, P. & Bennett, K. (2012). *SPSS A practical Guide version 20.0*. Cengage Learning Australia Pty Limited.
[^8]: Dit voorbeeld gaat uit van een waarschijnlijkheid van 95% en zodoende een p-waardegrens van 0,05. Dit is naar eigen inzicht aan te passen. Hou hierbij rekening met type I en type II fouten.
[^9]: De waarde 1,96 is een z-score en correspondeert met het significantieniveau 0,05 voor een tweezijdige toets. Om te corrigeren voor meerdere testen kan een ander significantieniveau gekozen worden wat resulteert in een andere z-score om mee te vergelijken. Bij een significantieniveau van 0,01 is de z-score bijvoorbeeld 2,58.